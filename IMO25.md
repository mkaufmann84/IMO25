# Winning Gold at IMO 2025 with a Model-Agnostic Verification-and-Refinement Pipeline∗

**Authors:** Yichen Huang (黄溢辰)†, Lin F. Yang (杨林)‡

**Date:** October 1, 2025

## Abstract

The International Mathematical Olympiad (IMO) is widely regarded as the world championship of high-school mathematics. IMO problems are renowned for their difficulty and novelty, demanding deep insight, creativity, and rigor. Although large language models perform well on many mathematical benchmarks, they often struggle with Olympiad-level problems. Using carefully designed prompts, we construct a model-agnostic, verification-and-refinement pipeline. We demonstrate its effectiveness on the recent IMO 2025, avoiding data contamination for models released before the competition. Equipped with any of the three leading models—Gemini 2.5 Pro, Grok-4, or GPT-5—our pipeline correctly solved 5 out of the 6 problems (≈ 85.7% accuracy). This is in sharp contrast to their baseline accuracies: 31.6% (Gemini 2.5 Pro), 21.4% (Grok-4), and 38.1% (GPT-5), obtained by selecting the best of 32 candidate solutions. The substantial improvement underscores that the path to advanced AI reasoning requires not only developing more powerful base models but also designing effective methodologies to harness their full potential for complex tasks.

## 1 Introduction

The International Mathematical Olympiad (IMO) is an annual competition widely regarded as the world championship of high-school mathematics. Established in Romania in 1959 with just seven participating countries, it has since expanded to include over 100 nations, each represented by a team of up to six of their most talented pre-university students. The competition is an extremely challenging test of creativity and sustained concentration: over two consecutive days, contestants are given two 4.5-hour sessions to solve three problems per session, drawn from the fields of algebra, combinatorics, geometry, and number theory [2]. ∗ Code available at: https://github.com/lyang36/IMO25 † huangtbcmh@gmail.com ‡ linyang@ee.ucla.edu, Department of Electrical and Computer Engineering, and Department of Computer Science, UCLA. 1 arXiv:2507.15855v4 [cs.AI] 30 Sep 2025

Qualifying for the IMO is itself extremely challenging. In the United States, for instance, a student must advance through a rigorous series of national competitions of increasing difficulty, from the American Mathematics Competitions (AMC) to the American Invitational Mathematics Examination (AIME), and finally to the USA Mathematical Olympiad (USAMO). Top performers at USAMO are invited to compete for the six spots on the U.S. national team. Most other countries have similarly stringent selection processes, ensuring that the IMO convenes the world’s most talented pre-university students. A gold medal at the IMO is an extraordinary achievement, awarded to only the top twelfth of the contestants. Consequently, the IMO serves as the preeminent stage where future leaders in mathematics demonstrate their exceptional talent, and success at the IMO has a significant correlation with the Fields Medal, the highest honor in mathematics. Of the 34 Fields medalists awarded since 1990, 11—including renowned mathematicians Terence Tao, Maryam Mirzakhani, and Grigori Perelman—are prior IMO gold medalists.1 Furthermore, the probability that an IMO gold medalist will become a Fields medalist is 50 times larger than the corresponding probability for a PhD graduate from a top-10 mathematics program [6]. Advanced mathematical reasoning is a hallmark of intelligence and the foundation of science and technology. Consequently, automated mathematical reasoning has become a major frontier in artificial intelligence (AI). The rapid advancement of Large Language Models (LLMs) has enabled them to master mathematical benchmarks of increasing difficulty [7, 31]. This progress has been enabled by inference-time methods such as Chain-of-Thought, which improves performance on complex tasks by breaking them down into a sequence of intermediate reasoning steps [33]. Early datasets GSM8K [13] and MATH [19], which test grade-school and high-school mathematics, respectively, have been largely solved. The performance of leading models, such as Gemini 2.5 Pro [16], Grok-4, and GPT-5, is also approaching saturation on the AIME, a significantly more challenging competition benchmark. However, AIME problems are not required to be entirely novel: 8 out of the 30 problems in AIME 2025 were identified as having close analogs in online sources available prior to the event [9]. This allows models to achieve high performance partly through sophisticated pattern recognition and adaptation of existing solutions rather than completely original reasoning. The remarkable success of LLMs on these benchmarks has pushed the frontier of AI mathematical reasoning to the next tier: Olympiad-level problems [18]. This represents a shift not merely in difficulty, but in the very nature of the task. Whereas the AIME requires only a final numerical answer, the USAMO and IMO demand a complete and rigorous proof. In mathematics, an answer without a rigorous proof is merely a conjecture; it is the proof that promotes a conjecture to a theorem. Furthermore, IMO problems are systematically selected for novelty: the selection process is designed to filter out any candidate problem that is too similar to a known problem [4, 21]. Thus, solving IMO problems requires original insights and multi-step creative reasoning, rather than pattern recognition and retrieval from training data. These three pillars—the renowned difficulty, the demand for rigor, and the strict criterion of problem novelty—establish the IMO as a grand challenge and 1 Compiled by the authors by checking the IMO records of all Fields medalists awarded 1990-2022. IMO data was sourced from the official website. 2

the preeminent benchmark for assessing the genuine mathematical reasoning capability of LLMs. The demand for logically sound arguments, in particular, exposes a critical weakness in current LLMs [25]. Recent evaluations on the USAMO 2025 [27] and IMO 2025 [3] show that state-of-the-art models struggle to generate sound, rigorous proofs, often committing logical fallacies or using superficial heuristics, and consequently fail to win even a bronze medal. Last year, Google DeepMind announced a breakthrough: an AI system that achieved a silver-medal performance at the IMO 2024 [8]. Their approach used AlphaGeometry 2 [29, 12], a specialized solver for geometry, and AlphaProof for algebra and number theory problems. Notably, AlphaProof generates proofs in the formal language Lean. The primary advantage of this formal approach is guaranteed correctness: a proof successfully verified by the Lean proof assistant is irrefutably sound. However, this guarantee comes at the cost of human readability. Proofs in formal languages are often verbose and cumbersome, and require specialized training to understand, making them inaccessible to most mathematicians. Our work, in contrast, is situated entirely within the natural language paradigm. Our approach produces human-readable proofs, akin to those in mathematical journals and textbooks. This is crucial for enabling effective human-AI collaboration, where mathematicians can understand, critique, and build upon an AI’s reasoning. While generating machineverifiable proofs is a vital goal, our natural language approach tackles the complementary challenge of creating an AI that can reason and communicate like a human mathematician, thereby making its insights easily accessible to the scientific community. In this paper, we construct a model-agnostic verification-and-refinement pipeline and demonstrate its effectiveness across three leading large language models: Gemini 2.5 Pro, Grok-4, and GPT-5. When equipped with any of these models, our pipeline solved 5 out of the 6 problems from the IMO 2025, achieving an accuracy of approximately 85.7%. This result stands in sharp contrast to the models’ baseline performance. An independent evaluation [3] by MathArena employed a best-of-32 post-selection strategy: for each problem, 32 solutions are generated, and the model itself selects the most promising one for human grading. Even with this performance-boosting inference-time method, the reported accuracies were only 31.6% for Gemini 2.5 Pro, 21.4% for Grok-4, and 38.1% for GPT-5. A pervasive and fundamental challenge in the evaluation of LLMs is data contamination, where test problems are included in a model’s training data, inflating its performance metrics [11]. Our use of the recent IMO 2025 problems helps mitigate this issue. Since Gemini 2.5 Pro and Grok4 were released before the competition, they were evaluated on a pristine testbed. While GPT-5 was released after the competition, raising the possibility of data contamination, the comparison to the best-of-32 baseline remains fair, as any contamination would affect both their and our evaluations. The substantial performance gain—from a baseline of 38.1% to our 85.7%—isolates the contribution of our pipeline, confirming its effectiveness regardless of potential data contamination. Our results demonstrate that strong existing LLMs already possess powerful mathematical reasoning capabilities, but that a verification-and-refinement pipeline is essential for converting their latent capabilities into rigorous mathematical proofs. To further validate the generalizability and robustness of our pipeline, its performance 3

was independently assessed on a different and challenging benchmark: the 2025 International Mathematics Competition for University Students (IMC). The IMC is a prestigious annual contest that includes topics from undergraduate curricula. Thus, it requires a broader and more advanced mathematical knowledge base than the IMO. MathArena evaluated what they termed the “Gemini agent”—our pipeline with Gemini 2.5 Pro as the base model. The agent achieved 94.5% accuracy [5], ranked #3 among 434 human participants. By contrast, the base model alone only scored 57.7% and ranked #92. This third-party validation demonstrates our pipeline’s effectiveness in a more knowledge-intensive domain and on a pristine, uncontaminated dataset, as the competition occurred after the public release of our code. Our work builds upon a growing body of research aimed at enhancing the reasoning capabilities of LLMs through verification and iterative refinement. Foundational works [22, 24] have pioneered the framework of this approach, where a model generates an output, receives feedback, and then refines its work. In the mathematical domain, this approach has been adapted into various methods designed to verify and improve the logical steps of a solution [34, 26, 30]. Another line of research focuses on generating and repairing proofs in formal languages to guarantee correctness [15]. While our pipeline is built on these core ideas of iterative refinement, our contribution is to construct a model-agnostic, inferencetime framework with carefully designed prompts that specialize this process for the extreme rigor and novelty demanded by Olympiad mathematics. Our robust verifier design directly addresses the challenge of generating high-quality feedback, a known bottleneck for selfcorrection methods [20]. By applying our pipeline to state-of-the-art LLMs, we demonstrate a level of performance on the IMO 2025—a grand-challenge benchmark of significantly greater difficulty than those addressed in prior studies—that was previously unattainable. Other teams, including OpenAI [32], Google DeepMind [23], and ByteDance [10], announced strong performance of their AI systems on the IMO 2025 problems after the event.

## 2 Methods

### 2.1 Pipeline

At a high level, our pipeline proceeds as follows (illustrated in Figure 1):

- Step 1: Initial solution generation with the prompt in Section 3.1;
- Step 2: Self-improvement;
- Step 3: Verifying the solution with the prompt in Section 3.2 and generating a bug

report; go to Step 4 or Step 6 (see below for explanations);

- Step 4: Review of the bug report (optional);
- Step 5: Correcting or improving the solution based on the bug report; go to Step 3;
- Step 6: Accept or Reject.

4

Step 1: Initial solution generation Step 2: Self-improvement Step 3: Verification (Go to Step 4 or 6) Step 4: Bug report review (optional) Step 5: Correction Step 6: Accept Step 6′: Reject failed consecutively passes 5 times w/ major issue for 10 steps Figure 1: Flow diagram of our pipeline. See the main text for detailed explanations of each step. We run the procedure some number of times (in parallel or in serial, independently) in order to obtain a correct solution. We hope that the model either outputs a correct solution or reports that it failed to find one.

### 2.2 Solver

The solver prompt in Section 3.1 for Step 1 is designed to emphasize rigor rather than focus on finding the final answer and thus matches the theme of IMO. We have randomly selected some outputs of this step and found that the overall quality of the solutions is pretty low. This is consistent with very recent findings of Ref. [3]. In Step 2, the model is prompted to review and try to improve its work. General-purpose LLMs are not tailored to solving exceptionally challenging mathematical problems in a single pass. A significant constraint is their finite reasoning budget allocated for a single query. This limitation is most transparently illustrated by Gemini 2.5 Pro, which allows for explicit control over its reasoning budget via the number of thinking tokens. Note that thinking is quite token consuming: Even a trivial fact might take a few thousand tokens for the model to prove. The maximum number of thinking tokens for Gemini 2.5 Pro is 32,768, which is not enough for solving a typical IMO problem. We observe that in Step 1, the model almost always uses up this budget. Consequently, it lacks the capacity to fully solve the problem in one go. While Grok-4 and GPT-5 offer no or less granular control over their reasoning effort—it cannot be adjusted for Grok-4 and can only be set categorically for GPT-5—they operate under similar, albeit less explicit, constraints. This is why we break down the problem-solving process into steps. Step 2 effectively injects another budget of reasoning tokens, allowing the model to review and continue its work. We keep monitoring the entire process and consistently observe that the outputs have been noticeably improved during Step 2. Next we will use the verifier to make iterative improvement and decide whether to accept an improved solution. 5

### 2.3 Verifier

The verifier plays an important role in our pipeline. Its functionality is to carefully review a solution step by step and find out issues (if any). We emphasize mathematical rigor and classify issues into critical errors and justification gaps. Critical errors are something that is demonstratively false or with clear logical fallacies, while justification gaps can be major or minor. A major justification gap that cannot be repaired would crash an entire proof, while minor justification gaps may not even be well defined: A minor gap could sometimes be viewed as concise argument. In Step 3, we use the verifier to generate a bug report for each solution outputted in Step 2. The bug report contains a list of issues classified as critical errors or justification gaps. For each issue, an explanation is required. The bug report will serve as useful information for the model to improve the solution, either fixing errors or filling gaps. Step 4 (optional) is to carefully review each issue in the bug report. If the verifier makes a mistake and reports an issue which is not really an issue, the issue would be deleted from the bug report. Thus, Step 4 increases the reliability of the bug report. In Step 5, the model tries to improve the solution based on the bug report. We iterate Steps 3-5 a sufficient number of times until we decide to accept or decline a solution. We accept a solution if it robustly passes the verification process and decline a solution if there are always critical errors or major justification gaps during the iterations. We observe that the verifier is quite reliable but can make mistakes. Since our major goal is not to benchmark the verifier, we do not have quantitative results on its effectiveness. However, we have used this verifier for quite a while (starting from well before IMO 2025). We have been keeping an eye on its performance and below is our qualitative observation:

- Critical errors are seldom missed by the verifier. This is consistent with the observations

in Refs. [28, 17]. In the unlikely event such errors are not caught, simply running the verifier a few more times would very likely catch it. This is good because we do not wish to miss critical errors.

- If the verifier reports a critical error, it may not always be critical, but it almost always

needs some revision.

- The verifier may report some justification gaps which are only slightly beyond trivial

statements and thus are not really gaps for mathematicians. Indeed, our system is quite robust to errors made by the verifier. We iteratively use the verifier a sufficiently number of times. If it misses an error in one iteration, it still has some probability to catch it in the next iteration. Also, if it claims an error which is actually not an error, such a false negative may not go through the bug report review step (Step 4). Furthermore, we instruct the model (who generates the solution) to review each item in the bug report. If the model does not agree with a particular item, it is encouraged to revise its solution to minimize misunderstanding. This is analogues to the peer review process. If a referee makes a wrong judgment, the authors are encouraged to revise the paper. Ultimately, the presentation is improved. 6

At the time we plan to accept a solution, we do not wish the verifier to miss any issue; we run the verifier five times and accept a solution only if it passes every time.

## 3 Experiment Setup

For Gemini 2.5 Pro and Grok-4, we choose low temperature: 0.1. For GPT-5, the temperature cannot be adjusted. For Gemini 2.5 Pro, we use the maximum thinking budget (32768 reasoning tokens). For Grok-4, the reasoning effort cannot be adjusted. For GPT-5, we use high reasoning effort. We disable web search (of course), code, and all other tools. We share the solver and verifier prompts below.

### 3.1 Solver Prompt

### Core Instructions ### * ** Rigor is Paramount :** Your primary goal is to produce a complete and rigorously justified solution. Every step in your solution must be logically sound and clearly explained. A correct final answer derived from flawed or incomplete reasoning is considered a failure. * ** Honesty About Completeness :** If you cannot find a complete solution , you must **not** guess or create a solution that appears correct but contains hidden flaws or justification gaps. Instead , you should present only significant partial results that you can rigorously prove. A partial result is considered significant if it represents a substantial advancement toward a full solution. Examples include: * Proving a key lemma. * Fully resolving one or more cases within a logically sound case -based proof. * Establishing a critical property of the mathematical objects in the problem. * For an optimization problem , proving an upper or lower bound without proving that this bound is achievable. * **Use TeX for All Mathematics :** All mathematical variables , expressions , and relations must be enclosed in TeX delimiters (e.g., ‘Let $n$ be an integer .‘). ### Output Format ### 7

Your response MUST be structured into the following sections , in this exact order. **1. Summary ** Provide a concise overview of your findings. This section must contain two parts: * **a. Verdict :** State clearly whether you have found a complete solution or a partial solution. * **For a complete solution :** State the final answer , e.g., "I have successfully solved the problem. The final answer is ..." * **For a partial solution :** State the main rigorous conclusion(s) you were able to prove , e.g., "I have not found a complete solution , but I have rigorously proven that ..." * **b. Method Sketch :** Present a high -level , conceptual outline of your solution. This sketch should allow an expert to understand the logical flow of your argument without reading the full detail. It should include: * A narrative of your overall strategy. * The full and precise mathematical statements of any key lemmas or major intermediate results. * If applicable , describe any key constructions or case splits that form the backbone of your argument. **2. Detailed Solution ** Present the full , step -by -step mathematical proof. Each step must be logically justified and clearly explained. The level of detail should be sufficient for an expert to verify the correctness of your reasoning without needing to fill in any gaps. This section must contain ONLY the complete , rigorous proof , free of any internal commentary , alternative approaches , or failed attempts. ### Self -Correction Instruction ### Before finalizing your output , carefully review your "Method Sketch" and "Detailed Solution" to ensure they are clean , rigorous , and strictly adhere to all instructions provided 8

above. Verify that every statement contributes directly to the final , coherent mathematical argument.

### 3.2 Verifier Prompt

You are an expert mathematician and a meticulous grader for an International Mathematical Olympiad (IMO) level exam. Your primary task is to rigorously verify the provided mathematical solution. A solution is to be judged correct ** only if every step is rigorously justified .** A solution that arrives at a correct final answer through flawed reasoning , educated guesses , or with gaps in its arguments must be flagged as incorrect or incomplete. ### Instructions ### **1. Core Instructions ** * Your sole task is to find and report all issues in the provided solution. You must act as a ** verifier **, NOT a solver. **Do NOT attempt to correct the errors or fill the gaps you find .** * You must perform a **step -by -step ** check of the entire solution. This analysis will be presented in a ** Detailed Verification Log**, where you justify your assessment of each step: for correct steps , a brief justification suffices; for steps with errors or gaps , you must provide a detailed explanation. **2. How to Handle Issues in the Solution ** When you identify an issue in a step , you MUST first classify it into one of the following two categories and then follow the specified procedure. * **a. Critical Error :** This is any error that breaks the logical chain of the proof. This includes both ** logical fallacies ** (e.g., claiming that ‘A>B, C>D‘ implies ‘A-C>B-D‘) and ** factual errors ** (e.g., a calculation error like ‘2+3=6‘). * ** Procedure :** 9

* Explain the specific error and state that it ** invalidates the current line of reasoning **. * Do NOT check any further steps that rely on this error. * You MUST , however , scan the rest of the solution to identify and verify any fully independent parts. For example , if a proof is split into multiple cases , an error in one case does not prevent you from checking the other cases. * **b. Justification Gap :** This is for steps where the conclusion may be correct , but the provided argument is incomplete , hand -wavy , or lacks sufficient rigor. * ** Procedure :** * Explain the gap in the justification. * State that you will ** assume the step ’s conclusion is true ** for the sake of argument. * Then , proceed to verify all subsequent steps to check if the remainder of the argument is sound. **3. Output Format ** Your response MUST be structured into two main sections: a ** Summary ** followed by the ** Detailed Verification Log **. * **a. Summary ** This section MUST be at the very beginning of your response. It must contain two components: * ** Final Verdict **: A single , clear sentence declaring the overall validity of the solution. For example: "The solution is correct ," "The solution contains a Critical Error and is therefore invalid ," or "The solution ’s approach is viable but contains several Justification Gaps ." * ** List of Findings **: A bulleted list that summarizes ** every ** issue you discovered. For each finding , you must provide: * ** Location :** A direct quote of the key phrase or equation where the issue occurs. * ** Issue :** A brief description of the problem and its classification (** Critical Error ** or ** Justification Gap **). 10

* **b. Detailed Verification Log** Following the summary , provide the full , step -by -step verification log as defined in the Core Instructions. When you refer to a specific part of the solution , ** quote the relevant text ** to make your reference clear before providing your detailed analysis of that part. ** Example of the Required Summary Format ** *This is a generic example to illustrate the required format. Your findings must be based on the actual solution provided below .* ** Final Verdict :** The solution is ** invalid ** because it contains a Critical Error. ** List of Findings :** * ** Location :** "By interchanging the limit and the integral , we get ..." * ** Issue :** Justification Gap - The solution interchanges a limit and an integral without providing justification , such as proving uniform convergence. * ** Location :** "From $A > B$ and $C > D$ , it follows that $A -C > B-D$" * ** Issue :** Critical Error - This step is a logical fallacy. Subtracting inequalities in this manner is not a valid mathematical operation. ====================================================================== ### Problem ### [Paste the TeX for the problem statement here] ====================================================================== ### Solution ### [Paste the TeX for the solution to be verified here] ====================================================================== ### Verification Task Reminder ### 11

Your task is to act as an IMO grader. Now , generate the ** summary ** and the **step -by -step verification log** for the solution above. In your log , justify each correct step and explain in detail any errors or justification gaps you find , as specified in the instructions above.

## 4 Results and Discussion

### 4.1 Performance on IMO 2025

Our model-agnostic pipeline demonstrated consistent success across three leading LLMs. When equipped with Gemini 2.5 Pro, Grok-4, or GPT-5, the pipeline successfully generated rigorous solutions for 5 out of the 6 problems from the IMO 2025. The full, verbatim proofs for each problem from each model, which constitute the primary evidence for this claim, are provided in Appendix A. In our initial experiments with Gemini 2.5 Pro, solutions for Problems 1 and 2 were generated with hints. For Problem 1, the hint was to use mathematical induction; for Problem 2, it was to use analytic geometry. We hypothesized that these general hints do not provide problem-specific insight but rather serve to reduce the computational search space. This hypothesis found strong empirical validation in subsequent experiments, where we successfully generated hint-free solutions for both problems, albeit at a higher computational cost. These hint-free solutions were obtained by only removing the hints from the prompt, without any further modifications to our code. This success confirms that the hints primarily improve efficiency rather than enabling a fundamentally new capability. For archival purposes, the original hint-based solutions from our initial experiments are preserved in Appendix B. Despite the high success rate, the pipeline failed to solve Problem 6, and this failure was consistent across all three base models. For example, the model’s output for this problem using Gemini 2.5 Pro, provided in Appendix A.6, correctly identifies the trivial upper bound of 4048. However, its attempt to prove a matching lower bound is built on a flawed premise. The core error is the assertion that any tile must lie entirely in one of two disjoint regions: the cells to the left of the uncovered squares (CL) or the cells to the right (CR). This is incorrect, as a single tile can span columns that are to the left of one row’s uncovered square and to the right of another’s. This invalidates the subsequent proof. The consistent failure on this problem suggests that certain types of complex combinatorial reasoning remain a significant hurdle for current models, even within a verification-and-refinement framework. Recent findings by MathArena [3] highlight a key challenge: single-pass solution generation is often insufficient for complex tasks demanding mathematical rigor. This is evidenced by the baseline accuracies on the IMO 2025, where even a best-of-32 post-selection strategy yielded only 31.6% for Gemini 2.5 Pro, 21.4% for Grok-4, and 38.1% for GPT-5. In sharp contrast, our pipeline achieved a consistent accuracy of approximately 85.7% across all three models. This substantial improvement demonstrates that the iterative refinement process systematically overcomes the limitations of single-pass generation, such as finite reasoning 12

budgets and the critical errors or justification gaps that often appear in initial drafts. The verifier-guided loop, in particular, proved essential for eliciting rigorous and trustworthy arguments, validating the central thesis of this work: such a pipeline is key to converting the latent capabilities of powerful LLMs into sound mathematical proofs.

### 4.2 Generalization to Undergraduate Mathematics

To assess the broader applicability and robustness of our pipeline, it is essential to evaluate its performance on benchmarks that differ significantly from the IMO. We therefore turn to the International Mathematics Competition for University Students (IMC), a prestigious annual contest held since 1994. Like the IMO, the IMC requires complete and rigorous proofs, making it an excellent testbed for our verification-focused methodology. The IMC problems are drawn from the fields of algebra, analysis (real and complex), geometry, and combinatorics, reflecting the core of a standard undergraduate mathematics curriculum. Thus, the IMC requires a more extensive and advanced knowledge base than the IMO, which is grounded in pre-university mathematics. Its long history and emphasis on rigorous proofs establish the IMC as a well-regarded benchmark for advanced mathematical reasoning. MathArena independently evaluated our pipeline on the IMC 2025 [5]. They implemented our publicly available code with Gemini 2.5 Pro as the base model, referring to this implementation as the “Gemini agent.” The results demonstrated a substantial performance improvement attributable to our pipeline. The Gemini agent achieved an accuracy of 94.5%, a score that would have placed it at rank #3 among the 434 human participants in the official competition [1]. By contrast, the base Gemini 2.5 Pro model scored only 57.7%, corresponding to rank #92. This independent evaluation provides strong external validation for the effectiveness and generalizability of our method. First, the success on the IMC demonstrates that our pipeline is not tailored to IMO-style problems but is robust enough to handle the more knowledgeintensive domain of undergraduate mathematics. Second, because the IMC 2025 took place after the public release of our code on GitHub, the competition serves as a pristine testbed, mitigating the concern of data contamination. Finally, the contrast between the agent’s performance (rank #3) and that of the base model alone (rank #92) highlights how our verification-and-refinement pipeline translates the latent capabilities of a powerful base model into reliable, high-quality, and competitive mathematical reasoning.

## 5 Outlook

A direct avenue for enhancing our pipeline’s capabilities involves leveraging the more powerful, albeit computationally intensive, variants of the base models used in this study. These include Gemini 2.5 Pro Deep Think, Grok-4 Heavy, and GPT-5 Pro. We did not use them in this work due to two significant constraints. First, none of these models are currently available via an API, which precludes their integration into our automated workflow. Second, their current interfaces do not allow for disabling web search. This restriction prevents a 13

fair evaluation on any problem whose solution is available on the Internet. As these models become accessible with the necessary controls via an API, integrating them into our pipeline will be a natural and important next step in pushing the frontiers of automated mathematical reasoning. While our pipeline is model-agnostic, its current implementation operates within a singlemodel paradigm, where one base LLM serves as both the solver and the verifier. A natural extension of this work is to develop a multi-model collaborative framework that leverages the strengths of different leading LLMs (Gemini 2.5 Pro, Grok-4, and GPT-5). In such a system, each step of our pipeline, from initial solution generation to iterative refinement and verification, would involve two sub-steps: first, each model would work independently to generate a solution or verification report; second, the models would engage in a collective review [14], comparing and critiquing all individual outputs to synthesize a single, consolidated output for that step. This collaborative approach is expected to yield significant benefits. For creative tasks like solution generation, it would pool the diverse reasoning pathways of different models, fostering a richer set of novel ideas. For verification, a subtle error or logic gap missed by one model may be caught by another. By combining the complementary strengths of different models, we believe that such a collaborative system would possess significantly stronger and more reliable mathematical reasoning capabilities.

## Archival Note

The research presented in this paper was conducted incrementally, and we document its evolution here for transparency across its arXiv versions. Our initial experiments, detailed in arXiv versions 1 and 2, focused exclusively on the Gemini 2.5 Pro model. In those versions, we presented solutions for Problems 3, 4, and 5 generated without hints. For Problems 1 and 2, we provided solutions generated with general hints (mathematical induction for Problem 1 and analytic geometry for Problem 2). In arXiv version 3, we successfully generated hint-free solutions for Problems 1 and 2 using Gemini 2.5 Pro, albeit at a higher computational cost. These solutions were obtained by only removing the hints from the prompt, without any further modifications to our code. This result confirmed that the pipeline could solve these problems from first principles. The present version (version 4) significantly expands the scope of our work to demonstrate the model-agnostic nature of our pipeline. We applied the pipeline to two additional leading models, Grok-4 and GPT-5, and successfully generated hint-free solutions for all five problems (1 through 5). This generalization prompted the change in the paper’s title to reflect the pipeline’s broad applicability. To maintain a clear record, the appendix is now organized into two parts: Appendix A contains the complete set of hint-free solutions from all three models, while Appendix B archives the original hint-based solutions for Problems 1 and 2 from our initial experiments with Gemini 2.5 Pro. 14

## Acknowledgments

We thank xAI for providing computational credits for using Grok-4. LY is also supported in part by NSF Grant 2221871 and an Amazon Faculty Award.

## References

[1] IMC2025 preliminary results. https://www.imc-math.org.uk/?act=results&by= sum&year=2025. [2] International Mathematical Olympiad. https://www.imo-official.org. [3] Not Even Bronze: Evaluating LLMs on 2025 International Math Olympiad. https: //matharena.ai/imo/, https://matharena.ai/?comp=imo--imo_2025. [4] Organisation of the International Mathematical Olympiad. https://imof.co/ about-imo/activities/. [5] With flying colors: Language models ace the International Mathematics Competition. https://matharena.ai/imc/. [6] R. Agarwal and P. Gaule. Invisible geniuses: Could the knowledge frontier advance faster? American Economic Review: Insights, 2(4):409–24, 2020. [7] J. Ahn, R. Verma, R. Lou, D. Liu, R. Zhang, and W. Yin. Large language models for mathematical reasoning: Progresses and challenges. In N. Falk, S. Papi, and M. Zhang, editors, Proceedings of the 18th Conference of the European Chapter of the Association for Computational Linguistics: Student Research Workshop, pages 225–237, St. Julian’s, Malta, Mar. 2024. Association for Computational Linguistics. [8] AlphaProof and AlphaGeometry teams. AI achieves silver-medal standard solving International Mathematical Olympiad problems. https://deepmind.google/discover/ blog/ai-solves-imo-problems-at-silver-medal-level/, 2024. [9] M. Balunović, J. Dekoninck, I. Petrov, N. Jovanović, and M. Vechev. MathArena: Evaluating LLMs on uncontaminated math competitions. arXiv:2505.23281. [10] ByteDance Seed AI4Math. Seed-prover: Deep and broad reasoning for automated theorem proving. arXiv:2507.23726. [11] Y. Cheng, Y. Chang, and Y. Wu. A survey on data contamination for large language models. arXiv:2502.14425. [12] Y. Chervonyi, T. H. Trinh, M. Olšák, X. Yang, H. Nguyen, M. Menegali, J. Jung, V. Verma, Q. V. Le, and T. Luong. Gold-medalist performance in solving Olympiad geometry with AlphaGeometry2. arXiv:2502.03544. 15

[13] K. Cobbe, V. Kosaraju, M. Bavarian, M. Chen, H. Jun, L. Kaiser, M. Plappert, J. Tworek, J. Hilton, R. Nakano, C. Hesse, and J. Schulman. Training verifiers to solve math word problems. arXiv:2110.14168. [14] Y. Du, S. Li, A. Torralba, J. B. Tenenbaum, and I. Mordatch. Improving factuality and reasoning in language models through multiagent debate. In The Twelfth International Conference on Learning Representations, 2024. [15] E. First, M. N. Rabe, T. Ringer, and Y. Brun. Baldur: Whole-proof generation and repair with large language models. In Proceedings of the 31st ACM Joint European Software Engineering Conference and Symposium on the Foundations of Software Engineering, ESEC/FSE 2023, page 1229–1241, New York, NY, USA, 2023. Association for Computing Machinery. [16] Gemini Team, Google. Gemini 2.5: Pushing the frontier with advanced reasoning, multimodality, long context, and next generation agentic capabilities. arXiv:2507.06261. [17] J. Guo, Y. Wu, J. Qiu, K. Huang, X. Juan, L. Yang, and M. Wang. Temporal consistency for LLM reasoning process error identification. arXiv:2503.14495. [18] C. He, R. Luo, Y. Bai, S. Hu, Z. Thai, J. Shen, J. Hu, X. Han, Y. Huang, Y. Zhang, J. Liu, L. Qi, Z. Liu, and M. Sun. OlympiadBench: A challenging benchmark for promoting AGI with Olympiad-level bilingual multimodal scientific problems. In L.-W. Ku, A. Martins, and V. Srikumar, editors, Proceedings of the 62nd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), pages 3828– 3850, Bangkok, Thailand, Aug. 2024. Association for Computational Linguistics. [19] D. Hendrycks, C. Burns, S. Kadavath, A. Arora, S. Basart, E. Tang, D. Song, and J. Steinhardt. Measuring mathematical problem solving with the math dataset. In J. Vanschoren and S. Yeung, editors, Proceedings of the Neural Information Processing Systems Track on Datasets and Benchmarks, volume 1, 2021. [20] R. Kamoi, Y. Zhang, N. Zhang, J. Han, and R. Zhang. When can LLMs actually correct their own mistakes? A critical survey of self-correction of LLMs. Transactions of the Association for Computational Linguistics, 12:1417–1440, 2024. [21] D. Kim. Looking back on the problem selection committee. https://web.stanford. edu/~dkim04/blog/imo-psc-2023/, 2023. [22] G. Kim, P. Baldi, and S. McAleer. Language models can solve computer tasks. In A. Oh, T. Naumann, A. Globerson, K. Saenko, M. Hardt, and S. Levine, editors, Advances in Neural Information Processing Systems, volume 36, pages 39648–39677. Curran Associates, Inc., 2023. [23] T. Luong, E. Lockhart, et al. Advanced version of Gemini with Deep Think officially achieves gold-medal standard at the International 16

Mathematical Olympiad. https://deepmind.google/discover/blog/ advanced-version-of-gemini-with-deep-think-officially-achieves-gold-medal-standard2025. [24] A. Madaan, N. Tandon, P. Gupta, S. Hallinan, L. Gao, S. Wiegreffe, U. Alon, N. Dziri, S. Prabhumoye, Y. Yang, S. Gupta, B. P. Majumder, K. Hermann, S. Welleck, A. Yazdanbakhsh, and P. Clark. Self-refine: Iterative refinement with self-feedback. In A. Oh, T. Naumann, A. Globerson, K. Saenko, M. Hardt, and S. Levine, editors, Advances in Neural Information Processing Systems, volume 36, pages 46534–46594. Curran Associates, Inc., 2023. [25] H. Mahdavi, A. Hashemi, M. Daliri, P. Mohammadipour, A. Farhadi, S. Malek, A. K. Yekta Yazdanifard, and V. Honavar. Brains vs. Bytes: Evaluating LLM Proficiency in Olympiad Mathematics. arXiv:2504.01995. [26] D. Paul, M. Ismayilzada, M. Peyrard, B. Borges, A. Bosselut, R. West, and B. Faltings. REFINER: Reasoning feedback on intermediate representations. In Y. Graham and M. Purver, editors, Proceedings of the 18th Conference of the European Chapter of the Association for Computational Linguistics (Volume 1: Long Papers), pages 1100–1126, St. Julian’s, Malta, Mar. 2024. Association for Computational Linguistics. [27] I. Petrov, J. Dekoninck, M. D. Lyuben Baltadzhiev, K. Minchev, M. Balunović, N. Jovanović, and M. Vechev. Proof or Bluff? Evaluating LLMs on 2025 USA Math Olympiad. arXiv:2503.21934. [28] J. Sheng, L. Lyu, J. Jin, T. Xia, A. Gu, J. Zou, and P. Lu. Solving inequality proofs with large language models. arXiv:2506.07927. [29] T. H. Trinh, Y. Wu, Q. V. Le, H. He, and T. Luong. Solving olympiad geometry without human demonstrations. Nature, 625(7995):476–482, 2024. [30] P. Wang, L. Li, Z. Shao, R. Xu, D. Dai, Y. Li, D. Chen, Y. Wu, and Z. Sui. Mathshepherd: Verify and reinforce LLMs step-by-step without human annotations. In L.-W. Ku, A. Martins, and V. Srikumar, editors, Proceedings of the 62nd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), pages 9426– 9439, Bangkok, Thailand, Aug. 2024. Association for Computational Linguistics. [31] P.-Y. Wang, T.-S. Liu, C. Wang, Y.-D. Wang, S. Yan, C.-X. Jia, X.-H. Liu, X.-W. Chen, J.-C. Xu, Z. Li, and Y. Yu. A survey on large language models for mathematical reasoning. arXiv:2506.08446. [32] A. Wei, S. Hsu, and N. Brown. https://x.com/alexwei_/status/ 1946477742855532918. [33] J. Wei, X. Wang, D. Schuurmans, M. Bosma, B. Ichter, F. Xia, E. Chi, Q. V. Le, and D. Zhou. Chain-of-thought prompting elicits reasoning in large language models. 17

In S. Koyejo, S. Mohamed, A. Agarwal, D. Belgrave, K. Cho, and A. Oh, editors, Advances in Neural Information Processing Systems, volume 35, pages 24824–24837. Curran Associates, Inc., 2022. [34] Y. Weng, M. Zhu, F. Xia, B. Li, S. He, S. Liu, B. Sun, K. Liu, and J. Zhao. Large language models are better reasoners with self-verification. In H. Bouamor, J. Pino, and K. Bali, editors, Findings of the Association for Computational Linguistics: EMNLP 2023, pages 2550–2575, Singapore, Dec. 2023. Association for Computational Linguistics.

## A Verbatim Model Outputs for IMO 2025 Problems

### (Hint-Free)

This appendix contains the solutions produced by the models. They are presented verbatim, with the sole exception of minor formatting corrections limited to adding missing TeX delimiters (e.g., “$”) or replacing unicode symbols with the corresponding LaTeX symbols where necessary for LaTeX compilation. No part of the original wording, mathematical steps, or logic has been altered.

### A.1 Problem 1

Problem 1. A line in the plane is called sunny if it is not parallel to any of the x-axis, the y-axis, and the line x + y = 0. Let n ≥ 3 be a given integer. Determine all nonnegative integers k such that there exist n distinct lines in the plane satisfying both the following:

- For all positive integers a and b with a + b ≤ n + 1, the point (a, b) is on at least one

of the lines; and

- Exactly k of the lines are sunny.

#### A.1.1 Solution by Gemini 2.5 Pro

Let Pn = {(a, b) ∈ Z2 | a > 0, b > 0, a + b ≤ n + 1} be the set of points to be covered. A line is called *sunny* if it is not parallel to the x-axis (slope 0), the y-axis (undefined slope), or the line x + y = 0 (slope -1). Let k be the number of sunny lines in a set of n distinct lines covering Pn. Let Kn be the set of all possible values of k for a given integer n ≥ 3. **Part 1: The case n = 3** For n = 3, the set of points is P3 = {(1, 1), (1, 2), (2, 1), (1, 3), (2, 2), (3, 1)}. We show that K3 = {0, 1, 3}. * **k = 0 is possible:** The set of non-sunny lines L = {x = 1, x = 2, x = 3} covers all points in P3. For any (a, b) ∈ P3, a ∈ {1, 2, 3}, so (a, b) lies on the line x = a. Thus, 0 ∈ K3. * **k = 1 is possible:** Consider L = {x = 1, y = 1, y = x}. The lines x = 1 and y = 1 are 18

not sunny. The line y = x (slope 1) is sunny. This set of lines covers all points in P3. Thus, 1 ∈ K3. * **k = 3 is possible:** Consider L = {y = x, x + 2y = 5, 2x + y = 5}. The slopes are 1, −1/2, −2. All three lines are sunny. The line y = x covers (1, 1) and (2, 2). The line x + 2y = 5 covers (1, 2) and (3, 1). The line 2x + y = 5 covers (1, 3) and (2, 1). Together, these three lines cover all six points of P3. Thus, 3 ∈ K3. * **k = 2 is impossible:** We prove this by contradiction. Assume there exists a set of 3 lines with 2 sunny lines (L1, L2) and 1 non-sunny line (L3) that covers P3. **Lemma:** A sunny line contains at most two points of P3. **Proof:** The sets of three or more collinear points in P3 are {(1, 1), (1, 2), (1, 3)} (on line x = 1), {(1, 1), (2, 1), (3, 1)} (on line y = 1), and {(1, 3), (2, 2), (3, 1)} (on line x+y = 4). All three of these lines are nonsunny. Any other line can intersect P3 in at most two points. Thus, a sunny line contains at most two points of P3. Now we proceed with a case analysis on the non-sunny line L3. 1. **L3 covers 3 points of P3**: L3 must be one of x = 1, y = 1, or x + y = 4. * If L3 = x = 1, it covers {(1, 1), (1, 2), (1, 3)}. The remaining points are R1 = {(2, 1), (2, 2), (3, 1)}. These three points are not collinear. To cover them with two lines L1, L2, one line must cover two points. The lines defined by pairs of points in R1 are x = 2, y = 1, and x+y = 4. All are non-sunny, contradicting that L1, L2 are sunny. * If L3 = y = 1, it covers {(1, 1), (2, 1), (3, 1)}. The remaining points are R2 = {(1, 2), (1, 3), (2, 2)}. The lines defined by pairs of points in R2 are x = 1, y = 2, and x + y = 4. All are non-sunny. Contradiction. * If L3 = x + y = 4, it covers {(1, 3), (2, 2), (3, 1)}. The remaining points are R3 = {(1, 1), (1, 2), (2, 1)}. The lines defined by pairs of points in R3 are x = 1, y = 1, and x + y = 3. All are non-sunny. Contradiction. 2. **L3 covers 2 points of P3**: The remaining 4 points must be covered by two sunny lines L1, L2. By the lemma, each must cover at most 2 points. Thus, each must cover exactly 2 points. The set of 4 remaining points must be partitioned into two pairs, each defining a sunny line. The non-sunny lines covering exactly 2 points of P3 are x = 2, y = 2, x + y = 3. * If L3 = x = 2, it covers {(2, 1), (2, 2)}. The remaining points are R4 = {(1, 1), (1, 2), (1, 3), (3, 1)}. The partitions of R4 into two pairs are: - {(1, 1), (1, 2)} (on non-sunny x = 1) and {(1, 3), (3, 1)} (on non-sunny x + y = 4). - {(1, 1), (1, 3)} (on non-sunny x = 1) and {(1, 2), (3, 1)} (on sunny x + 2y = 5). - {(1, 1), (3, 1)} (on non-sunny y = 1) and {(1, 2), (1, 3)} (on non-sunny x = 1). In no case do we get two sunny lines. Contradiction. * If L3 = y = 2, it covers {(1, 2), (2, 2)}. The remaining points are R5 = {(1, 1), (2, 1), (1, 3), (3, 1)}. This case is symmetric to L3 = x = 2 by reflection across y = x, which preserves sunniness. No partition yields two sunny lines. Contradiction. * If L3 = x+y = 3, it covers {(1, 2), (2, 1)}. The remaining points are R6 = {(1, 1), (1, 3), (2, 2), (3, 1)}. The partitions of R6 into two pairs are: - {(1, 1), (2, 2)} (on sunny y = x) and {(1, 3), (3, 1)} (on non-sunny x + y = 4). - {(1, 1), (1, 3)} (on non-sunny x = 1) and {(2, 2), (3, 1)} (on nonsunny x + y = 4). - {(1, 1), (3, 1)} (on non-sunny y = 1) and {(1, 3), (2, 2)} (on non-sunny x + y = 4). In no case do we get two sunny lines. Contradiction. 3. **L3 covers 1 or 0 points of P3**: The remaining ≥ 5 points must be covered by two sunny lines L1, L2. By the lemma, they can cover at most 2 + 2 = 4 points. This is not enough. Contradiction. Since all cases lead to a contradiction, k = 2 is impossible for n = 3. Thus, K3 = {0, 1, 3}. 19

**Part 2: A Preliminary Lemma** **Lemma:** For any integer m ≥ 2, the set of points Pm cannot be covered by m − 1 lines. **Proof:** We proceed by induction on m. * **Base Case (m = 2):** P2 = {(1, 1), (1, 2), (2, 1)}. These three points are not collinear, so they cannot be covered by 2 − 1 = 1 line. * **Inductive Step:** Assume for some m ≥ 3 that Pm−1 cannot be covered by m − 2 lines. Suppose for contradiction that Pm can be covered by a set L of m − 1 lines. The set Pm contains the m points S = {(1, 1), (1, 2), . . . , (1, m)}, which lie on the line x = 1. To cover these m points with m − 1 lines from L, by the Pigeonhole Principle, at least one line in L must contain at least two points from S. Such a line must be the line x = 1. Let L1 = (x = 1) ∈ L. The remaining m − 2 lines in L \ {L1} must cover the remaining points Pm \ S = {(a, b) ∈ Pm | a ≥ 2}. The affine transformation T(x, y) = (x − 1, y) maps the set Pm \ S bijectively onto Pm−1, since T(Pm \ S) = {(a − 1, b) | a ≥ 2, b > 0, a + b ≤ m + 1} = {(a′ , b) | a′ ≥ 1, b > 0, a′ + 1 + b ≤ m + 1} = {(a′ , b) | a′ > 0, b > 0, a′ + b ≤ m} = Pm−1. The set of transformed lines {T(L) | L ∈ L \ {L1}} consists of m − 2 lines that cover Pm−1. This contradicts our induction hypothesis. Therefore, Pm cannot be covered by m − 1 lines for any m ≥ 2. **Part 3: Key Lemma for n ≥ 4** **Lemma:** For n ≥ 4, any set L of n lines covering Pn must contain at least one of the lines x = 1, y = 1, or x+y = n+1. **Proof:** Assume for contradiction that L covers Pn but contains none of these three lines. Let SV = {(1, j) | 1 ≤ j ≤ n}, SH = {(i, 1) | 1 ≤ i ≤ n}, and SD = {(l, n + 1 − l) | 1 ≤ l ≤ n}. Since x = 1 / ∈ L, each of the n lines in L must intersect the line x = 1 at exactly one point, so each line covers exactly one point from SV . Similarly, each line covers exactly one point from SH and one from SD. This establishes a bijection between the lines in L and the points in each of the sets SV , SH, SD. Let Lj be the line covering (1, j) for j ∈ {1, . . . , n}. Let Lj intersect SH at (σ(j), 1) and SD at (τ(j), n + 1 − τ(j)). Since each line covers one point from each set, σ and τ must be permutations of {1, . . . , n}. For j = 1, L1 covers (1, 1) ∈ SV ∩ SH, so σ(1) = 1. For j = n, Ln covers (1, n) ∈ SV ∩ SD, so τ(n) = 1. For j ∈ {2, . . . , n − 1}, the points (1, j), (σ(j), 1), and (τ(j), n+1−τ(j)) are distinct and collinear. The collinearity condition implies τ(j) = n + 1 − j + (n−j)(j−1) σ(j)−j . 1. **Case j = 2 (since n ≥ 4):** Let i2 = σ(2) and l2 = τ(2). l2 = n − 1 + n−2 i2−2 . Since σ is a permutation and σ(1) = 1, i2 ∈ {2, . . . , n}. If i2 = 2, the line is x + y = 3. For this line to pass through a point in SD, we need n + 1 = 3 =⇒ n = 2, which contradicts n ≥ 4. So i2 ̸= 2. Let d = i2 − 2 ∈ {1, . . . , n − 2}. For l2 to be an integer, d must divide n − 2. If d < n − 2, then n−2 d > 1, so l2 = n − 1 + n−2 d > n, which contradicts l2 ∈ {1, . . . , n}. Thus, d = n − 2, which implies i2 = n. This gives l2 = n − 1 + 1 = n. So we must have σ(2) = n and τ(2) = n. 2. **Case j = 3 (since n ≥ 4):** Let i3 = σ(3) and l3 = τ(3). l3 = n − 2 + 2(n−3) i3−3 . Since σ is a permutation with σ(1) = 1, σ(2) = n, we have i3 ∈ {2, . . . , n − 1}. If i3 = 3, the line is x + y = 4. For this to pass through a point in SD, we need n + 1 = 4 =⇒ n = 3, which contradicts n ≥ 4. So i3 ̸= 3. Let d = i3 − 3. Then i3 ∈ {2, 4, . . . , n − 1}, so d ∈ {−1, 1, 2, . . . , n − 4}. If d > 0, then d ≤ n − 4. For l3 ≤ n, we need n − 2 + 2(n−3) d ≤ 20

n =⇒ 2(n−3) d ≤ 2 =⇒ n − 3 ≤ d. This requires n − 3 ≤ d ≤ n − 4, which is impossible. If d < 0, the only possibility is d = −1, which means i3 = 2. Then l3 = n − 2 + 2(n−3) −1 = 4 − n. For l3 ∈ {1, . . . , n}, we need 1 ≤ 4 − n, which implies n ≤ 3. This contradicts n ≥ 4. Since all possibilities for σ(3) lead to a contradiction, our initial assumption must be false. Thus, for n ≥ 4, L must contain one of the lines x = 1, y = 1, x + y = n + 1. **Part 4: Recurrence Relation for Kn** * **Kn ⊆ Kn−1 for n ≥ 4:** Let L be a valid configuration of n lines for Pn with k sunny lines. By the Key Lemma, L must contain a line L ∈ {x = 1, y = 1, x + y = n + 1}. All these lines are non-sunny. The number of sunny lines in L\{L} is k. If L = x+y = n+1, it covers the points {(i, n + 1 − i)}n i=1. The remaining n − 1 lines must cover Pn \ L = Pn−1. So L \ {L} is a valid configuration for Pn−1 with k sunny lines. Thus k ∈ Kn−1. If L = x = 1, the remaining n − 1 lines cover Pn \ {(1, j)}n j=1. The transformation T(x, y) = (x − 1, y) maps these points to Pn−1. The set of transformed lines is a valid configuration for Pn−1. T preserves slopes, so sunniness is preserved. The number of sunny lines is k, so k ∈ Kn−1. The case L = y = 1 is symmetric. In all cases, if k ∈ Kn, then k ∈ Kn−1. * **Kn−1 ⊆ Kn for n ≥ 4:** Let L′ be a valid configuration for Pn−1 with k sunny lines. Let T−1 (x′ , y′ ) = (x′ +1, y′ ). Let L′′ = {T−1 (L′ ) | L′ ∈ L′ }. L′′ is a set of n−1 lines covering T−1 (Pn−1) = {(a, b) ∈ Pn | a ≥ 2}. The number of sunny lines in L′′ is k. Consider the set of n lines L = L′′ ∪ {x = 1}. The line x = 1 is not sunny and covers all points in Pn with x-coordinate 1. Thus L covers Pn. We must check that the lines in L are distinct. This requires x = 1 / ∈ L′′ , which is equivalent to showing that the line x′ = 0 is not in L′ . Suppose x′ = 0 is in L′ . Since x′ = 0 contains no points of Pn−1 (where a > 0), the remaining (n − 1) − 1 = n − 2 lines in L′ must cover all of Pn−1. But by our Preliminary Lemma, for n ≥ 4, Pn−1 cannot be covered by n − 2 lines. This is a contradiction. Thus, x = 1 / ∈ L′′ , and L is a valid configuration for Pn with k sunny lines. So if k ∈ Kn−1, then k ∈ Kn. **Part 5: Final Conclusion** From Part 4, we have Kn = Kn−1 for all n ≥ 4. By induction, this means Kn = K3 for all n ≥ 3. In Part 1, we established that K3 = {0, 1, 3}. Therefore, for any integer n ≥ 3, the set of all possible values for k is {0, 1, 3}.

#### A.1.2 Solution by Grok-4

Let Sn = {(a, b) | a, b ≥ 1, a + b ≤ n + 1 integers}, a set of n+1 2  points. The boundary consists of three sides: left a = 1 (n points (1, b) for b = 1 to n), bottom b = 1 (n points (a, 1) for a = 1 to n), anti-diagonal a + b = n + 1 (n points (a, n + 1 − a) for a = 1 to n), with corners (1, 1), (1, n), (n, 1) shared, so total boundary lattice points: 3n − 3. We prove by induction on n ≥ 3 that the possible k are exactly 0, 1, 3. **Base case n = 3:** S3 = {(1, 1), (1, 2), (1, 3), (2, 1), (2, 2), (3, 1)}. *Constructions:* - k = 0: Lines x = 1 (covers (1, 1), (1, 2), (1, 3)), x = 2 (covers (2, 1), (2, 2)), x = 3 (covers (3, 1)); all vertical, non-sunny. - k = 1: Lines x + y = 3 (covers (1, 2), (2, 1)), x + y = 4 (covers (1, 3), (2, 2), (3, 1)), y = x (covers (1, 1); sunny slope 1). (Note: x+y = 3, 4 are anti-diagonals, non-sunny.) - k = 3: Lines y = x (covers (1, 1), (2, 2)), 21

y = −x/2 + 5/2 (covers (1, 2), (3, 1); slope −1/2), y = −2x + 5 (covers (1, 3), (2, 1); slope −2); all sunny. *Impossibility of other k:* Since n = 3, k ≤ 3; we show k = 2 impossible (others trivial: k > 3 impossible, k < 0 invalid). Suppose 3 lines with exactly 2 sunny, 1 non-sunny. The non-sunny is one of: horizontal (y = c, c = 1, 2, 3), vertical (x = c, c = 1, 2, 3), antidiagonal (x + y = d, d = 2, 3, 4). Each covers: y = 1: 3 pts {(1, 1), (2, 1), (3, 1)}; y = 2: 2 pts {(1, 2), (2, 2)}; y = 3: 1 pt (1, 3); x = 1: 3 pts {(1, 1), (1, 2), (1, 3)}; x = 2: 2 pts {(2, 1), (2, 2)}; x = 3: 1 pt (3, 1); x + y = 2: 1 pt (1, 1); x + y = 3: 2 pts {(1, 2), (2, 1)}; x + y = 4: 3 pts {(1, 3), (2, 2), (3, 1)}. Thus max 3 pts, min 1. If non-sunny covers 3 pts, remaining R has 3 pts. Possible R: for y = 1, R = {(1, 2), (1, 3), (2, 2)}; pairs: (1, 2)−(1, 3) vertical (non-sunny), (1, 2)−(2, 2) horizontal (non-sunny), (1, 3)−(2, 2) slope −1 (non-sunny); no sunny pair, so cannot cover with 2 sunny (each covers ≤ 1 from R, total ≤ 2 < 3). For x = 1, R = {(2, 1), (2, 2), (3, 1)}; pairs: (2, 1) − (2, 2) vertical, (2, 1) − (3, 1) horizontal, (2, 2) − (3, 1) slope −1; again no sunny pair. For x + y = 4, R = {(1, 1), (1, 2), (2, 1)}; pairs analogously non-sunny. Thus impossible. If covers 2 pts, R has 4 pts; need to cover with 2 sunny. But 2 sunny cover at most 4 pts only if each covers exactly 2 from R (and disjoint). Check each possible: e.g., for y = 2, R = {(1, 1), (1, 3), (2, 1), (3, 1)}; possible pairs on sunny: e.g., (1, 1) − (2, 1) horizontal no; (1, 1)−(1, 3) vertical no; (1, 1)−(3, 1) horizontal no; (1, 3)−(2, 1) slope −2; (1, 3)−(3, 1) slope −1 no; (2, 1)−(3, 1) horizontal no. So sunny pairs: only (1, 3)−(2, 1). Remaining (1, 1), (3, 1) are on horizontal (non-sunny). No other sunny pair, cannot partition into two sunny pairs. Similarly for x = 2, R = {(1, 1), (1, 2), (1, 3), (3, 1)}; sunny pairs: e.g., (1, 2) − (3, 1) slope −0.5; (1, 3) − (3, 1) slope −1 no; (1, 1) − (3, 1) horizontal no; (1, 1) − (1, 2), (1, 1) − (1, 3) vertical no; (1, 2) − (1, 3) vertical no. Only one sunny pair, remaining two on vertical (nonsunny). For x + y = 3, R = {(1, 1), (1, 3), (2, 2), (3, 1)}; sunny pairs: (1, 1) − (2, 2) slope 1; (1, 3)−(3, 1) slope −1 no; (1, 1)−(3, 1) horizontal; (1, 1)−(1, 3) vertical; (2, 2)−(3, 1) slope −1 no; (1, 3) − (2, 2) slope −1 no. Only (1, 1) − (2, 2) sunny, remaining (1, 3), (3, 1) on slope −1 no. Thus no partition into two sunny pairs for any size-2 non-sunny. If covers 1 pt, R has 5 pts; 2 sunny cover at most 2 × 2 = 4 < 5 (in S3, no sunny through 3 pts: the only lines through 3 pts are the non-sunny full sides, and no sunny triple collinear, as checked by enumeration: e.g., (1, 1), (1, 2), (1, 3) vertical; etc.), impossible. Thus only k = 0, 1, 3 for n = 3. **Inductive step:** Assume for all 3 ≤ m < n, possible k for Sm are 0, 1, 3. For Sn, first prove any covering by n distinct lines must include at least one full boundary side: x = 1, y = 1, or x + y = n + 1 (all non-sunny). *Lemma 1:* Any sunny line covers at most 2 boundary points. The continuous boundary is the triangle with vertices (1, 1), (1, n), (n, 1). A line L intersects this closed convex set in a (possibly degenerate) segment. Since Sn is convex, L∩ boundary has at most 2 points (endpoints of the segment). Moreover, since sunny L is not parallel to any side (axes or slope −1), L intersects each side in at most 1 point and cannot contain any positive-length segment of a side (would require parallelism). Thus L∩ boundary consists of at most 2 isolated points. Since these intersection points are either at lattice points or between them, 22

but the lemma concerns lattice points on the boundary covered by L, and because there is no segment overlap with the boundary, there are no additional lattice points on L lying on the boundary beyond these at most 2 intersection points (if they coincide with lattice points). Hence at most 2 boundary lattice points. *Lemma 2:* Any non-sunny line not a full boundary side covers at most 2 boundary points. Non-sunny are horizontal (y = c), vertical (x = c), or anti-diagonal (x + y = d). If not full side, then: for y = c (1 < c < n), intersects left at (1, c), anti-diagonal at (n+1−c, c) (if integer), no bottom; at most 2. For y = 1 but not full (impossible, as it would be the side). Similarly for partial verticals/anti-diagonals: e.g., x = c (1 < c < n) intersects bottom at (c, 1), anti-diagonal at (c, n + 1 − c); at most 2. For x + y = d (2 < d < n + 1), intersects left at (1, d − 1) (if d − 1 ≤ n), bottom at (d − 1, 1) (if d − 1 ≤ n); at most 2 (cannot hit anti-diagonal unless d = n + 1 full). Thus, if no full side included, each of n lines covers ≤ 2 boundary points, total ≤ 2n. But boundary has 3n − 3 > 2n for n > 3, contradiction. Hence at least one full side, say x = 1 (non-sunny), covering n points on left. Remaining points {(a, b) ∈ Sn | a ≥ 2} ∼ = Sn−1 via (a − 1, b). The other n − 1 lines cover Sn−1, so by induction, number of sunny among them is k′ ∈ {0, 1, 3}, total k = k′ . Same if other side chosen first. Thus possible k ∈ {0, 1, 3}. **Constructions for n:** By induction, assume for m < n. - k = 0: Include x = 1 (non-sunny), recursively cover Sn−1 with n − 1 non-sunny lines. - k = 1: Include full sides recursively n − 1 times to reach S1 = {(1, 1)}, cover with sunny line (e.g., arbitrary sunny through it); total 1 sunny, n − 1 non-sunny. - k = 3: Include full sides recursively n − 3 times to reach S3, cover with 3 sunny as base; total 3 sunny, n − 3 non-sunny. Thus all k = 0, 1, 3 achievable, completing the induction.

#### A.1.3 Solution by GPT-5

Let n ≥ 3 be fixed and define Sn := {(a, b) ∈ Z2 : a ≥ 1, b ≥ 1, a + b ≤ n + 1}. A line is called non-sunny if it is horizontal, vertical, or of slope −1; otherwise it is sunny. Lemma 1 (Boundary lemma). Let m ≥ 4. Suppose m distinct lines L1, . . . , Lm cover Sm. Then one of the Li is exactly one of the three sides x = 1, y = 1, or x + y = m + 1. Proof. Let Bm be the set of lattice points on the boundary of the (closed) lattice triangle with vertices (1, 1), (1, m), (m, 1). The three sides contain m, m, and m lattice points, and the three vertices are double-counted, so |Bm| = 3m − 3. A line that is not equal to any side of this triangle intersects its boundary in at most two points (the triangle is convex). Therefore, if none of the Li is a side, then together the Li can cover at most 2m boundary lattice points, which is < 3m − 3 for m ≥ 4, a contradiction. Hence at least one Li is a boundary side. Lemma 2 (Peeling). In any cover of Sn by n distinct lines, at least n − 3 of the lines are non-sunny. Moreover, after removing n − 3 boundary sides (all non-sunny) as provided by Lemma 1 iteratively while the current size m ≥ 4, the remaining three lines from the original family cover a set that is a translate of S3. Proof. Initialize m := n and U := Sm. By Lemma 1, since m ≥ 4, among the covering lines there is a boundary side of U; remove this line and all points of U on it. The uncovered 23

set is, up to translation, Sm−1. Indeed: - Removing y = 1 yields {(a, b) : a ≥ 1, b ≥ 2, a+b ≤ m + 1}, which is the translate by (0, −1) of Sm−1. - Removing x = 1 yields the translate by (−1, 0) of Sm−1. - Removing x + y = m + 1 yields Sm−1 itself. In all cases the removed line is non-sunny. Replace m by m − 1 and U by the uncovered set, and repeat while m ≥ 4. After exactly n − 3 iterations we obtain m = 3 and three of the original lines remain and cover a translate of S3. Therefore at least n − 3 of the original lines are non-sunny. Remark on invariance. Translations preserve parallelism and slopes, hence preserve the property of being sunny or non-sunny. Thus, in analyzing the last three lines covering a translate of S3, we may translate the entire configuration so that the uncovered set is exactly S3 without affecting the number of sunny lines. We now analyze three-line covers of S3. Let P := S3 = {(1, 1), (1, 2), (1, 3), (2, 1), (2, 2), (3, 1)}. Lemma 3 (Two-point sunny lines through P). Among all pairs of distinct points in P, the only pairs that determine a sunny line are the three disjoint pairs {(1, 1), (2, 2)}, {(1, 2), (3, 1)}, {(1, 3), (2, 1)}. Each of these lines contains exactly the two indicated points of P. No sunny line contains three points of P. Proof. Compute slopes for all pairs in P. Horizontal pairs (slope 0), vertical pairs (slope ∞), and pairs on lines x + y = c (slope −1) are non-sunny. A direct check shows the only remaining pair slopes are 1 for (1, 1)−(2, 2), −1/2 for (1, 2)−(3, 1), and −2 for (1, 3)−(2, 1), which are sunny. Each of these three lines misses the other three points of P, so each contains exactly two points. Any line through three points of P must be one of the three sides of the triangle, hence non-sunny. Lemma 4 (Non-sunny lines through P). A non-sunny line contains at most three points of P. Those with three points are exactly the boundary sides x = 1, y = 1, x + y = 4. The only non-sunny lines with exactly two points of P are x = 2, y = 2, and x + y = 3. Proof. Immediate by inspection of columns x = 1, 2, 3, rows y = 1, 2, 3, and diagonals x + y = c with c ∈ {2, 3, 4}. Proposition 5 (Impossibility of exactly two sunny lines on S3). There is no cover of P by three distinct lines with exactly two sunny lines. Proof. Suppose three lines S1, S2 (sunny) and N (non-sunny) cover P. Case 1: N contains at most two points of P. By Lemma 3, each sunny line contains at most two points of P. To cover six points with three lines, we must have that each line contains exactly two points of P, and these three two-point sets form a partition of P. Then N is one of the non-sunny two-point lines listed in Lemma 4. - If N is x = 2 with points {(2, 1), (2, 2)}, then the remaining four points are {(1, 1), (1, 2), (1, 3), (3, 1)}. By Lemma 3, among these four points the only sunny pair is {(1, 2), (3, 1)}. Hence two sunny lines cannot partition these four points into two sunny pairs, a contradiction. - If N is y = 2 with points {(1, 2), (2, 2)}, the remaining four points are {(1, 1), (1, 3), (2, 1), (3, 1)}. Among these, the only sunny pair is {(1, 3), (2, 1)}. Again impossible. - If N is x+y = 3 with points {(1, 2), (2, 1)}, the remaining four points are {(1, 1), (1, 3), (2, 2), (3, 1)}. Among these, the only sunny pair is {(1, 1), (2, 2)}. Again impossible. Case 2: N contains at least three points of P. By Lemma 4, N is one of the three sides x = 1, y = 1, or x + y = 4. Consider the three remaining points Q := P \ N. In each of the 24

three possibilities, Q consists of three points such that any pair among them lies on a nonsunny line: - If N is x = 1, then Q = {(2, 1), (2, 2), (3, 1)}; pairs are vertical, horizontal, and slope −1. - If N is y = 1, then Q = {(1, 2), (1, 3), (2, 2)}; pairs are vertical, horizontal, and slope −1. - If N is x + y = 4, then Q = {(1, 1), (1, 2), (2, 1)}; pairs are vertical, horizontal, and slope −1. Thus no sunny line contains two points of Q. Two sunny lines can cover at most two of the three points in Q, contradiction. In all cases we obtain a contradiction. Hence such a cover does not exist. Proposition 6 (Achievability on S3). There exist covers of P by three lines with exactly t sunny lines for each t ∈ {0, 1, 3}. - t = 0: The three sides x = 1, y = 1, x + y = 4. - t = 1: The lines x = 1, y = 1, and y = x. - t = 3: The three sunny lines through the pairs in Lemma 3. Combining Propositions 5 and 6, the possible numbers of sunny lines among three lines covering S3 are exactly t ∈ {0, 1, 3}. Conclusion for general n. By Lemma 2, in any cover of Sn by n lines, at least n − 3 lines are non-sunny and the remaining three lines cover a translate of S3. By translation invariance, the number k of sunny lines among the original n lines equals the number t of sunny lines among three lines covering S3, hence k ∈ {0, 1, 3} and k ̸= 2. Finally, we construct configurations achieving k ∈ {0, 1, 3} for each n ≥ 3. - k = 0: Take the n lines x = 1, x = 2, . . . , x = n − 2, y = 1, x + y = n + 1. These are n distinct non-sunny lines. The verticals cover all points with a ≤ n − 2; the two sides cover the remaining columns a = n − 1 and a = n. - k = 1: Take the n − 3 verticals x = 1, . . . , x = n − 3 and the three lines x = n − 2, y = 1, y = x − (n − 3). The last is sunny (slope 1), the others are non-sunny. The verticals cover columns a ≤ n − 3. The three remaining lines cover the last three columns: (n − 2, b) for b = 1, 2, 3 lie on x = n−2; (n−1, 1) and (n, 1) lie on y = 1; (n−1, 2) lies on y = x−(n−3). - k = 3: Take the n − 3 verticals x = 1, . . . , x = n − 3 and the three sunny lines L1: through (n − 2, 1) and (n − 1, 2) (slope 1), L2: through (n − 1, 1) and (n − 2, 3) (slope −2), L3: through (n, 1) and (n−2, 2) (slope −1/2). These cover the last three columns: (n−2, b) for b = 1, 2, 3 lie on L1, L3, L2 respectively; (n − 1, 1) lies on L2 and (n − 1, 2) on L1; (n, 1) lies on L3. Therefore, for every n ≥ 3, the admissible values of k are exactly {0, 1, 3}.

### A.2 Problem 2

Problem 2. Let Ω and Γ be circles with centers M and N, respectively, such that the radius of Ω is less than the radius of Γ. Suppose circles Ω and Γ intersect at two distinct points A and B. Let MN intersect Ω at C and Γ at D, such that points C, M, N, and D lie on the line in that order. Let P be the circumcenter of triangle ACD. Line AP intersects Ω again at E ̸= A. Line AP intersects Γ again at F ̸= A. Let H be the orthocenter of triangle PMN. Prove that the line through H parallel to AP is tangent to the circumcircle of triangle BEF. (The orthocenter of a triangle is the point of intersection of its altitudes.) 25

#### A.2.1 Proof by Gemini 2.5 Pro

Let the line containing the centers M and N be the x-axis. The radical axis of circles Ω and Γ is the line AB, which is perpendicular to the line of centers. We place the origin O(0, 0) at the intersection of MN and AB. Let M = (m, 0) and N = (n, 0). The points A and B have coordinates (0, a) and (0, −a) for some a > 0. Since A lies on both circles: MA2 = (0 − m)2 + (a − 0)2 = r2 =⇒ m2 + a2 = r2 . NA2 = (0 − n)2 + (a − 0)2 = R2 =⇒ n2 + a2 = R2 . This gives the key relation a2 = r2 − m2 = R2 − n2 , which implies n2 − m2 = R2 − r2 . The problem states that C, M, N, D lie on the line in that order, so xC < xM < xN < xD. C is on Ω and the x-axis, so its x-coordinate is m − r. Thus C = (m − r, 0). D is on Γ and the x-axis, so its x-coordinate is n + R. Thus D = (n + R, 0). **1. Coordinates of P and H** P(xP , yP ) is the circumcenter of △ACD. It lies on the perpendicular bisector of CD, so its x-coordinate is xP = (m−r)+(n+R) 2 . The condition PA2 = PC2 gives x2 P +(yP −a)2 = (xP −(m−r))2 +y2 P , which simplifies to x2 P +y2 P −2ayP +a2 = x2 P −2xP (m−r)+(m−r)2 +y2 P . This yields 2ayP = 2xP (m−r)−(m−r)2 +a2 . Substituting the expression for xP : 2ayP = (m−r +n+R)(m−r)−(m−r)2 +a2 = (m−r)(n+R)+a2 . H(xH, yH) is the orthocenter of △PMN. The altitude from P to MN (the x-axis) is the vertical line x = xP , so xH = xP . The altitude from M in △PMN is perpendicular to the line PN. * **Lemma:** The line PN is perpendicular to the line AD. * **Proof:** P is the circumcenter of △ACD, so by definition, P is equidistant from its vertices. Thus PA = PD. This means P lies on the perpendicular bisector of segment AD. N is the center of circle Γ. Points A = (0, a) and D = (n + R, 0) are on Γ. The radius of Γ is R. We have NA2 = (0−n)2 +(a−0)2 = n2 +a2 = R2 , so NA = R. The distance ND is |(n+R)−n| = R. Thus NA = ND = R. This means N also lies on the perpendicular bisector of segment AD. Since both P and N lie on the perpendicular bisector of AD, the line PN is the perpendicular bisector of AD. Thus, PN ⊥ AD. Since the altitude from M in △PMN is perpendicular to PN, and we have shown PN ⊥ AD, this altitude must be parallel to AD. The slope of AD is kAD = a−0 0−(n+R) = −a n+R . The slope of the line MH is kMH = yH −0 xH −m = yH xP −m . Equating the slopes gives yH = kAD(xP − m) = −a(xP −m) n+R . **2. The Tangency Condition** Let ω be the circumcircle of △BEF with center Oω(xc, yc) and radius Rω. Let kAP be the slope of line AP. The line ℓ through H parallel to AP has equation y − yH = kAP (x − xP ). The condition for ℓ to be tangent to ω is that the square of the distance from Oω to ℓ equals R2 ω: (kAP (xc − xP ) − (yc − yH))2 1 + k2 AP = R2 ω Since B(0, −a) is on ω, R2 ω = (xc − 0)2 + (yc − (−a))2 = x2 c + (yc + a)2 . Let T1 = kAP (xc − xP ) − (yc − yH) and T2 = (1 + k2 AP )(x2 c + (yc + a)2 ). We need to prove T2 1 = T2. **3. Coordinates of E, F and Oω** The line AP passes through A(0, a) and has slope kAP . Its equation is y = kAP x + a. E is the second intersection of y = kAP x + a with 26

Ω : (x − m)2 + y2 = r2 . Substituting y gives (x − m)2 + (kAP x + a)2 = r2 , which simplifies to (1 + k2 AP )x2 + 2(akAP − m)x + (m2 + a2 − r2 ) = 0. Since m2 + a2 = r2 , this becomes x((1+k2 AP )x+2(akAP −m)) = 0. The solutions are x = 0 (for point A) and xE = −2(akAP −m) 1+k2 AP . Similarly, for F on Γ : (x − n)2 + y2 = R2 , we get xF = −2(akAP −n) 1+k2 AP . * **Lemma:** The coordinates of Oω(xc, yc) satisfy: a) xc + kAP yc = m + n − akAP b) yc = −(akAP −m)(akAP −n) a(1+k2 AP ) * **Proof:** a) Oω lies on the perpendicular bisector of EF. The midpoint of EF is (xE+xF 2 , yE+yF 2 ). The slope of EF (line AP) is kAP . The equation of the perpendicular bisector is y − yE+yF 2 = − 1 kAP (x − xE+xF 2 ). Since Oω(xc, yc) is on this line, we have xc + kAP yc = xE+xF 2 + kAP yE+yF 2 . Using yE = kAP xE + a and yF = kAP xF + a, the right side is 1+k2 AP 2 (xE + xF ) + akAP . Substituting the expressions for xE and xF : 1+k2 AP 2  −2(akAP −m)+2(akAP −n) 1+k2 AP  + akAP = −(2akAP − m − n) + akAP = m + n − akAP . So, xc + kAP yc = m + n − akAP . b) Oω is equidistant from B(0, −a) and E(xE, yE). So OωB2 = OωE2 . x2 c + (yc + a)2 = (xc − xE)2 + (yc − yE)2 . 2ayc + a2 = −2xcxE + x2 E − 2ycyE + y2 E. Using yE = kAP xE + a: 2ayc + a2 = −2xcxE + x2 E − 2yc(kAP xE + a) + (kAP xE + a)2 . 4ayc = −2xE(xc + kAP yc) + (1 + k2 AP )x2 E + 2akAP xE. Dividing by xE ̸= 0: 4ayc xE = −2(xc + kAP yc) + (1 + k2 AP )xE + 2akAP . Using part (a) and the expression for xE: 4ayc xE = −2(m+n−akAP )−2(akAP −m)+2akAP = −2m − 2n + 2akAP − 2akAP + 2m + 2akAP = 2(akAP − n). 2ayc = xE(akAP − n) =  −2(akAP −m) 1+k2 AP  (akAP − n). yc = −(akAP −m)(akAP −n) a(1+k2 AP ) . This completes the proof of the lemma. **4. Algebraic Verification** * **Lemma:** T1 = kAP (xc − xP ) − (yc − yH) = rR a . * **Proof:** T1 = (kAP xc − yc) − (kAP xP −yH). From part (a) of the previous lemma, xc = m+n−akAP −kAP yc. kAP xc −yc = kAP (m + n − akAP ) − (1 + k2 AP )yc. Substituting yc: kAP (m + n − akAP ) + (akAP −m)(akAP −n) a = akAP (m+n)−a2k2 AP +a2k2 AP −akAP (m+n)+mn a = mn a . The slope of AP is kAP = yP −a xP , so kAP xP = yP − a. Thus kAP xP − yH = yP − a − yH. T1 = mn a − (yP − a − yH) = mn−a(yP −a−yH ) a . 2aT1 = 2mn − 2ayP + 2a2 + 2ayH. Using 2ayP = (m − r)(n + R) + a2 and 2ayH = −2a2 xP −m n+R = −a2 n−m−r+R n+R : 2aT1 = 2mn − (mn + mR − rn − rR + a2 ) + 2a2 − a2 n−m−r+R n+R . 2aT1 = mn − mR + rn + rR + a2 − (R2 − n2 )n−m−r+R n+R since a2 = R2 − n2 . 2aT1 = mn−mR+rn+rR+(R−n)(R+n)−(R−n)(n−m−r+R). 2aT1 = mn−mR+rn+rR+ (R − n)[(R + n) − (n − m − r + R)]. The term in brackets is R + n − n + m + r − R = m + r. 2aT1 = mn−mR+rn+rR+(R−n)(m+r) = mn−mR+rn+rR+Rm+Rr−nm−nr = 2rR. Thus, T1 = rR a . * **Lemma:** T2 = (1 + k2 AP )(x2 c + (yc + a)2 ) = r2R2 a2 . * **Proof:** From the relations for xc, yc, we have xc = a(m+n)+kAP (mn−a2) a(1+k2 AP ) and yc + a = a2−mn+akAP (m+n) a(1+k2 AP ) . Let U = a(m + n) and V = mn − a2 . Then a(1 + k2 AP )xc = U + kAP V and a(1 + k2 AP )(yc + a) = −V + kAP U. a2 (1 + k2 AP )2 (x2 c + (yc + a)2 ) = (U + kAP V )2 + (−V + kAP U)2 = (U2 + V 2 )(1 + k2 AP ). So, T2 = (1 + k2 AP )(x2 c + (yc + a)2 ) = U2+V 2 a2 = (a(m+n))2+(mn−a2)2 a2 . We verify that the numerator is r2 R2 : r2 R2 = (m2 + a2 )(n2 + a2 ) = m2 n2 + a2 (m2 + n2 ) + a4 . (a(m + n))2 + (mn − a2 )2 = a2 (m2 + 2mn + n2 ) + (m2 n2 − 2mna2 + a4 ) = m2 n2 + a2 (m2 + n2 ) + a4 . The expressions are 27

identical. So, T2 = r2R2 a2 . **Conclusion** From our lemmas, T2 1 = (rR a )2 = r2R2 a2 and T2 = r2R2 a2 . Since T2 1 = T2, the tangency condition is satisfied. The line through H parallel to AP is tangent to the circumcircle of △BEF.

#### A.2.2 Proof by Grok-4

Place M at (0, 0) with radius r, so Ω: x2 + y2 = r2 . Place N at (d, 0) with radius R > r, so Γ: (x − d)2 + y2 = R2 , with |R − r| < d < R + r. The intersections are A = (m, h), B = (m, −h) where m = (d2 + r2 − R2 )/(2d), h = √ r2 − m2 > 0. The line MN is the x-axis. It intersects Ω at C = (−r, 0) and Γ at D = (d + R, 0), satisfying the order C, M, N, D. The circumcenter P = (p, yp) of △ACD satisfies (p + r)2 + y2 p = (p − d − R)2 + y2 p = (p−m)2 +(yp −h)2 . From the first equality, p = (d+R −r)/2. Substituting into the second equality yields (p − m)2 + (yp − h)2 = (p + r)2 + y2 p, which expands to −2yph = 2p(m + r), so yp = −p(m + r)/h. The line AP has slope s = −[p(m + r) + h2 ]/[h(p − m)]. Let N = p(m + r) + h2 , D = h(p − m), so s = −N/D. The second intersection E with Ω satisfies u = −2(m + sh)/(1 + s2 ). Thus E = (m + u, h + su). The second intersection F with Γ satisfies v = −2(m − d + sh)/(1 + s2 ). Thus F = (m + v, h + sv). The orthocenter H of △PMN is at (p, yh) where yh = −h(d − p)/(m + r). The line through H parallel to AP is sx − y − sp + yh = 0. **Lemma 1:** h(u + v) + suv = 0. Let g = 1 + s2 , q = m + sh. Then u = −2q/g, v = −2(q − d)/g. The condition expands to 2h(d−2m)(1−s2 )+4s(2m2 −md−r2 ) = 0, with a = 2h(d−2m), b = 4(2m2 − md − r2 ). Substituting s = −N/D yields E(p) = a(D2 − N2 ) − bND. Expanding coefficients: - p2 : 4h(m + r)r2 . - p: 4h(m + r)r2 (r − d). - Constant: −2dr2 h3 . These match λ times those of Q(p) = 2p2 + 2(r − d)p + d(m − r), with λ = 2h(m + r)r2 , since λd(m − r) = −2dr2 h3 . Now, Q(p) = 0: Substitute p = (d + R − r)/2 into Q(p) = 1 2 (d + R − r)2 + (r − d)(d + R − r) + d(m − r). Expanding yields 1 2 d2 + 1 2 R2 + 1 2 r2 +dR−dr −Rr −d2 −dR−r2 +Rr +2dr + 1 2 d2 + 1 2 r2 − 1 2 R2 − dr = 0, as all terms cancel (d2 terms: 1 2 − 1 + 1 2 = 0; R2 terms: 1 2 − 1 2 = 0; r2 terms: 1 2 − 1 + 1 2 = 0; d R terms: 1 − 1 = 0; R r terms: −1 + 1 = 0; d r terms: −1 + 2 − 1 = 0). Thus E(p) = λQ(p) = 0, proving the lemma. **Lemma 2:** The circumcenter of △BEF has x = d/2. The perpendicular bisectors of BE and BF intersect at x = [p1x1−y1−p2x2+y2]/(p1−p2), where x1 = m + u/2, y1 = su/2, x2 = m + v/2, y2 = sv/2, p1 = −u/(2h + su), p2 = −v/(2h + sv). 28

The condition x = d/2 reduces to I = (m−d/2)(p1−p2)+(u/2)p1−(v/2)p2+(s/2)(v−u) = 0. Substituting yields numer = (v − u)K, where K = h(sum − d + 2m) + (1/2)sprod + 2sh2 + s2 hsum + (s3 /2)prod and sum = u + v, prod = uv. Using prod = −hsum/s, K = h[(1/2)sum − d + 2m + 2sh + (1/2)s2 sum] = h[(1/2)(1 + s2 )sum + 2(m + sh) − d]. Substituting sum = −2(2(m + sh) − d)/(1 + s2 ) gives K = h · 0 = 0. Thus numer = 0, so I = 0, proving x = d/2. **Lemma 3:** cy = (d/2 − m)/s − h. The perpendicular bisector of EF is y − (h + sw) = (−1/s)(x − (m + w)), where w = (u + v)/2. At x = d/2, cy = h + sw − (1/s)(d/2 − m − w). This equals (d/2 − m)/s − h if gw + 2hs = d − 2m, where g = 1 + s2 . From sum = −2(2(m+sh)−d)/g, w = (d−2m−2sh)/g, so gw+2hs = d−2m−2sh+2hs = d − 2m, as required. **Lemma 4:** s(d − p − m) + yh + h = 0. Let L = s(d − p − m) + yh + h. Then I = (m + r)DL = −N(m + r)(d − p − m) − h2 (d − p)(p − m) + h2 (p − m)(m + r). Expanding yields p2 coeff: 2r(m + r); p coeff: 2r(m + r)(r − d); constant: −drh2 . These match r(m + r)Q(p), so I = r(m + r)Q(p) = 0, proving L = 0. The circumradius ρ satisfies ρ2 = (d/2−m)2 +(cy +h)2 = (d/2−m)2 +[(d/2−m)/s]2 = (d/2 − m)2 (1 + 1/s2 ), so ρ = |d/2 − m| √ 1 + s2/|s|. The distance from O = (d/2, cy) to sx−y −sp+yh = 0 is |s(d/2)−cy −sp+yh|/ √ 1 + s2. The numerator is −(d/2 − m)(1 + s2 )/s, so the distance is |d/2 − m| √ 1 + s2/|s| = ρ, proving tangency. the line through H parallel to AP is tangent to the circumcircle of △BEF

#### A.2.3 Proof by GPT-5

Set a Cartesian coordinate system with A = (0, 0) and the line MN horizontal, namely y = s with s ̸= 0. Write M = (m, s), N = (n, s), U := n − m ̸= 0. Let r1 := |AM| = √ m2 + s2, r2 := |AN| = √ n2 + s2, K := M · N = mn + s2 . The intersections of MN with Ω and Γ are C = (m − r1, s), D = (n + r2, s). Let P denote the circumcenter of △ACD, and put a := − → AP = P = (px, py), b := R90◦ (a) = (−py, px). 29

1) The points B, E, F and nondegeneracy. The second intersection of Ω and Γ is the reflection of A across MN, namely B = (0, 2s). For any circle centered at Q and any line through A in the direction a, the second intersection X satisfies X = 2(Q · a) |a|2 a. Applying this to Ω and Γ yields E = 2(M · a) |a|2 a, F = 2(N · a) |a|2 a. If ax = px = 0, then M · a = N · a = say, whence E = F = 2say |a|2 a = B; thus B, E, F are collinear (indeed coincident), so their circumcircle does not exist. Conversely, if ax ̸= 0, then M · a ̸= N · a (since (N − M) · a = Uax ̸= 0), so E ̸= F, and B / ∈ AP because ax ̸= 0; hence B, E, F are noncollinear and (BEF) exists. Therefore, the circumcircle (BEF) exists if and only if ax ̸= 0. Since the problem speaks of “the circumcircle of triangle BEF”, we henceforth work under the necessary and sufficient condition ax ̸= 0. 2) The circumcircle (BEF): its center and radius. Let O be the center and R the radius of the circumcircle of △BEF. In the orthogonal basis {a, b} (with |a| = |b|), write O = xa + yb, E = ea, F = fa, where e := 2(M · a) |a|2 and f := 2(N · a) |a|2 . Let νB := B · a |a|2 = 2say |a|2 , vB := B · b |a|2 = 2sax |a|2 . - Equal chords OE = OF give ((x − e)2 + y2 )|a|2 = ((x − f)2 + y2 )|a|2 , hence (x − e)2 = (x − f)2 . Using e ̸= f (since ax ̸= 0), we obtain x = e + f 2 = M · a + N · a |a|2 . - Equalities OE = OB give (x − e)2 + y2 = (x − uB)2 + (y − vB)2 . 30

Substituting x = (e + f)/2 and expanding in the {a, b}-basis yields 4sax y |a|2 = 4Ka2 x, i.e., b · O = y|a|2 = K s ax. - The radius is R2 = |O − E|2 = ((x − e)2 + y2 )|a|2 = (N − M) · a 2 |a|2 + y2 |a|2 . Multiplying by |a|2 and using b · O = y|a|2 gives (|a|R)2 = (N − M) · a 2 + (b · O)2 = (N − M) · a 2 + K s ax 2 . 3) The orthocenter H of △PMN. Since MN is horizontal, the altitude from P is the vertical line x = px. The altitude through M is perpendicular to PN, so there exists t ∈ R with H = M + t R90◦ (N − P) = (m, s) + t(s − py, −(n − px)). Define d := s − py, T := (n − px)(px − m). Imposing that H lies on x = px gives td = px − m. Hence yH − py = d − t(n − px), and therefore (yH − py)d = d2 − T. Moreover, b · H = b · P + b · (H − P) = 0 + px(yH − py) = ax(yH − py). Finally, from a later relation (see (4) below) we will obtain d ̸= 0. 4) Using that P is the circumcenter of △ACD. The conditions |PA| = |PC| and |PA| = |PD| are equivalent to the linear equations C · P = |C|2 2 , D · P = |D|2 2 . Now |C|2 = (m − r1)2 + s2 = 2r1(r1 − m), |D|2 = (n + r2)2 + s2 = 2r2(r2 + n). Thus (m − r1)px + spy = r1(r1 − m), (n + r2)px + spy = r2(r2 + n). 31

Subtracting these two equations yields px = m + n + r2 − r1 2 . From this, T = (n − px)(px − m) = − K − r1r2 2 . Also, from (m − r1)px + spy = r1(r1 − m), we obtain s(s − py) = (m − r1)(px − m), i.e., s d = (m − r1)(px − m). Since r1 > |m|, one has m − r1 ̸= 0. If d = 0, then px = m by the last display, so P = (m, s) = M, which is impossible because P is equidistant from A, C, D while M is not equidistant from A and D (as D / ∈ Ω). Hence d ̸= 0. 5) A key identity. We claim d2 − T − K s d = − r1r2 s d. Equivalently, d2 − T − K − r1r2 s d = 0. Multiplying by s2 and using sd = (m − r1)(px − m) and T = (n − px)(px − m), we have s2 (d2 − T) − (K − r1r2)sd = (px − m)  (m − r1)2 (px − m) − s2 (n − px) − (K − r1r2)(m − r1)  . Since s2 = r2 1 − m2 , the bracket equals (m − r1)  (m − r1)(px − m) + (r1 + m)(n − px) − (K − r1r2)  . Using 2px = m+n+r2 −r1 to evaluate the expression in parentheses, one checks it vanishes identically. Therefore the claimed identity holds. 6) Tangency criterion and conclusion. The line through H parallel to AP has direction a and normal b; its equation is b · X = b · H. Its distance to O is |b · H − b · O| |b| . Hence this line is tangent to (BEF) if and only if (b · H − b · O)2 = |b|2 R2 = (|a|R)2 . 32

By the formulas above, (b · H − b · O)2 = a2 x (yH − py) − K/s 2 = a2 x  d2 − T d − K s 2 = a2 x  d2 − T − (K/s)d d 2 . Using the key identity, (b · H − b · O)2 = a2 x  (r1r2/s)d d 2 = a2 x r1r2 s 2 . On the other hand, from the radius formula, (|a|R)2 = (N − M) · a 2 + K s ax 2 = a2 x U2 +  K s 2 ! , since (N − M) = (U, 0) and (N − M) · a = Uax. Thus tangency is equivalent to r1r2 s 2 = U2 +  K s 2 , i.e., r2 1r2 2 = K2 + s2 U2 . Finally, note that |M|2 = r2 1, |N|2 = r2 2, M · N = K, det(M, N) = ms − ns = −sU. Therefore the last equality is the identity |M|2 |N|2 = (M · N)2 + det(M, N)2 , which always holds. Hence the line through H parallel to AP is tangent to the circumcircle of △BEF, as desired.

### A.3 Problem 3

Problem 3. Let N denote the set of positive integers. A function f : N → N is said to be bonza if f(a) | ba − f(b)f(a) for all positive integers a and b. Determine the smallest real constant c such that f(n) ≤ cn for all bonza functions f and all positive integers n. 33

#### A.3.1 Solution by Gemini 2.5 Pro

Let P(a, b) be the assertion f(a) | ba − f(b)f(a) . **Step 1: Prove that f(1) = 1** Let C = f(1). Assume for contradiction that C > 1. Let p be a prime divisor of C. The assertion P(p, 1) states f(p) | 1p − f(1)f(p) , which is f(p) | 1 − Cf(p) . Since p | C, we have C ≡ 0 (mod p), so 1 − Cf(p) ≡ 1 (mod p). If p were a divisor of f(p), then p would have to divide 1 − Cf(p) , which is impossible as 1 − Cf(p) ≡ 1 (mod p). Thus, p ∤ f(p). Now consider the assertion P(1, p), which states f(1) | p − f(p)f(1) , i.e., C | p − f(p)C . Since p | C, this implies p | p − f(p)C , which in turn implies p | f(p)C . As p is prime, this means p | f(p). We have derived a contradiction: p ∤ f(p) and p | f(p). Therefore, the assumption C > 1 must be false. Since f(1) ∈ N, we must have f(1) = 1. **Step 2: Properties of bonza functions** Let Sf = {p prime | ∃n ∈ N, p | f(n)}. **Property 1:** For any p ∈ Sf and b ∈ N, if p | f(b), then p | b. *Proof:* Let p ∈ Sf . By definition, there exists an a0 ∈ N such that p | f(a0). The bonza condition P(a0, b) is f(a0) | ba0 − f(b)f(a0) . As p | f(a0), we have p | ba0 − f(b)f(a0) . If we assume p | f(b), this implies p | ba0 , and since p is prime, p | b. **Lemma A:** For any prime p ∈ Sf , we have f(b) ≡ b (mod p) for all b ∈ N. *Proof:* Let p ∈ Sf . First, we show f(p) is a power of p. If f(p) = 1, then for any a with p | f(a), P(a, p) =⇒ f(a) | pa − f(p)f(a) = pa − 1, which contradicts p | f(a). So f(p) > 1. Let q be a prime divisor of f(p). Then q ∈ Sf . By Property 1, since q | f(p), we must have q | p. As p, q are primes, q = p. Thus f(p) = pk for some k ≥ 1. Now, P(p, b) =⇒ f(p) | bp −f(b)f(p) , so pk | bp − f(b)pk . This implies bp ≡ f(b)pk (mod p). By Fermat’s Little Theorem, bp ≡ b (mod p) and f(b)pk ≡ f(b) (mod p). Thus, b ≡ f(b) (mod p). **Lemma B:** For any prime q / ∈ Sf , we have f(q) = 1. *Proof:* Let q be a prime with q / ∈ Sf . Suppose f(q) > 1. Let p be a prime divisor of f(q). Then p ∈ Sf . By Property 1, since p | f(q), we must have p | q. As p, q are primes, p = q. This contradicts the fact that p ∈ Sf and q / ∈ Sf . Thus, f(q) = 1. **Step 3: Classification of bonza functions** For any p ∈ Sf and any prime q / ∈ Sf , by Lemma A, f(q) ≡ q (mod p). By Lemma B, f(q) = 1. Thus, we have the crucial condition: ∀p ∈ Sf , ∀q / ∈ Sf (prime), q ≡ 1 (mod p) (∗) We analyze the possible structures for the set of primes Sf . 1. Sf = ∅: Condition (*) is vacuously true. This is a possible case. 2. Sf is the set of all primes: Condition (*) is vacuously true as there are no primes q / ∈ Sf . This is a possible case. 3. Sf is a non-empty proper subset of the set of all primes. a) Suppose Sf is an infinite proper subset. Let q be a prime such that q / ∈ Sf . By (*), q ≡ 1 (mod p) for all p ∈ Sf . This means every prime p ∈ Sf is a divisor of q − 1. Since Sf is infinite, this implies the integer q − 1 has infinitely many distinct prime divisors, which is impossible. Thus, Sf cannot be an infinite proper subset. b) Suppose Sf is a finite, non-empty proper subset. Let Sf = {p1, . . . , pr}. Let P = p1p2 . . . pr. Condition (*) implies that any prime q / ∈ Sf must satisfy q ≡ 1 (mod P). If P > 2, then Euler’s totient function ϕ(P) > 1. This means there exists an integer a with 1 < a < P and gcd(a, P) = 1. By Dirichlet’s theorem on arithmetic progressions, there are 34

infinitely many primes q of the form kP + a. We can choose such a prime q that is not in the finite set Sf . For this prime q, we have q / ∈ Sf , so by our condition, it must satisfy q ≡ 1 (mod P). But we chose q such that q ≡ a (mod P). This leads to a ≡ 1 (mod P), which contradicts our choice of a. Therefore, the assumption P > 2 must be false. We must have P ≤ 2. Since Sf is non-empty, P ≥ 2. Thus, P = 2, which implies Sf = {2}. Thus, the only possibilities for Sf are ∅, {2}, or the set of all primes. **Step 4: Analysis of f(n)/n for each case** * **Case 1: Sf = ∅.** This implies that for all n, f(n) has no prime factors, so f(n) = 1. The function f(n) = 1 for all n is bonza, since 1 | ba − 11 is always true. For this function, f(n)/n = 1/n ≤ 1. * **Case 2: Sf is the set of all primes.** For any prime p, Lemma A gives f(n) ≡ n (mod p). This means p | (f(n)−n) for all primes p. If f(n) ̸= n, then f(n) − n is a non-zero integer. A non-zero integer can only have a finite number of prime divisors. This forces f(n) − n = 0, so f(n) = n. The function f(n) = n is bonza, since a | ba − ba is true. For this function, f(n)/n = 1. * **Case 3: Sf = {2}.** The range of f is a subset of {1} ∪ {2k | k ∈ N}. By Lemma A, f(n) ≡ n (mod 2). This implies f(n) = 1 for odd n, and f(n) = 2kn for some kn ≥ 1 for even n. Let n be an even integer. Let v2(m) be the exponent of 2 in the prime factorization of m. 1. For any odd b, P(n, b) =⇒ f(n) | bn − f(b)f(n) . Since b is odd, f(b) = 1. So 2kn | bn − 1. This must hold for all odd b. Thus, kn ≤ minb odd v2(bn − 1). Let n = 2s t with t odd, s ≥ 1. For any odd b, let x = bt , which is also odd. We have v2(bn − 1) = v2(x2s − 1). It is a known property that for an odd integer x and k ≥ 1, v2(x2k −1) = v2(x2 −1)+k −1. Applying this with k = s, we get v2(bn − 1) = v2((bt )2 − 1) + s − 1. To find the minimum value, we must minimize v2((bt )2 − 1) over odd b. The map ϕt : (Z/8Z)× → (Z/8Z)× given by ϕt(y) = yt is a permutation for any odd t. This is because for any y ∈ (Z/8Z)× , y2 ≡ 1 (mod 8), so for t = 2k + 1, yt = y2k+1 = (y2 )k y ≡ y (mod 8). Thus, as b runs through odd integers, bt (mod 8) also takes on all values in {1, 3, 5, 7}. We can choose b such that bt ≡ 3 (mod 8). For such b, v2((bt )2 − 1) = v2(32 − 1) = v2(8) = 3. The minimum value of v2((bt )2 − 1) for bt ̸≡ 1 (mod 8) is 3. So, minb odd v2(bn − 1) = 3 + s − 1 = s + 2 = v2(n) + 2. Thus, kn ≤ v2(n) + 2. 2. For b = 2, P(n, 2) =⇒ f(n) | 2n − f(2)f(n) . Let f(2) = 2k2 for some integer k2 ≥ 1. The condition is 2kn | 2n − 2k22kn . This requires kn ≤ v2(2n − 2k22kn ). If n ̸= k22kn , then v2(2n − 2k22kn ) = min(n, k22kn ). The condition becomes kn ≤ min(n, k22kn ), which implies kn ≤ n. If n = k22kn , the divisibility is on 0, which holds for any kn. However, n = k22kn with k2 ≥ 1 implies n ≥ 2kn . Since 2x > x for all x ≥ 1, we have n > kn. In all cases, we must have kn ≤ n. Combining these constraints, for any bonza function in this class, f(n) ≤ 2min(n,v2(n)+2) for even n. **Step 5: Construction of the maximal function and determination of c** Let’s define a function f0 based on the derived upper bound: f0(n) = ( 1 if n is odd 2min(n,v2(n)+2) if n is even Let km = min(m, v2(m) + 2) for any even m. We verify that f0 is a bonza function. - If a is odd, f0(a) = 1. The condition is 1 | ba − f0(b)1 , which is always true. - If a is even and b is odd: f0(a) = 2ka , f0(b) = 1. We need 2ka | ba −1. By definition, ka ≤ v2(a)+2. As established 35

in Step 4, for any even a and odd b, v2(ba −1) ≥ v2(a)+2. Thus, ka ≤ v2(a)+2 ≤ v2(ba −1), so the condition holds. - If a, b are even: f0(a) = 2ka , f0(b) = 2kb . We need 2ka | ba −(2kb )2ka . Let E = ba − 2kb2ka . We need to show v2(E) ≥ ka. Let v2(ba ) = av2(b) and the exponent of 2 in the second term is kb2ka . If v2(ba ) ̸= kb2ka , then v2(E) = min(v2(ba ), kb2ka ). We have ka ≤ a ≤ av2(b) = v2(ba ) since v2(b) ≥ 1. Also kb ≥ 1, so kb2ka ≥ 2ka ≥ ka for ka ≥ 1. Thus ka ≤ v2(E). If v2(ba ) = kb2ka , let vb = v2(b) and m = b/2vb . The condition is avb = kb2ka . E = ba − 2kb2ka = (m2vb )a − 2avb = ma 2avb − 2avb = 2avb (ma − 1). If m = 1, b is a power of 2, then E = 0 and 2ka | 0 holds. If m > 1, v2(E) = avb + v2(ma − 1). Since ka ≤ a ≤ avb, and v2(ma − 1) ≥ 1 (as a is even, m is odd), we have ka ≤ v2(E). Thus, f0 is a bonza function. Now we find supn f0(n)/n. For odd n, f0(n)/n = 1/n ≤ 1. For even n = 2s t with t odd, s ≥ 1: f0(n) n = 2min(2st,s+2) 2st . - If t ≥ 3, then 2s t > s + 2 for s ≥ 1. (Proof: g(s) = 3 · 2s − s − 2 is increasing for s ≥ 1 and g(1) = 3 > 0. So 3 · 2s > s + 2. Then t · 2s ≥ 3 · 2s > s + 2.) So f0(n) n = 2s+2 2st = 4 t ≤ 4 3 . - If t = 1, n = 2s . f0(2s) 2s = 2min(2s,s+2) 2s . The inequality 2s ≥ s + 2 holds for all integers s ≥ 2. (Proof by induction: for s = 2, 4 ≥ 4. Assume 2k ≥ k + 2 for k ≥ 2, then 2k+1 = 2 · 2k ≥ 2(k + 2) = 2k + 4 = (k + 3) + (k + 1) > k + 3.) For s = 1, n = 2: f0(2) 2 = 2min(2,3) 2 = 22 2 = 2. For s ≥ 2, since 2s ≥ s + 2, we have min(2s , s + 2) = s + 2. So f0(2s) 2s = 2s+2 2s = 4. This value of 4 is achieved for n = 4, 8, 16, . . . . For example, f0(4) = 2min(4,v2(4)+2) = 2min(4,4) = 24 = 16, so f0(4)/4 = 4. The supremum of f(n)/n over all bonza functions is 4. For any constant c < 4, the function f0 and n = 4 gives f0(4) = 16 > 4c, so f0(4) > cn. Thus, the smallest constant is c = 4.

#### A.3.2 Solution by Grok-4

First, prove that f(1) = 1. Suppose f(1) = k > 1. Setting a = 1, b = 1 gives k | 11 − kk , so k | 1 − kk . But kk ≡ 0 (mod k), so k | 1, contradicting k > 1. Thus f(1) = 1. Next, prove f(a) | aa for all a. Setting b = a gives f(a) | aa − f(a)f(a) . Clearly f(a) | f(a)f(a) since f(a)f(a) = f(a) · f(a)f(a)−1 and f(a) ≥ 1. Therefore f(a) | aa . It follows that the primes dividing f(a) divide a, and vp(f(a)) ≤ a · vp(a) for each prime p. Now, prove the tight valuation bounds, starting with odd primes. **Lemma 1:** For any odd prime p and bonza f, vp(f(n)) ≤ vp(n). Let k = vp(n), assume for contradiction that g = vp(f(n)) = k + 1 ≥ 1. Then pg | bn − f(b)f(n) for all b, so bn ≡ f(b)f(n) (mod pg ). For b coprime to p, if p | f(b), then right side ≡ 0 (mod p), left side not (since b invertible, bn invertible), contradiction. Thus vp(f(b)) = 0, and both sides are units mod pg . Case 1: ϕ(pg ) ∤ n. Then there exists r ∈ (Z/pg Z)∗ with rn ̸≡ 1 (mod pg ) (since the group is cyclic of order ϕ(pg ), and if all elements satisfied xn = 1, then the exponent would divide n, so ϕ(pg ) | n, contradiction). Choose odd prime q ̸= p such that q ≡ r (mod pg ) (exists by Dirichlet), f(n) ̸≡ n (mod q), and gcd(q, f(n)) = 1 (possible since infinitely many such q, and finitely many dividing f(n) − n or f(n)). Thus qn ̸≡ 1 (mod pg ), satisfying (i); (ii) and (iii) by choice. Now, f(q) | qq , so f(q) = qj for 0 ≤ j ≤ q. Consider the condition for a = q, b = n: 36

qj | nq − f(n)qj . If j = 0, f(q) = 1 | nq − f(n)1 , always true, but check the condition for a = n, b = q: pg | qn − f(q)f(n) = qn − 1f(n) = qn − 1. By choice (i), pg ∤ qn − 1, contradiction. If j ≥ 1, note nq ≡ n (mod q) by Fermat. Also, f(n)qj ≡ f(n)qj mod (q−1) (mod q) since gcd(f(n), q) = 1. But qj ≡ 0 (mod q), and for the exponent modulo q−1, q ≡ 1 (mod q−1), so qj ≡ 1j = 1 (mod q − 1). Thus f(n)qj ≡ f(n)1 ≡ f(n) (mod q). By choice (ii), f(n) ̸≡ n (mod q), so nq ̸≡ f(n)qj (mod q), hence vq(nq − f(n)qj ) = 0 < j, so qj ∤ nq − f(n)qj , contradiction. Thus no possible f(q), contradicting the existence of f. Case 2: ϕ(pg ) | n (bad case). Choose odd prime q ̸= p such that f(n) ̸≡ n (mod q), gcd(q, f(n)) = 1 (exists as before). Additionally, since f(p) = pj with j ≥ 1 (if j = 0, then for a = n, b = p: pg | pn − 1f(n) = pn − 1, vp(pn − 1) = 0 < g, contradiction; hence j ≥ 1 for any bonza f), the group (Z/pj Z)∗ has exponent ϕ(pj ) = pj−1 (p − 1) not dividing p (since p − 1 ∤ p). Thus there exists r ∈ (Z/pj Z)∗ with rp ̸≡ 1 (mod pj ). Choose q ≡ r (mod pj ) (compatible with previous conditions via CRT on finite moduli). For this q, j ≥ 1 fail as in Case 1 (argument identical, independent of (i)). For j = 0, the pair (p, q) fails: f(p) | qp − 1f(p) = qp − 1, but by choice qp ̸≡ 1 (mod pj ) = (mod f(p)), so f(p) ∤ qp − 1, contradiction. Thus no possible f(q), contradicting the existence of f. Hence vp(f(n)) ≤ vp(n). **Lemma 2:** For any bonza f, v2(f(n)) ≤ v2(n) + 2. Let v = v2(n), assume for contradiction e = v2(f(n)) ≥ v + 3. First, if v = 0 (i.e., n odd), then f(n) | nn and nn odd imply f(n) odd, so e = 0. But 0 ≥ 3 is false, contradiction. Thus v ≥ 1 necessarily under the assumption. Set b = 3, then 2e | 3n − f(3)f(n) . Since f(3) | 33 = 27, f(3) = 3j for 0 ≤ j ≤ 3. If j = 0, f(3) = 1, v2(3n − 1). Since v ≥ 1, n even, lifting the exponent (LTE) for p = 2 gives v2(xn − yn ) = v2(x − y) + v2(x + y) + v2(n) − 1 when x, y odd, n even. Thus v2(3n − 1) = v2(3 − 1) + v2(3 + 1) + v − 1 = 1 + 2 + v − 1 = v + 2 < e. If j ≥ 1, compute v2(3n − 3jf(n) ). First, jf(n) ̸= n: if jf(n) = n, then f(n) = n/j, j | n (since f(n) integer), e = v2(n/j) = v − v2(j) ≤ v ≤ v + 2 < v + 3 ≤ e, contradiction. Thus n ̸= jf(n). Let m = |jf(n) − n| > 0. Since e ≥ v + 3 > v, v2(jf(n)) = v2(j) + e ≥ e > v = v2(n), so v2(m) = v. Without loss of generality assume jf(n) > n (the other case symmetric), then v2(3n − 3jf(n) ) = v2(3n (1 − 3m )) = v2(3n ) + v2(1 − 3m ) = 0 + v2(3m − 1) (negative sign irrelevant for v2). Apply LTE to 3m − 1m : m even (since jf(n) even, n even for v ≥ 1), so v2(3m − 1) = 1 + 2 + v2(m) − 1 = v + 2 < e. Hence v2(f(n)) ≤ v + 2. Now, combining: write n = 2v Q p odd pvp(n) . Then f(n) = 2e Q p odd pfp with e ≤ v + 2, fp ≤ vp(n) for odd p. The maximum occurs when e = v + 2 and fp = vp(n) for all odd p, giving f(n) ≤ 2v+2 · (n/2v ) = 4n. For the lower bound, define f by: f(1) = 1; for n > 1 odd, f(n) = 1; for n = 2d with d ≥ 2, f(n) = 2d+2 ; for n = 2, f(n) = 4; for n even not a power of 2, f(n) = 2. First, verify f(n) | nn for all n: - If n = 1, 1 | 11 . - If n > 1 odd, 1 | nn . - If n = 2d , d ≥ 2, 2d+2 | (2d )2d = 2d·2d , since d·2d ≥ 2·4 = 8 > 4 = d+2 for d = 2, and larger for d > 2. 37

- If n = 2, 4 | 22 = 4. - If n even not power of 2, 2 | nn since n even. Now, verify bonza: f(a) | ba − f(b)f(a) for all a, b. Since f(a) is always a power of 2 (or 1), it suffices to check v2(ba − f(b)f(a) ) ≥ v2(f(a)) when f(a) > 1, or trivial when = 1. **Case 1: a = 1.** f(a) = 1, trivial. **Case 2: a > 1 odd.** f(a) = 1, trivial. **Case 3: a even not a power of 2.** f(a) = 2, so need v2(ba − f(b)2 ) ≥ 1 (i.e., even). - If b even, ba even, f(b) ≥ 2 even so f(b)2 even, even-even=even. - If b = 1, 1a −12 = 0, even. - If b > 1 odd, ba odd (odd to even power=odd), f(b) = 1, 12 = 1 odd, odd-odd=even. **Case 4: a = 2d , d ≥ 1.** f(a) = 2d+2 if d ≥ 2, f(a) = 4 = 22 if d = 1. Need v2(b2d − f(b)f(a) ) ≥ v2(f(a)). **Subcase 4.1: b = 1.** 12d − f(1)f(a) = 1 − 1 = 0, v2 = ∞ ≥ anything. **Subcase 4.2: b > 1 odd.** f(b) = 1, so v2(b2d − 1). By LTE (x = b odd, y = 1 odd, n = 2d even): v2(b2d − 1) = v2(b − 1) + v2(b + 1) + d − 1. - Cannot have v2(b − 1) = v2(b + 1) = 1 (would require b ≡ 1 (mod 4) and b ≡ −1 (mod 4), impossible). - Minimal when min(v2(b − 1), v2(b + 1)) = 1, other = 2: 1 + 2 + d − 1 = d + 2. - For d ≥ 2, d + 2 ≥ v2(f(a)) = d + 2. - For d = 1, actual minimal is 3 (e.g., b = 3: v2(9 − 1) = v2(8) = 3; b = 5: v2(25 − 1) = v2(24) = 3), ≥ 2 = v2(f(a)). **Subcase 4.3: b = 2k , k ≥ 1.** Let e1 = k·2d = v2(b2d ). If k = 1, f(b) = 4 = 22 ; if k ≥ 2, f(b) = 2k+2 . Let e2 = v2(f(b)f(a) ). - If k = 1, e2 = 2 · f(a). - If k ≥ 2, e2 = (k + 2) · f(a). Now compare e1 and e2. - For d ≥ 2, f(a) = 2d+2 . If k = 1, e1 = 2d , e2 = 2·2d+2 = 2d+3 > 2d (since d ≥ 2). If k ≥ 2, e2 = (k +2)2d+2 ≥ 4·2d+2 = 2d+4 > k2d = e1((k +2)/k ·4 > 4 > 1). - For d = 1, f(a) = 4. If k = 1, e1 = 2, e2 = 2·4 = 8 > 2. If k ≥ 2, e2 = (k+2)4 > k·2 = e1/2? Wait, earlier: 2(k+2)/k > 2 > 1, yes. Thus always e2 > e1, so v2 = e1 +v2(1−2e2−e1 ). Since e2 − e1 > 0, 2... even, 1-even=odd, v2 = 0, total v2 = e1 = k2d ≥ 2d . For d ≥ 2, 2d ≥ d + 2 (e.g., d = 2: 4 = 4; d = 3: 8 > 5). For d = 1, k · 2 ≥ 2 ≥ 2. **Subcase 4.4: b even not power of 2.** f(b) = 2, f(a) = 2d+2 (d ≥ 2) or 4 (d = 1), so v2(b2d − 2f(a) ). Let v2(b) = s ≥ 1, b = 2s m, m > 1 odd. Then v2(b2d ) = s2d , v2(2f(a) ) = f(a) = 2d+2 or 4 = 22 . - If s2d < f(a), v2 = s2d + v2(m2d − 2f(a)−s2d ). Since f(a) − s2d > 0, 2... even, m2d odd, odd-even=odd, v2 = 0, total s2d . For d ≥ 2, s ≥ 1, 2d ≥ d + 2; for maximal s < 4, 3 · 2d ≥ 12 > 4 for d = 2, larger later. For d = 1, 2s ≥ 2. - If s2d = f(a), v2 = f(a)+v2(m2d −1) ≥ f(a)+d+2 > f(a). - If s2d > f(a), v2 = f(a)+v2(2s2d−f(a) m2d −1). Since s2d − f(a) > 0, even · odd = even, even-1=odd, v2 = 0, total f(a) ≥ v2(f(a)). Thus f is bonza, achieving f(2d )/2d = 4 for d ≥ 2. Hence the smallest c = 4. 4

#### A.3.3 Solution by GPT-5

Let f : N → N be bonza, i.e., for all positive integers a, b, f(a) | ba − f(b)f(a)  . (1) Lemma 1. We have f(1) = 1. Proof. Set (a, b) = (1, 1) in (1). Then f(1)|1 − f(1)f(1) . Reducing modulo f(1) gives 0 ≡ 1 (mod f(1)), hence f(1) = 1. 38

Lemma 2. For every n, each prime divisor of f(n) divides n. Proof. Put a = b = n in (1). Then f(n)|(nn − f(n)f(n) ). If p|f(n) is prime, then reducing modulo p yields nn ≡ 0 (mod p), hence p|n. Lemma 3. If p is prime and p|f(a), then p|f(b) for every b with p|b. Proof. From (1) and p|f(a), reduce modulo p: for all b, ba ≡ f(b)f(a) (mod p). If p|b, then ba ≡ 0 (mod p), so f(b)f(a) ≡ 0 (mod p), whence p|f(b). Lemma 4 (rigidity modulo an odd prime value). Let p be an odd prime with f(p) > 1. Then for all b, f(b) ≡ b (mod p). (2) Proof. By Lemma 2, f(p) = pe with e ≥ 1. Taking a = p in (1) and reducing modulo p, we get for all b, bp ≡ f(b)pe (mod p). (3) If p ∤ b, then b ∈ F× p . Since pe ≡ 1 (mod p − 1), we have ype ≡ y in F× p for all y, and by Fermat bp ≡ b (mod p). Hence f(b) ≡ b (mod p). If p|b, then both sides of (3) are 0 modulo p, so f(b) ≡ b ≡ 0 (mod p). Thus (2) holds for all b. Define the set of ”odd prime values”: P := { p odd prime : f(p) > 1 }. Proposition 1. If P ̸= ∅, then f(n) = n for all n ∈ N. Proof. Step 1: P is infinite. Pick p0 ∈ P. We construct inductively a sequence of distinct odd primes in P. Start with S0 = ∅. Given a finite set Sk of odd primes already obtained in P (possibly empty), set Mk := Y r∈Sk r (with Mk = 1 if Sk = ∅), bk := 2 + p0Mk. Then bk is odd and bk ≡ 2 (mod p0). By Lemma 4 (applied to p0), f(bk) ≡ bk ≡ 2 (mod p0), hence f(bk) ̸= 1. Let rk be an odd prime dividing f(bk). By Lemma 2, rk|bk. For any r ∈ Sk, bk ≡ 2 (mod r), so r ∤ bk, hence rk / ∈ Sk. By Lemma 3 with a = bk and b = rk we get rk|f(rk), so f(rk) > 1 and rk ∈ P. Define Sk+1 := Sk ∪ {rk}. Thus we can construct infinitely many distinct rk ∈ P, proving P is infinite. Step 2: f is the identity. Fix n ∈ N. For each p ∈ P we have f(n) ≡ n (mod p) by Lemma 4 (applied to p, which satisfies p|f(p) by Lemma 3 since p ∈ P). Since P is infinite, we can choose infinitely many p ∈ P with p ∤ n (there are only finitely many primes dividing n). For all these primes p we have p|(f(n) − n). Hence f(n) − n is divisible by infinitely many distinct primes. Therefore f(n) − n = 0, i.e., f(n) = n. As n was arbitrary, f is the identity. Corollary 1. Either f(n) = n for all n, or else f takes no odd prime value (equivalently, P = ∅). We now analyze the complementary case. 39

Proposition 2 (the 2-adic branch). Suppose P = ∅. Then: (i) f(n) = 1 for all odd n; (ii) every f(n) is a power of 2; (iii) for even a with s = v2(a), we have v2(f(a)) ≤ s + 2; Consequently, for all n we have f(n) ≤ 2v2(n)+2 ≤ 4n. Proof. (ii) If an odd prime q divided some f(n), then by Lemma 3 applied with that q and b = q we would get q|f(q), i.e., q ∈ P, contradicting P = ∅. Thus all f(n) are powers of 2. (i) If n is odd and f(n) were even, then the prime 2 would divide n by Lemma 2, a contradiction. Thus f(n) = 1 for odd n. (iii) Let a be even and s = v2(a). For every odd b we have f(b) = 1 by (i), so (1) yields f(a) | (ba − 1) for all odd b. Taking 2-adic valuations and using the LTE formula for 2 (valid for odd b and even a), v2(ba − 1) = v2(b − 1) + v2(b + 1) + v2(a) − 1. Among odd b, one of b − 1 and b + 1 is exactly divisible by 2 and the other by 4, so the sum v2(b − 1) + v2(b + 1) is at least 3, and this minimum 3 is attained (e.g. b ≡ 3 or 5 (mod 8)). Hence min b odd v2(ba − 1) = s + 2, so v2(f(a)) ≤ s + 2. Consequently, f(n) ≤ 2v2(n)+2 = 4 · 2v2(n) ≤ 4n. Combining Proposition 1 and Proposition 2, we conclude that for every bonza f and every n, f(n) ≤ 4n. (4) We now prove sharpness. Construction. Define F : N → N by F(n) =      1, n odd, 4, n = 2, 2v2(n)+2 , n ≥ 4 even. We claim F is bonza and attains F(2s ) = 2s+2 = 4 · 2s for all s ≥ 2. Verification that F is bonza. Fix a, b ∈ N. We must show F(a) | ba − F(b)F(a)  . (5) If a is odd then F(a) = 1 and (5) is trivial. Assume a is even and write s := v2(a). Set k := v2(F(a)); explicitly, k = 2 if a = 2, and k = s + 2 if a ≥ 4. 40

Case 1: b odd. Then F(b) = 1, so we need 2k | (ba − 1). By the LTE formula quoted above, v2(ba − 1) = v2(b − 1) + v2(b + 1) + s − 1 ≥ s + 2. Hence v2(ba − 1) ≥ k in both subcases (k = 2 when a = 2; k = s + 2 when a ≥ 4), proving (5). Case 2: b even. Write t := v2(b) ≥ 1 and write b = 2t u with u odd. Then v2(ba ) = at. Also, v2(F(b)) = ( 2, b = 2 (t = 1), t + 2, b ≥ 4 (t ≥ 2), hence v2 F(b)F(a)  = v2(F(b)) · 2k ≥ 2 · 2k ≥ k + 1 (since k ≥ 2). Therefore v2 ba − F(b)F(a)  ≥ min at, v2(F(b)F(a) )  . (6) We claim at ≥ k. Indeed: - If a = 2, then k = 2 and at = 2t ≥ 2. - If a ≥ 4, then with s = v2(a) we have a ≥ 2s . If s = 1 then a ≥ 4 > 3 = s + 2; if s ≥ 2 then 2s ≥ s + 2, hence a ≥ s + 2. Thus in all cases a ≥ s + 2 = k, and so at ≥ a ≥ k. Combining with v2(F(b)F(a) ) ≥ k + 1, (6) gives v2(ba − F(b)F(a) ) ≥ k, i.e., 2k |(ba − F(b)F(a) ). This proves (5). Thus F is bonza. Finally, for n = 2s with s ≥ 2 we have F(n) = 2s+2 = 4 · 2s , so equality is attained in the bound f(n) ≤ 4n infinitely often. Hence the optimal constant is c = 4. Conclusion. For every bonza function f, one has f(n) ≤ 4n for all n, and the constant 4 is best possible.

### A.4 Problem 4

Problem 4. A proper divisor of a positive integer N is a positive divisor of N other than N itself. The infinite sequence a1, a2, . . . consists of positive integers, each of which has at least three proper divisors. For each n ≥ 1, the integer an+1 is the sum of the three largest proper divisors of an. Determine all possible values of a1.

#### A.4.1 Solution by Gemini 2.5 Pro

Let f(N) be the sum of the three largest proper divisors of a positive integer N. The sequence is defined by an+1 = f(an) for n ≥ 1. The problem requires that each an has at least three proper divisors. A proper divisor of N is any positive divisor of N except N itself. The condition that N has at least three proper divisors means that the number of divisors of N, denoted by d(N), must satisfy d(N) − 1 ≥ 3, so d(N) ≥ 4. 41

Let the divisors of N in increasing order be 1 = d1 < d2 < d3 < · · · < dk = N, where k = d(N) ≥ 4. The proper divisors of N are {d1, d2, . . . , dk−1}. The three largest proper divisors are dk−1, dk−2, dk−3. The map d 7→ N/d is a bijection on the set of divisors of N that reverses the order. Therefore, the largest proper divisor is dk−1 = N/d2, the second largest is dk−2 = N/d3, and the third largest is dk−3 = N/d4. This holds for any N with d(N) ≥ 4. Thus, the sum of the three largest proper divisors is given by: f(N) = dk−1 + dk−2 + dk−3 = N d2 + N d3 + N d4 = N  1 d2 + 1 d3 + 1 d4  . **Lemma 1:** For any valid sequence, an must be even for all n ≥ 1. * **Proof:** Suppose ak is an odd integer for some k ≥ 1. All its divisors are odd, so its three largest proper divisors are odd. Their sum, ak+1 = f(ak), is also odd. Therefore, if any term is odd, all subsequent terms are odd. Let N be an odd integer with d(N) ≥ 4. Its smallest divisors greater than 1 are d2, d3, d4. Since N is odd, all its divisors are odd. The smallest possible value for d2 is 3. Thus, d2 ≥ 3. Since d3 > d2, d3 ≥ 5. Similarly, d4 > d3, so d4 ≥ 7. The sum 1 d2 + 1 d3 + 1 d4 is maximized when d2, d3, d4 are minimized. Thus, 1 d2 + 1 d3 + 1 d4 ≤ 1 3 + 1 5 + 1 7 = 71 105 . Therefore, f(N) ≤ 71 105 N < N. So, if ak is odd, the sequence (an)n≥k is a strictly decreasing sequence of positive integers. Such a sequence must terminate, meaning it must produce a term which does not satisfy d(an) ≥ 4. Therefore, an infinite sequence is not possible if any term is odd. **Lemma 2:** For any valid sequence, an must be divisible by 3 for all n ≥ 1. * **Proof:** Suppose there is a term ak not divisible by 3. By Lemma 1, ak is even. Let am be any term with v3(am) = 0. Its smallest divisor is d2 = 2. Its divisors d3, d4 are not multiples of 3. Thus d3 ≥ 4 and d4 ≥ 5. am+1 = am(1 2 + 1 d3 + 1 d4 ) ≤ am(1 2 + 1 4 + 1 5 ) = 19 20 am < am. So, if a term is not divisible by 3, the next term is strictly smaller. Now, consider the sequence (an)n≥k. If for all n ≥ k, v3(an) = 0, then the sequence is strictly decreasing. A strictly decreasing sequence of positive integers must terminate. This is a failure. Therefore, for the sequence to be infinite, there must be a first term am (with m ≥ k) such that v3(am) = 0 and v3(am+1) > 0. For am+1 to gain a factor of 3, the numerator of the fraction in am+1 = am( 1 d2 + 1 d3 + 1 d4 ) must be divisible by 3. With d2 = 2, this means d3d4 + 2d4 + 2d3 ≡ 0 (mod 3), which implies (d3 − 1)(d4 − 1) ≡ 1 (mod 3). This holds if and only if d3 ≡ 2 (mod 3) and d4 ≡ 2 (mod 3). If v2(am) ≥ 2, then d3 = 4 ≡ 1 (mod 3). The condition is not met. So, for the transition to happen, the term am must have v2(am) = 1. In this case, d3 = p, the smallest odd prime factor of am. We need p ≡ 2 (mod 3). d4 is the smallest divisor of am greater than p. We also need d4 ≡ 2 (mod 3). Let the prime factorization of am be 2 · pep · qeq · · · , where p < q < . . . are odd primes. The candidates for d4 are the smallest divisors of am greater than p. These are p2 (if ep ≥ 2), 2p, and q (if am has a second odd prime factor q). Any other divisor of am greater than p is larger than one of these three. We check the congruences modulo 3, given p ≡ 2 (mod 3): - p2 ≡ 22 = 4 ≡ 1 (mod 3). - 2p ≡ 2(2) = 4 ≡ 1 (mod 3). So neither p2 nor 2p can be d4. This implies that d4 must be q, the second smallest odd prime factor of am. For this to be the case, we must have q < p2 and q < 2p. And for the condition to be met, we must have q ≡ 2 (mod 3). So, if a term am with v2 = 1, v3 = 0 gains a factor of 3, its smallest two odd prime factors, p and q, must both be congruent to 2 (mod 3). In this case, d3 = p and 42

d4 = q. Both are odd primes. Let’s check v2(am+1) = v2(am) + v2(pq + 2(p + q)) − v2(2pq). We have v2(am) = 1. Since p, q are odd, pq is odd. p + q is a sum of two odd numbers, so it’s even. 2(p + q) is a multiple of 4. So pq + 2(p + q) is odd + (multiple of 4), which is odd. Thus v2(pq + 2(p + q)) = 0. Also, v2(2pq) = 1 since p, q are odd. v2(am+1) = 1 + 0 − 1 = 0. So am+1 is odd. By Lemma 1, this leads to failure. In summary, if any term is not divisible by 3, the sequence must fail. **Lemma 3:** For any valid sequence, no term an can be divisible by 5. * **Proof:** By Lemmas 1 and 2, any term an must be divisible by 2 and 3. First, suppose v5(ak) = 0 for some k ≥ 1. We show that v5(ak+1) = 0. The smallest divisors of ak are d2 = 2, d3 = 3. d4 is the smallest divisor of ak greater than 3. Let p be the smallest prime factor of ak other than 2 or 3. Since v5(ak) = 0, p ≥ 7. The candidates for d4 are divisors of ak smaller than p, which can only be composed of primes 2 and 3. The smallest such divisor greater than 3 is 4. - If v2(ak) ≥ 2, then 4 is a divisor of ak. Since 3 < 4 < p, we have d4 = 4. - If v2(ak) = 1, then 4 is not a divisor of ak. The smallest divisor greater than 3 must be 2·3 = 6 or 32 = 9. Since 6 < 9 and 6 < p, d4 = 6. In either case, d4 is not a multiple of 5. If d4 = 4, ak+1 = 13 12 ak. If d4 = 6, ak+1 = ak. Neither operation introduces a factor of 5. So if v5(ak) = 0, then v5(ak+1) = 0. Now, assume for contradiction that some term is divisible by 5. Let an be such a term. If v2(an) = 1, then d2 = 2, d3 = 3. Since v5(an) ≥ 1, 5 is a divisor. d4 = min(6, 5) = 5. Then an+1 = an 1 2 + 1 3 + 1 5  = 31 30 an. v2(an+1) = v2(an)−v2(30) = 1−1 = 0. So an+1 is odd, which fails by Lemma 1. Therefore, for a sequence with a term divisible by 5 to be valid, every term an must satisfy v2(an) ≥ 2. This implies d4 = 4 for all n, so an+1 = 13 12 an. This means v2(an+1) = v2(an) − 2 and v3(an+1) = v3(an) − 1. This cannot continue indefinitely. The sequence must eventually produce a term am with v2(am) < 2 or v3(am) < 1. If v2(am) = 1, the next term is odd. If v2(am) = 0, the term is odd. If v3(am) = 0, the term is not divisible by 3. All these cases lead to failure. **Main Analysis** From the lemmas, any term an in a valid sequence must be of the form N = 2a 3b M, where a, b ≥ 1 and all prime factors of M are ≥ 7. We analyze the sequence based on the value of a = v2(N). **Case 1: v2(N) = 1** Let N = 21 3b M with b ≥ 1 and prime factors of M being at least 7. The smallest divisors of N are d1 = 1, d2 = 2, d3 = 3. The next smallest divisor is d4 = min(22 , 2 · 3, 32 , p), where p is the smallest prime factor of M. Since v2(N) = 1, 4 is not a divisor. d4 = min(6, 9, p). As p ≥ 7, d4 = 6. Then f(N) = N 1 2 + 1 3 + 1 6  = N(1) = N. Such numbers are fixed points. For a1 to be one of these values, we must check that d(a1) ≥ 4. d(a1) = d(21 3b M) = 2(b+1)d(M). Since b ≥ 1, b+1 ≥ 2. d(M) ≥ 1. So d(a1) ≥ 2(2)(1) = 4. The condition is satisfied. Thus, any integer N = 21 3b M with b ≥ 1 and prime factors of M being at least 7 is a possible value for a1. **Case 2: v2(N) ≥ 2** Let N = 2a 3b M with a ≥ 2, b ≥ 1 and prime factors of M being at least 7. The smallest divisors are d1 = 1, d2 = 2, d3 = 3, d4 = 4. Then f(N) = N 1 2 + 1 3 + 1 4  = 13 12 N. Let a1 be such a number. The sequence starts with as+1 = 13 12 as as long as v2(as) ≥ 2. This recurrence implies v2(as+1) = v2(as) − 2 and v3(as+1) = v3(as) − 1. For the sequence to be infinite, it must transition to a fixed point, which requires an iterate 43

ak to have v2(ak) = 1. Let v2(a1) = a. The sequence of 2-adic valuations is a, a−2, a−4, . . . . For this sequence to attain the value 1, a must be odd. If a were even, it would eventually become 0, making the term odd and causing failure. So, a must be an odd integer, a ≥ 3. The transition to v2 = 1 occurs at step s0 = (a − 1)/2. The term is as0+1 = a(a+1)/2. as+1 = 13 12 s a1 = 2a−2s 3b−s 13s M. For s = s0 = (a − 1)/2, we get v2(as0+1) = a − 2a−1 2 = 1. For this term to be a fixed point, its 3-adic valuation must be at least 1. v3(as0+1) = b−s0 = b− a−1 2 . We need b − a−1 2 ≥ 1 ⇐⇒ b ≥ 1 + a−1 2 = a+1 2 . This condition also ensures v3(as) ≥ 1 for all s ≤ s0. Finally, we verify that all terms in such a sequence satisfy d(an) ≥ 4. For s ∈ {0, 1, . . . , a−3 2 }, the term is as+1 = 2a−2s 3b−s 13s M. v2(as+1) = a − 2s ≥ a − 2(a−3 2 ) = 3. v3(as+1) = b − s ≥ b − a−3 2 ≥ a+1 2 − a−3 2 = 2. So d(as+1) = (v2(as+1) + 1)(v3(as+1) + 1)d(13s M) ≥ (3 + 1)(2 + 1)(1) = 12 ≥ 4. The term a(a+1)/2 is the fixed point 21 · 3b−(a−1)/2 · 13(a−1)/2 M. v2 = 1, v3 = b − a−1 2 ≥ 1. d(a(a+1)/2) = (1 + 1)(b − a−1 2 + 1)d(13(a−1)/2 M) ≥ 2(1 + 1)(1) = 4. All terms satisfy the condition. **Conclusion** The possible values for a1 are integers N = 2a 3b M where a, b ≥ 1 and prime factors of M are ≥ 7, satisfying one of: 1. a = 1, b ≥ 1 (fixed points). 2. a is an odd integer, a ≥ 3, and b ≥ a+1 2 (converging to a fixed point).

#### A.4.2 Solution by Grok-4

Let f(m) denote the sum of the three largest proper divisors of a positive integer m with at least three proper divisors (undefined otherwise). The problem requires finding all positive integers a1 such that the sequence defined by an+1 = f(an) is infinite, i.e., every an has at least three proper divisors. First, characterize when f(m) = m, f(m) > m, and f(m) < m. Let S be the set of positive integers divisible by 6 but not by 4 or 5. For n ∈ S, n is divisible by 2 and 3 with v2(n) = 1 and not divisible by 5. The proper divisors include n/2, n/3, n/6, all integers. To show these are the three largest, note that any proper divisor is d = n/k for some integer k ≥ 2 dividing n with d < n. The possible d correspond to the largest being n/2 (for k = 2), next n/3 (for k = 3), next n/6 (for k = 6). There is no integer k with 2 < k < 3, so no divisor between n/3 and n/2. For 3 < k < 6, the integers are 4 and 5, but n not divisible by 4 or 5, so n/4 and n/5 are not integers. For any k ≥ 7 (prime or composite), n/k ≤ n/7 < n/6 (since 7 > 6). For composite k between 6 and 7 (none) or larger, similarly n/k < n/6. Thus, no proper divisor exceeds n/6 except n/2 and n/3, so the three largest proper divisors are n/2 > n/3 > n/6, and f(n) = n/2 + n/3 + n/6 = n(1/2 + 1/3 + 1/6) = n. Every n ∈ S has at least three proper divisors, since n is divisible by distinct primes 2 and 3, so the number of divisors is at least (1 + 1)(1 + 1) = 4, hence at least three proper divisors. (For n = 6, divisors are 1, 2, 3, 6; proper 1, 2, 3.) Now, show S consists exactly of the fixed points. Suppose f(m) = m. - If m is odd, the largest proper divisor is at most m/3 (since not even, no m/2), and the next two at most m/5, m/7 (or smaller if fewer large divisors), summing to at most m(1/3 + 1/5 + 1/7) = 71m/105 < m. - If m is even but not divisible by 3, the three 44

largest are at most m/2, m/4 (if divisible by 4), m/5 (or smaller), summing to at most m(1/2 + 1/4 + 1/5) = 19m/20 < m. - If m is divisible by 6 and by 4 (hence by 12), the possible proper divisors are m/k for integers k ≥ 2 dividing m. The largest is m/2 (k = 2), next m/3 (k = 3), next m/4 (k = 4, integer since divisible by 4). There is no integer k with 3 < k < 4, so no divisor between m/4 and m/3. For k ≥ 5, m/k ≤ m/5 < m/4 (since 5 > 4). For any composite k ≥ 6, m/k ≤ m/6 < m/4 (since 6 > 4). Thus, the three largest are m/2 > m/3 > m/4, summing to 13m/12 > m. - If m is divisible by 6 and by 5 but not by 4 (so v2(m) = 1), the possible proper divisors are m/k for k ≥ 2 dividing m. The largest is m/2 (k = 2), next m/3 (k = 3), next m/5 (k = 5). There is no integer k with 3 < k < 5 except 4, but not divisible by 4, so m/4 not integer. For k ≥ 6, m/k ≤ m/6 < m/5 (since 6 > 5). For composites like k = 10 (if divisible by 10, which it is since by 2 and 5), m/10 = 0.1m < m/5 = 0.2m. Similarly for others. Thus, the three largest are m/2 > m/3 > m/5, summing to m(1/2 + 1/3 + 1/5) = 31m/30 > m. Thus, f(m) = m iff m ∈ S; f(m) > m only in the cases divisible by 12 or v2(m) = 1 and divisible by 15 (equivalent to divisible by 30 with v2 = 1); and f(m) < m otherwise. Next, prove that if m is not divisible by 6, then f(m) < m (already shown) and f(m) is not divisible by 6. - If m is odd, all proper divisors are odd, so f(m) is sum of three odds, hence odd, not divisible by 2, hence not by 6. - If m is even but not divisible by 3, write m = 2k s with s odd not divisible by 3, k ≥ 1. For k ≥ 2, the two largest proper divisors are m/2 = 2k−1 s and m/4 = 2k−2 s (since any m/p for odd prime p ≥ 5 dividing s satisfies m/p ≤ m/5 < m/4 as 2k /5 < 2k−2 for k ≥ 2). The sum of these two is congruent to 0 modulo 3: the coefficients 2k−1 and 2k−2 are congruent to 1 and 2 modulo 3 (in some order, as 2 ≡ −1 (mod 3) and powers alternate), so the sum is (1 + 2)s ≡ 0 (mod 3). The third largest proper divisor is some d < m/4 with d | m. Since m ̸≡ 0 (mod 3), no divisor d of m is divisible by 3 (else 3 | m), so d ̸≡ 0 (mod 3), i.e., d ≡ 1 or 2 (mod 3). Thus, f(m) ≡ 0 + (1 or 2) ̸≡ 0 (mod 3). Also, f(m) is even (sum includes two evens, and the third is at most m/5 or smaller, but regardless, even + even + anything = even), so even but not divisible by 3 implies not divisible by 6. For k = 1, m = 2s, s odd not divisible by 3. Let p be the minimal prime dividing s (≥ 5), u = s/p (largest proper divisor of s). The largest proper divisor of m is s (odd). The largest even proper divisor is 2u. Since p ≥ 5 > 2, 2u = 2(s/p) ≤ 2(s/5) = (2/5)s < s. The second largest is 2u (even, as 2u > u = s/p ≤ s/5 < (2/5)s ≤ 2u). The third largest is the maximum of: (i) the largest odd proper divisor less than 2u (includes u and smaller divisors of s); (ii) the largest even proper divisor less than 2u (of form 2v with v | s, v < u). Thus, if there exists v | s with u/2 < v < u (so 2v > u but 2v < 2u), then the max such 2v is even and > u, and if it is the overall max below 2u, the third is even; otherwise, if no such v or if u exceeds all such 2v, the third is u (odd). These exhaust the possibilities for the third largest, as all proper divisors are either odd (divisors of s) or even (2 times divisors of s). Case 1: Third = u (odd). Then f(m) = s + 2u + u = s + 3u ≡ s (mod 3) (since 3u ≡ 0), and s ̸≡ 0 (mod 3), so not divisible by 3. Also even (odd + even + odd = even), hence not by 6. 45

Case 2: Third even (say e = 2v > u). Then f(m) = s + 2u + e = odd + even + even = odd, not divisible by 2, hence not by 6. There are no cycles of length greater than 1. Suppose there is a cycle of length k > 1. If not all terms divisible by 6, some mi not divisible by 6, then mi+1 = f(mi) < mi and not divisible by 6, continuing strictly decreasing, but positive integers have no infinite descending chains (well-ordering), so finite, contradiction to infinite cycle. If all divisible by 6, then for each mi, f(mi) ≥ mi (with equality iff in S). For cycle length ¿1, must have some f(mi) > mi, but then the cycle would require summing increases and decreases, impossible unless all equal (contradiction). The only valid infinite sequences are those eventually reaching and staying at some fixed point in S. The possible a1 are those whose forward orbit under f reaches S without hitting numbers with fewer than three proper divisors (i.e., 1, primes, or prime powers pk with k ≤ 2, which have at most two proper divisors). From the classification, orbits reaching S are the increasing chains under the cases where f(m) > m. Chains using f(m) = (31/30)m (i.e., starting at m with v2(m) = 1, divisible by 15) yield f(m) odd v2 = 0, then strictly decreasing (since odd implies f < m, not divisible by 6), staying odd (sum of odds is odd). Such decreasing sequences cannot be infinite in positive integers (no infinite descending chains), so must eventually hit a number with < 3 proper divisors, making the sequence finite. There are no mixed chains: backward from S or 13/12-chains yields even v2 ≥ 2, but 31/30 requires v2 = 1 (odd), contradiction. Forward mixing (applying 31/30 after 13/12-steps) requires v2 = 1 intermediate, but 13/12-chains have odd v2 > 1, and applying 31/30 yields v2 = 0, then decreasing without returning to v2 > 0. Unmatched 13/12-chains (not reaching S) hit forbidden numbers. For m divisible by 12 (v2(m) = a ≥ 2, v3(m) = b ≥ 1), f(m) = (13/12)m only if 13 divides the result, but no: f is always defined as the sum, and for div by 12, it is 13/12m regardless of 13 (but for backward, 13 matters). Forward: each step subtracts 2 from v2 and 1 from v3. If a even, after a/2 steps, v2 = 0 (even - 2 repeatedly stays even), v3 = b − a/2; if v3 drops to 0 earlier (b < j for some j ≤ a/2), then that term not div by 3, hence not by 6, strictly decreasing thereafter (no infinite descending chains, so hits < 3 proper). If v3 ≥ a/2atv2 = 0, then reaches odd v2 = 0, possibly div by 3, but then strictly decreasing, staying odd, hits < 3 proper. Never reaches v2 = 1 (odd) from even v2. If a odd, after (a − 1)/2 steps, v2 = 1, v3 = b − (a − 1)/2; if this < 1 (i.e., a − 2b ≥ 0, noting a − 2b even or odd but condition for not reaching positive v3 at v2 = 1), or if v3 = 0 earlier, then not div by 6, strictly decreasing, hits < 3 proper. The valid chains are: for f ∈ S with v13(f) = c ≥ 0, write f = 21 · 3b · 13c · h (b ≥ 1, h coprime to 2,3,5,13, primes ≥ 7). For 0 ≤ j ≤ c, the number after j backward steps is n = 21+2j ·3b+j ·13c−j ·h (each step multiplies by 12/13, adding 2 to v2, 1 to v3, subtracting 1 from v13). Forward, these increase to f in S (via f(n) = (13/12)n), with all terms divisible by 6, v2 odd positive, v3 positive, at least four divisors (hence ≥ 3 proper). Such n has v2(n) = a = 1 + 2j odd positive, v3(n) = b′ = b + j positive, a − 2b′ = 1+2j −2(b+j) = 1−2b negative odd (b ≥ 1 implies ≥ −1, odd), not div by 5, other primes 46

≥ 7. Conversely, any such n arises this way: set j = (a − 1)/2 ≥ 0 integer (a odd positive), b = b′ − j = (1 − (a − 2b′ ))/2 > 0 integer (a − 2b′ negative odd implies 1 − (a − 2b′ ) positive even), factor out 2a 3b′ , remaining 13c′ · h′ (c′ ≥ 0, h′ primes ≥ 7), set c = c′ + j, h = h′ , then f = 21 3b 13c h ∈ S. Thus, these are all possible a1. all positive integers n divisible by 6 but not by 5, with odd positive 2-adic valuation a, positive 3-adic valuation b such that a-2b is negative odd, and all other prime factors ≥ 7

#### A.4.3 Solution by GPT-5

Let f(N) denote the sum of the three largest proper divisors of N. Writing the positive divisors of N in increasing order as 1 = d1 < d2 ≤ d3 ≤ d4 ≤ · · · ≤ dτ(N) = N, the three largest proper divisors are N/d2, N/d3, N/d4, hence f(N) = N  1 d2 + 1 d3 + 1 d4  . Lemma 1. If 6 | N, then f(N) =      13N/12, if 4 | N; 31N/30, if 4 ∤ N and 5 | N; N, if 4 ∤ N and 5 ∤ N. In particular, for 6 | N we have f(N) = N if and only if 4 ∤ N and 5 ∤ N. Proof. When 6 | N, we have d2 = 2 and d3 = 3. The next divisor d4 is the least of 4, 5, 6 that divides N. Therefore f(N) = N  1 2 + 1 3 + 1 d4  , which yields the three stated values. Lemma 2. If 2 | N and 3 ∤ N, then f(N) ≤  1 2 + 1 4 + 1 5  N = 19 20 N. Proof. Let 1 = d1 < d2 ≤ d3 ≤ d4 be the first four divisors. Since 2 | N, d2 = 2. Case 1: 4 | N. Then d3 = 4. Because 3 ∤ N, the next divisor d4 ≥ 5. Thus f(N) = N 2 + N 4 + N d4 ≤  1 2 + 1 4 + 1 5  N. Case 2: 4 ∤ N. Then v2(N) = 1. Since 3 ∤ N, the least odd divisor is at least 5, so d3 ≥ 5. The next divisor d4 is either an odd divisor ≥ 7, or of the form 2p with odd p ≥ 5, hence d4 ≥ min{7, 10} = 7. Therefore f(N) ≤  1 2 + 1 5 + 1 7  N = 59 70 N < 19 20 N. 47

Lemma 3. Let N be odd and suppose N has at least three proper divisors. Then f(N) ≤  1 3 + 1 5 + 1 7  N = 71 105 N < N, and f(N) is odd. Proof. All divisors are odd. The smallest divisor greater than 1 is at least 3, so d2 ≥ 3. The next d3 is at least 5 (either the next odd prime or a square ≥ 9). Among {3, 5} at most two appear among d2, d3, d4, hence d4 ≥ 7. Thus 1 d2 + 1 d3 + 1 d4 ≤ 1 3 + 1 5 + 1 7 , giving the bound on f(N). Each of N/d2, N/d3, N/d4 is odd, so f(N) is odd. Lemma 4. Let N be even with 3 ∤ N. (i) If 4 | N, then 3 ∤ f(N). (ii) If v2(N) = 1, then either 3 ∤ f(N) or f(N) is odd. Proof. Write N = 2t M with t ≥ 1, M odd, 3 ∤ M. (i) If t ≥ 2, then d2 = 2, d3 = 4, and d4 is either 8 or the least odd divisor p ≥ 5 of M. Modulo 3, any d coprime to 3 satisfies d−1 ≡ d (mod 3). Hence f(N) N ≡ 1 2 + 1 4 + 1 d4 ≡ (−1) + 1 + (±1) ∈ {±1} (mod 3), so 3 ∤ f(N). (ii) If t = 1, then d2 = 2, and d3 is the least odd divisor p ≥ 5 of M. The next divisor d4 is either 2p or an odd divisor q of M. If d4 = 2p, then f(N) N = 1 2 + 1 p + 1 2p ≡ (−1) + ε + (−ε) ≡ −1 ̸≡ 0 (mod 3), with ε ∈ {±1} the residue of p modulo 3, so 3 ∤ f(N). If d4 is odd, then N/2 is odd while N/d3 and N/d4 are even, hence f(N) is odd. Corollary A (no odd term). If some an were odd, then by Lemma 3, an+1 is odd and an+1 < an, so an, an+1, . . . would be a strictly decreasing infinite sequence of positive integers, a contradiction. Hence no odd term occurs. Corollary B (no even, 3-free term). Suppose some ak is even with 3 ∤ ak. Let ak, . . . , aℓ be the maximal contiguous block of such terms. By Lemma 2, for each j in this block, aj+1 ≤ 19 20 aj, so the block is finite. At its end aℓ+1 is not even and 3-free; by Lemma 4 it cannot be a multiple of 6, hence it is odd, contradicting Corollary A. Therefore no even, 3-free term occurs. Consequently, every an is divisible by 6. 48

Proposition C’ (no term is divisible by 5). No term an is divisible by 5. Proof. Assume 5 | an for some n. If 3 ∤ an, then an is either odd or even and 3-free, both impossible (Corollaries A and B). If 2 ∤ an, then an is odd, again impossible. Thus 6 | an. Write an = 2s 3r u with s ≥ 1, r ≥ 1, 5 | u, and gcd(u, 6) = 1. - If s = 1 (i.e., 4 ∤ an), then by Lemma 1, an+1 = f(an) = 31 30 an, whence v2(an+1) = v2(an) − 1 = 0, so an+1 is odd, contradicting Corollary A. - If s ≥ 2 (i.e., 12 | an), perform the iteration Ni+1 = 13 12 Ni as long as 12 | Ni. Let N0 = an and let k ≥ 1 be maximal with this property; put N := Nk. Each step reduces v2 by 2 and v3 by 1 and preserves 5 | Ni. Maximality implies at N at least one of v3(N) = 0 or v2(N) ≤ 1 holds. The possible terminal cases are exactly: (A) v3(N) = 0 and v2(N) ≥ 2 (even, 3-free), contradicting Corollary B. (A’) v3(N) = 0 and v2(N) = 1 (even, 3-free), also contradicting Corollary B. (B) v2(N) = 1 and v3(N) ≥ 1: then 4 ∤ N and 5 | N, so by Lemma 1, f(N) = 31 30 N, which is odd (since v2(f(N)) = 0), contradicting Corollary A. (C) v2(N) = 0 (so N is odd), contradicting Corollary A. These cases are mutually exclusive and exhaustive. In every case we reach a contradiction. Therefore 5 ∤ an for all n. Proposition E (structure of steps). For every n, either an+1 = an or an+1 = 13 12 an, and the latter occurs precisely when 12 | an. Proof. By Corollaries A–B, 6 | an, and by Proposition C’, 5 ∤ an. Lemma 1 then yields: if 4 ∤ an, f(an) = an; if 4 | an, f(an) = 13 12 an. The latter is equivalent to 12 | an. Proposition H (finiteness of non-fixed steps; stabilization). Only finitely many indices n satisfy an+1 = 13 12 an. Consequently, the sequence eventually stabilizes at a fixed point N with 6 | N, 4 ∤ N, 5 ∤ N. Proof. By Corollaries A–B, every term is a multiple of 6, so v3(an) ≥ 1. By Proposition C’, 5 ∤ an for all n. By Proposition E, the only non-fixed step is multiplication by 13 12 , which reduces v2 by 2 and v3 by 1. Infinitely many such steps would force v3 to become 0 along some tail, impossible. Hence only finitely many non-fixed steps occur. After the last such step, we have a term N with 6 | N, 4 ∤ N, 5 ∤ N, and by Lemma 1 it is fixed: f(N) = N. Proposition F (necessary conditions on a1). Let T be the number of indices j with aj+1 = 13 12 aj. Then v2(a1) = 2T + 1, v3(a1) ≥ T + 1, and 5 ∤ a1. Proof. By Proposition H the sequence stabilizes at a fixed multiple of 6 not divisible by 5. By Lemma 1 and Proposition E, a fixed multiple of 6 not divisible by 5 must satisfy 4 ∤ N, hence v2(N) = 1, and has v3(N) ≥ 1. Each non-fixed step multiplies by 13 12 , decreasing v2 by 2 and v3 by 1. Tracing back T such steps gives v2(a1) = 1 + 2T = 2T + 1 and v3(a1) ≥ 1 + T = T + 1. Finally 5 ∤ a1 by Proposition C’. 49

Equivalently, a1 must be of the form a1 = 22t+1 3b m with integers t ≥ 0, b ≥ t + 1, and gcd(m, 30) = 1. Proposition G (sufficient conditions on a1). Assume a1 = 22t+1 3b m with t ≥ 0, b ≥ t + 1, and gcd(m, 30) = 1. Then the sequence is valid and evolves as follows: - For j = 1, 2, . . . , t, aj+1 = 13 12 aj. - The term at+1 satisfies 6 | at+1, 4 ∤ at+1, 5 ∤ at+1, hence at+2 = at+1. - Every term is a multiple of 6, and thus has at least three proper divisors. Proof. For 1 ≤ j ≤ t, v2(aj) = 2t + 1 − 2(j − 1) ≥ 3 and v3(aj) = b − (j − 1) ≥ t + 1 − (j − 1) ≥ 2, so 12 | aj and, by Proposition E, aj+1 = 13 12 aj. After t steps, v2(at+1) = 1 and v3(at+1) ≥ 1. Since gcd(m, 30) = 1 and the multiplier 13 12 introduces no factor 5, we have 5 ∤ at+1. Lemma 1 gives at+2 = f(at+1) = at+1, and the sequence is constant thereafter. Finally, 6 | aj for all j, hence each term has proper divisors 1, 2, 3. Conclusion. Combining Propositions F and G yields the classification: a1 is valid if and only if a1 = 22t+1 3b m with t ≥ 0, b ≥ t + 1, and gcd(m, 30) = 1. For such a1, exactly t steps of a 7→ 13 12 a occur, after which the sequence stabilizes at a fixed point N with 6 | N, 4 ∤ N, 5 ∤ N.

### A.5 Problem 5

Problem 5. Alice and Bazza are playing the inekoalaty game, a two-player game whose rules depend on a positive real number λ which is known to both players. On the nth turn of the game (starting with n = 1) the following happens:

- If n is odd, Alice chooses a nonnegative real number xn such that

x1 + x2 + · · · + xn ≤ λn.

- If n is even, Bazza chooses a nonnegative real number xn such that

x2 1 + x2 2 + · · · + x2 n ≤ n. If a player cannot choose a suitable number xn, the game ends and the other player wins. If the game goes forever, neither player wins. All chosen numbers are known to both players. Determine all values of λ for which Alice has a winning strategy and all those for which Bazza has a winning strategy. 50

#### A.5.1 Solution by Gemini 2.5 Pro

Let Sn = Pn i=1 xi and Qn = Pn i=1 x2 i . Alice plays on odd turns n, Bazza on even turns n. Alice’s move xn is valid if Sn−1 + xn ≤ λn. If Sn−1 > λn, she loses. Bazza’s move xn is valid if Qn−1 + x2 n ≤ n. If Qn−1 > n, he loses. **Case 1: λ > √ 2 2 (Alice has a winning strategy)** Alice can devise a plan to win on a predetermined turn 2m − 1. **Alice’s Plan:** 1. Alice chooses an integer m large enough such that λ > m √ 2 2m−1 . Such an m exists because the function g(m) = m √ 2 2m−1 is strictly decreasing for m ≥ 1 and limm→∞ g(m) = √ 2 2 . 2. For her turns 2k − 1 where k = 1, . . . , m − 1, Alice chooses x2k−1 = 0. 3. On turn 2m − 1, Alice will choose a value x2m−1 that makes Bazza’s next move impossible. **Analysis of Alice’s Plan:** Alice wins on turn 2m − 1 if she can choose x2m−1 ≥ 0 such that her move is valid and Bazza’s next move is not. This is possible if and only if the interval of winning moves for x2m−1, which is ( √ 2m − Q2m−2, λ(2m − 1) − S2m−2], is non-empty. This requires the condition: S2m−2 + p 2m − Q2m−2 < λ(2m − 1) Bazza’s goal is to prevent this. Given Alice’s plan (x2k−1 = 0 for k < m), Bazza controls the values yk = x2k for k = 1, . . . , m − 1. These choices determine S2m−2 = Pm−1 k=1 yk and Q2m−2 = Pm−1 k=1 y2 k. Bazza’s best defense is to choose his moves to maximize the function F = S2m−2 + √ 2m − Q2m−2. **Lemma:** The maximum value of F that Bazza can achieve is m √ 2. **Proof:** Let S = S2m−2 and Q = Q2m−2. Bazza’s moves are constrained by Pj i=1 y2 i ≤ 2j for j = 1, . . . , m−1. This implies Q = Pm−1 k=1 y2 k ≤ 2(m−1). By the Cauchy-Schwarz inequality, S2 = ( Pm−1 k=1 yk)2 ≤ (m − 1) Pm−1 k=1 y2 k = (m − 1)Q. Thus, S ≤ p (m − 1)Q. So, F ≤ p (m − 1)Q + √ 2m − Q. Let this upper bound be h(Q). We maximize h(Q) for Q ∈ [0, 2(m − 1)]. The derivative h′ (Q) = √ m−1 2 √ Q − 1 2 √ 2m−Q is positive for Q < 2(m − 1). So h(Q) is strictly increasing on its domain. The maximum is at Q = 2(m − 1). The maximum value of h(Q) is h(2(m−1)) = p (m − 1)2(m − 1)+ p 2m − 2(m − 1) = √ 2(m−1)+ √ 2 = m √ 2. This maximum is achieved when Q = 2(m − 1) and the Cauchy-Schwarz inequality is an equality, which means all yk are equal. Let yk = c. Then Q = (m − 1)c2 = 2(m − 1) =⇒ c = √ 2. The sequence of moves x2k = √ 2 for k = 1, . . . , m − 1 is valid for Bazza and it maximizes the defensive function F. **Alice’s Victory:** Alice’s strategy is guaranteed to work if her winning condition holds even against Bazza’s best defense. This requires max(F) < λ(2m − 1), which is m √ 2 < λ(2m − 1), or λ > m √ 2 2m−1 . By her initial choice of m, this condition is met. We must also check that Alice’s moves x2k−1 = 0 for k < m are valid. This requires S2k−2 ≤ λ(2k − 1). Bazza’s best defense maximizes S2k−2 to (k −1) √ 2. The condition is (k −1) √ 2 ≤ λ(2k −1), or λ ≥ (k−1) √ 2 2k−1 . Since λ > √ 2 2 and (k−1) √ 2 2k−1 is an increasing function of k with limit √ 2 2 , this condition holds for all k. Thus, Alice has a winning strategy. **Case 2: λ < √ 2 2 (Bazza has a winning strategy)** 51

Bazza’s strategy is to always play x2k = p 2k − Q2k−1 if possible. This sets Q2k = 2k. As shown in Case 1, Alice cannot win against this strategy because her winning condition λ > m √ 2 2m−1 can never be met if λ < √ 2 2 . We now show that Bazza will win. Alice loses on turn 2m − 1 if S2m−2 > λ(2m − 1). To survive, Alice must choose her moves to keep the sequence of sums S2k−2 as small as possible for as long as possible. With Bazza’s strategy, Alice’s choice of x2k−1 (provided x2k−1 ≤ √ 2) determines Bazza’s response x2k = q 2 − x2 2k−1. The sum grows by Ck = x2k−1 + q 2 − x2 2k−1 over turns 2k − 1 and 2k. To minimize the sum S2m−2 = Pm−1 k=1 Ck, Alice must choose each x2k−1 to minimize Ck. The function f(x) = x + √ 2 − x2 on [0, √ 2] has a minimum value of √ 2, achieved only at x = 0 and x = √ 2. Any other choice would lead to a strictly larger sum S2m−2 for all m > k + 1, making survival strictly harder. Thus, an optimal survival strategy for Alice must consist only of moves x2k−1 ∈ {0, √ 2}. Let’s compare these two choices at turn 2k − 1. Suppose Alice has survived so far, with sum S2k−2. 1. If Alice chooses x2k−1 = 0: This move is valid if S2k−2 ≤ λ(2k − 1). The resulting sum is S2k = S2k−2 + √ 2. 2. If Alice chooses x2k−1 = √ 2: This move is valid if S2k−2 + √ 2 ≤ λ(2k − 1). The resulting sum is S2k = S2k−2 + √ 2. Both choices lead to the same future sums S2j for j ≥ k, meaning the survival conditions for all subsequent turns are identical regardless of which of the two is chosen. However, the condition to be allowed to make the choice at turn 2k − 1 is strictly easier for x2k−1 = 0. A strategy involving x2k−1 = √ 2 is only valid if the corresponding strategy with x2k−1 = 0 is also valid, but the converse is not true. Therefore, the strategy of always choosing x2k−1 = 0 is Alice’s best hope for survival. If she cannot survive with this strategy, she cannot survive with any other. We now analyze this specific line of play: Alice always plays x2k−1 = 0, and Bazza responds with x2k = √ 2. 1. Let h(k) = (k−1) √ 2 2k−1 . Since h(k) is strictly increasing and approaches √ 2 2 , and λ < √ 2 2 , there exists a smallest integer m ≥ 2 such that λ < h(m). 2. For any k < m, we have λ ≥ h(k). Alice’s move x2k−1 = 0 is valid, since S2k−2 = (k − 1) √ 2 and the condition is (k−1) √ 2 ≤ λ(2k−1), which is equivalent to λ ≥ h(k). 3. On turn 2m−1, Alice has played according to her optimal survival strategy. The sum is S2m−2 = (m−1) √ 2. She must choose x2m−1 ≥ 0 such that (m − 1) √ 2 + x2m−1 ≤ λ(2m − 1). 4. By the choice of m, we have λ < (m−1) √ 2 2m−1 , which is λ(2m − 1) < (m − 1) √ 2. 5. The condition for Alice’s move becomes (m−1) √ 2+x2m−1 ≤ λ(2m−1) < (m−1) √ 2. This implies x2m−1 < 0, which is impossible. Alice cannot make a move, so Bazza wins. **Case 3: λ = √ 2 2 (Draw)** In this case, neither player has a winning strategy. A player has a winning strategy if they can force a win in a finite number of moves against any of the opponent’s strategies. **Alice does not have a winning strategy.** To prove this, we show that Bazza has a defensive strategy that prevents Alice from ever winning. Let Bazza adopt the strategy of always choosing x2k = p 2k − Q2k−1 (if possible). Alice wins if she can play x2m−1 on turn 2m − 1 such that Q2m−1 > 2m. With Bazza’s strategy, Q2m−2 = 2(m − 1) (assuming Alice has not won before). Alice’s winning condition becomes 2(m − 1) + x2 2m−1 > 2m, which 52

simplifies to x2m−1 > √ 2. To play such a move, her budget must allow it: S2m−2 + x2m−1 ≤ λ(2m − 1) = √ 2 2 (2m − 1). This requires S2m−2 + √ 2 < √ 2 2 (2m − 1). Against Bazza’s strategy, S2m−2 = Pm−1 k=1 (x2k−1 + q 2 − x2 2k−1). The minimum value of each term is √ 2, so the minimum possible value of S2m−2 is (m − 1) √ 2. Thus, for Alice to win, it must be that (m − 1) √ 2 + √ 2 < √ 2 2 (2m − 1), which simplifies to m √ 2 < √ 2 2 (2m − 1) ⇐⇒ 2m < 2m − 1 ⇐⇒ 0 < −1. This is impossible. So, Alice can never satisfy her winning condition against this strategy from Bazza. Therefore, Alice does not have a winning strategy. **Bazza does not have a winning strategy.** To prove this, we show that Alice has a defensive strategy that prevents Bazza from ever winning. Let Alice adopt the strategy of always choosing x2k−1 = 0. Bazza wins if he can force S2m−2 > λ(2m − 1) = √ 2 2 (2m − 1) for some m. With Alice’s strategy, S2m−2 = Pm−1 k=1 x2k. Bazza’s moves x2k are constrained by Q2k = Pk i=1 x2 2i ≤ 2k. To force a win, Bazza must maximize S2m−2. As shown in the lemma in Case 1, the maximum possible value for S2m−2 is (m−1) √ 2, achieved when Bazza plays x2k = √ 2 for all k < m. So, the largest sum Bazza can force is S2m−2 = (m − 1) √ 2. Bazza wins if this sum exceeds Alice’s budget limit, i.e., if (m − 1) √ 2 > √ 2 2 (2m − 1). This simplifies to 2(m − 1) > 2m − 1 ⇐⇒ 2m − 2 > 2m − 1 ⇐⇒ −2 > −1. This is impossible. So, Bazza can never force Alice to lose. Therefore, Bazza does not have a winning strategy. Since neither player can force a win, neither has a winning strategy. The game can continue indefinitely, for example with Alice always playing x2k−1 = 0 and Bazza always playing x2k = √ 2. This results in a draw.

#### A.5.2 Solution by Grok-4

We prove that Alice has a winning strategy if and only if λ > √ 2 2 , Bazza has a winning strategy if and only if λ < √ 2 2 , and neither has a winning strategy if λ = √ 2 2 . First, suppose λ > √ 2 2 . Choose a fixed k such that λ(2k + 1) − k √ 2 > √ 2; such k exists because λ > √ 2 · k+1 2k+1 for sufficiently large k, as k+1 2k+1 → 1 2 . Alice employs the following strategy: choose xn = 0 for all odd n ≤ 2k − 1, and on n = 2k + 1 choose the maximum x2k+1 = λ(2k + 1) − S2k. Her goal is to ensure Q2k+1 = Q2k + x2 2k+1 > 2k + 2, so Bazza cannot choose any x2k+2 ≥ 0 satisfying Q2k+1 + x2 2k+2 ≤ 2k + 2. We first prove by induction on k that if Alice chooses xn = 0 on all odd n ≤ 2k − 1, then the maximum achievable S2k (over all possible Bazza plays) is k √ 2, achieved when Bazza chooses x2j = √ 2 for each j = 1 to k, yielding Q2k = 2k; moreover, for any Bazza play, S2k ≤ k √ 2. For the base case k = 1: Bazza chooses x2 ≤ √ 2 − Q1 = √ 2 (since Q1 = 0), so max S2 = √ 2, achieved at x2 = √ 2, with Q2 = 2. Assume true for k − 1: The max S2(k−1) = (k − 1) √ 2, achieved by x2j = √ 2 for j = 1 to k − 1, with Q2(k−1) = 2(k − 1); for any play, S2(k−1) ≤ (k − 1) √ 2. Since x2k−1 = 0, Q2k−1 = Q2(k−1). Bazza then chooses x2k ≤ p 2k − Q2k−1 = p 2k − Q2(k−1). Thus, S2k = S2(k−1) +x2k ≤ S2(k−1) + p 2k − Q2(k−1). Let t = S2(k−1), q = Q2(k−1), with 0 ≤ t ≤ (k−1) √ 2. For fixed t, the expression t+ √ 2k − q is maximized when q is minimized (subject to possible q 53

for that t). By the induction hypothesis applied to previous steps and the fact that deviations lead to smaller t or larger q for that t, the overall maximum is at most max0≤t≤(k−1) √ 2 g(t), where g(t) = t + q 2k − t2 k−1 (using the minimal possible q = t2 k−1 by Cauchy-Schwarz on the first k − 1 even terms). We have g′ (t) = 1 − t/(k−1) √ 2k−t2/(k−1) . Setting g′ (t) = 0 yields t = (k − 1) √ 2, and g((k − 1) √ 2) = (k − 1) √ 2 + p 2k − 2(k − 1) = (k − 1) √ 2 + √ 2 = k √ 2. At the boundaries, g(0) = √ 2k < k √ 2 for k ≥ 1, and since the critical point is at the upper endpoint and g′ (t) > 0 for t < (k − 1) √ 2 (as verified by the condition for g′ > 0 holding strictly there), the maximum is k √ 2. This is achievable when t = (k−1) √ 2 and q = 2(k−1), which occurs under the greedy strategy. If Bazza deviates earlier, yielding t < (k − 1) √ 2 or q > t2 k−1 , then S2k < k √ 2. Finally, independently, by Cauchy-Schwarz applied to the k even terms (odd terms are 0), Q2k = Pk j=1 x2 2j ≥ 1 k Pk j=1 x2j 2 = S2 2k k , with equality if and only if all x2j are equal. This completes the induction. Now, let c = λ(2k + 1) > k √ 2 ≥ S2k (by choice of k), so Alice can choose x2k+1 = c − S2k ≥ 0. Then Q2k+1 = Q2k + (c − S2k)2 ≥ S2 2k k + (c − S2k)2 . Let h(s) = s2 k + (c − s)2 for 0 ≤ s ≤ k √ 2. This is a quadratic in s with minimum at s = ck k+1 > k √ 2 (since c > k √ 2 implies ck k+1 > k2 √ 2 k+1 ≈ k √ 2 for large k), so on [0, k √ 2], the minimum is at s = k √ 2, where h(k √ 2) = 2k + (c − k √ 2)2 > 2k + 2 (since c − k √ 2 > √ 2). Thus, Q2k+1 > 2k + 2 for all achievable (S2k, Q2k), forcing Bazza stuck on 2k + 2. Next, suppose λ < √ 2 2 . Bazza chooses x2j = p 2j − Q2j−1 on each even 2j (or 0 if negative, but we show it is always positive). We prove by induction on m that under this strategy, (i) Bazza can always move (Q2j−1 < 2j for all j ≤ m), (ii) the minimal achievable S2m is m √ 2, attained iff Alice chooses x2j−1 = 0 for all j = 1 to m, and (iii) any deviation by Alice yields S2m > m √ 2. For m = 1: Alice chooses 0 ≤ x1 ≤ λ < √ 2 2 < √ 2, so Q1 = x2 1 < 0.5 < 2. Bazza chooses x2 = p 2 − x2 1 > √ 2 − 0.5 > 1 > 0. Let h(y) = y + p 2 − y2 for 0 ≤ y ≤ λ < √ 2 2 . Then h′ (y) = 1− y √ 2−y2 > 0 (since y < 1 implies y < p 2 − y2), so h is increasing, min h(0) = √ 2, and h(y) > √ 2 for y > 0. Thus, min S2 = √ 2 at x1 = 0, and > √ 2 otherwise. Assume true for m − 1: Min S2(m−1) = (m − 1) √ 2 iff all prior odd x = 0, with Q2(m−1) ≤ 2(m − 1) always, and Q2j−1 < 2j for j ≤ m − 1. Alice chooses 0 ≤ x2m−1 ≤ r2m−1 = λ(2m − 1) − S2(m−1) ≤ λ(2m − 1) − (m − 1) √ 2 < √ 2 2 < 1. Then Q2m−1 = Q2(m−1) + x2 2m−1 < 2(m − 1) + 0.5 < 2m (even if S2(m−1) > (m − 1) √ 2, r2m−1 < √ 2 2 , so still Q2m−1 < 2m). Bazza chooses x2m = √ 2m − Q2m−1 > 0. Now S2m = S2(m−1) + x2m−1 + p 2 − x2 2m−1 ≥ (m − 1) √ 2 + min h(y) over 0 ≤ y ≤ r2m−1 < √ 2 2 , so min = (m − 1) √ 2 + √ 2 = m √ 2 at y = 0 (requiring prior min), and > m √ 2 if y > 0 or prior > (m − 1) √ 2. This completes the induction. Thus, max r2m+1 = λ(2m+1)−m √ 2 < √ 2 2 < √ 2, so Alice cannot force Q2m+1 > 2m+2 (requires x2m+1 > √ 2). Moreover, since 2λ − √ 2 < 0, max r2m+1 → −∞, eventually < 0; on other paths, S2m > m √ 2, so r2m+1 < 0 sooner. Hence Alice gets stuck on some odd turn, 54

while Bazza always moves. Finally, for λ = √ 2 2 , neither has a winning strategy. First, Bazza has no winning strategy (cannot force termination on an odd turn) because Alice can choose xn = 0 on all odd n. Then, by the lemma above (which holds independently of λ, as it assumes Alice chooses 0 on odds), S2m ≤ m √ 2 for any Bazza play, so r2m+1 = √ 2 2 (2m+1)−S2m ≥ √ 2 2 (2m+1)−m √ 2 = √ 2 2 > 0. Thus, Alice can always choose x2m+1 = 0 ≤ r2m+1. Alice has no winning strategy (cannot force termination on an even turn) because Bazza can choose the greedy maximization strategy x2j = p 2j − Q2j−1. We prove by induction on m that under this strategy, (i) Bazza can always move (Q2j−1 ≤ 2j for all j ≤ m), (ii) the minimal achievable S2m is m √ 2, attained iff Alice chooses x2j−1 = 0 for all j = 1 to m, and (iii) any deviation by Alice yields S2m > m √ 2. This induction is explicitly adapted from the λ < √ 2 2 case; the only difference is that now λ = √ 2 2 , but since the key bound r2m−1 ≤ √ 2 2 < 1 still holds on the minimizing path (as verified below), the derivative argument for h(y) = y + p 2 − y2 being increasing on [0, √ 2 2 ] (with h′ (y) > 0 for y < 1) applies identically. For m = 1: Alice chooses 0 ≤ x1 ≤ λ = √ 2 2 < √ 2, so Q1 = x2 1 ≤ 0.5 < 2. Bazza chooses x2 = p 2 − x2 1 ≥ √ 2 − 0.5 > 1 ≥ 0. As before, h(y) = y + p 2 − y2 is increasing on [0, √ 2 2 ], so min S2 = √ 2 at x1 = 0, and > √ 2 otherwise. Assume true for m − 1: Min S2(m−1) = (m − 1) √ 2 iff all prior odd x = 0, with Q2(m−1) ≤ 2(m − 1) always, and Q2j−1 ≤ 2j for j ≤ m − 1. Alice chooses 0 ≤ x2m−1 ≤ r2m−1 = λ(2m − 1) − S2(m−1) ≤ λ(2m − 1) − (m − 1) √ 2 = √ 2 2 < 1 (on the minimizing path; if S2(m−1) > (m − 1) √ 2, then r2m−1 < √ 2 2 ). Then Q2m−1 = Q2(m−1) + x2 2m−1 ≤ 2(m − 1) + 0.5 < 2m. Bazza chooses x2m = √ 2m − Q2m−1 ≥ 0 (since Q2m−1 < 2m). Now S2m = S2(m−1) + x2m−1 + p 2 − x2 2m−1 ≥ (m − 1) √ 2 + min h(y) over 0 ≤ y ≤ r2m−1 ≤ √ 2 2 , so min = (m − 1) √ 2 + √ 2 = m √ 2 at y = 0 (requiring prior min), and > m √ 2 if y > 0 or prior > (m − 1) √ 2. This completes the induction. Thus, Q2j−1 ≤ 2j always, so Bazza can always move (choosing x2j = 0 if Q2j−1 = 2j). Under these strategies, both always move, and the game continues indefinitely. Alice: λ > √ 2 2 Bazza: λ < √ 2 2 (neither: λ = √ 2 2 )

#### A.5.3 Solution by GPT-5

Let Sn := Pn j=1 xj and Qn := Pn j=1 x2 j . By the rules, at odd turns 2k − 1 Alice must ensure S2k−1 ≤ λ(2k − 1), and at even turns 2k Bazza must ensure Q2k ≤ 2k. Lemma A (Even-turn response and pairwise lower bound). Fix k ≥ 1. Suppose the game is ongoing at the start of turn 2k; in particular, Bazza made a legal move at turn 2k − 2, hence Q2k−2 ≤ 2(k − 1). Assume also that Bazza is not already stuck at turn 2k, i.e., Q2k−1 ≤ 2k. 55

Define x2k := q max{0, 2 − x2 2k−1}. Then x2k is legal (so Q2k ≤ 2k) and x2k−1 + x2k ≥ √ 2. Consequently, if Bazza uses this response at each even turn for which the game reaches that turn, then for every k for which turn 2k occurs, S2k ≥ √ 2 k. Proof. Write t := x2k−1 ≥ 0. Since Q2k−1 = Q2k−2 + t2 and Q2k−2 ≤ 2(k − 1), 2k − Q2k−1 = 2k − Q2k−2 − t2 ≥ 2 − t2 . Therefore x2 2k = max{0, 2 − t2 } ≤ 2k − Q2k−1, so the move is legal and Q2k ≤ 2k. For the pairwise sum, if t ≥ √ 2 then t + x2k ≥ √ 2. If 0 ≤ t ≤ √ 2, then x2k = √ 2 − t2 and t + x2k = t + √ 2 − t2 ≥ √ 2. Summing these lower bounds over k pairs yields S2k ≥ √ 2 k. Lemma B (Bazza’s safety for λ ≤ 1/ √ 2). Assume λ ≤ 1/ √ 2 and that Bazza, whenever it is his turn and he is not already stuck, uses the move from Lemma A. Then, for every k ≥ 1, Q2k−1 < 2k. Proof. By induction on k. For k = 1, Alice must choose x1 ≤ λ ≤ 1/ √ 2, so Q1 = x2 1 ≤ 1/2 < 2. Suppose the claim holds for all indices less than k. Then, for each j ≤ k −1, Bazza had a legal move at turn 2j (since Q2j−1 < 2j by the induction hypothesis) and played according to Lemma A; thus x2j−1 + x2j ≥ √ 2, and summing yields S2k−2 ≥ √ 2 (k − 1). At turn 2k − 1, Alice must pick x2k−1 ≥ 0 with S2k−2 + x2k−1 ≤ λ(2k − 1), so x2k−1 ≤ λ(2k − 1) − S2k−2 ≤ 1 √ 2 (2k − 1) − √ 2 (k − 1) = 1 √ 2 . Therefore Q2k−1 = Q2k−2 + x2 2k−1 ≤ 2(k − 1) + 1 2 < 2k. This completes the induction. Proposition 1 (Bazza wins for λ < 1/ √ 2). If λ < 1/ √ 2, then Bazza has a winning strategy. 56

Proof. Bazza follows Lemma A at every even turn. By Lemma B, he is never stuck at even turns. Lemma A also yields S2k ≥ √ 2 k for all k ≥ 1. Let δ := 1 √ 2 − λ > 0. Then √ 2 k − λ(2k + 1) = ( √ 2 − 2λ) k − λ = 2δ k − λ, which is positive for all sufficiently large k. Hence for some k, S2k > λ(2k + 1), so Alice has no legal move at turn 2k + 1. Thus Bazza wins. Lemma C (Alice’s decisive odd move after zeros). Fix k ≥ 1. Suppose x2i−1 = 0 for i = 1, . . . , k−1 and that the game is still ongoing at the start of turn 2k−1, so Q2k−2 ≤ 2k−2. Let s := x2 + x4 + · · · + x2k−2 = S2k−2, q := x2 2 + x2 4 + · · · + x2 2k−2 = Q2k−2, and define ∆ := λ(2k − 1) − s. Then, for every legal prior history, ∆ − p 2k − q ≥ λ(2k − 1) − √ 2 k. In particular, if λ(2k − 1) > √ 2 k, then Alice’s legal choice x2k−1 := ∆ satisfies x2k−1 > √ 2k − q, whence Q2k−1 = q + x2 2k−1 > 2k, so Bazza is stuck at turn 2k. Proof. By Cauchy–Schwarz, s2 ≤ (k −1)q, so q ≥ s2 /(k −1). Also q ≤ 2k −2 by legality. Consider f(s, q) := λ(2k − 1) − s − p 2k − q. For fixed s, f is increasing in q because q 7→ − √ 2k − q is increasing. Hence, for q ≥ s2 /(k−1), f(s, q) ≥ f(s, s2 k − 1 ). Define g(s) := f(s, s2 k−1 ) = λ(2k−1)−s− p 2k − s2/(k − 1). From q ≤ 2k−2 and s2 ≤ (k−1)q we get 0 ≤ s ≤ √ 2 (k − 1), and on this interval g′ (s) = −1 + s (k − 1) p 2k − s2/(k − 1) ≤ −1 + s (k − 1) √ 2 ≤ 0. Thus g is decreasing on [0, √ 2(k − 1)], so g(s) ≥ g( √ 2 (k − 1)) = λ(2k − 1) − √ 2 (k − 1) − √ 2 = λ(2k − 1) − √ 2 k. 57

Therefore f(s, q) ≥ λ(2k − 1) − √ 2k, proving the claimed bound. If λ(2k − 1) > √ 2k, then x2k−1 := ∆ is legal and satisfies x2k−1 > √ 2k − q, so Q2k−1 > 2k. Proposition 2 (Alice wins for λ > 1/ √ 2). If λ > 1/ √ 2, then Alice has a winning strategy. Proof. Alice plays x2i−1 = 0 for i = 1, 2, . . . , until the first k with λ(2k − 1) > √ 2 k. Such a k exists because the sequence √ 2 k/(2k − 1) is strictly decreasing and converges to 1/ √ 2. These zero moves are always legal: for each i ≥ 1, by Cauchy–Schwarz and even-turn legality, S2i−1 = S2i−2 ≤ √ i − 1 p Q2i−2 ≤ √ i − 1 √ 2i − 2 = √ 2 (i − 1). Moreover, for every integer i ≥ 1, √ 2 (i − 1) < 1 √ 2 (2i − 1) ≤ λ(2i − 1), since (i − 1)/(2i − 1) < 1/2 and λ > 1/ √ 2. Thus x2i−1 = 0 is legal for all i prior to k. At the special odd turn 2k − 1, Lemma C gives ∆ − p 2k − Q2k−2 ≥ λ(2k − 1) − √ 2 k > 0. Therefore Alice’s legal choice x2k−1 := ∆ forces Q2k−1 > 2k, so Bazza has no legal move at turn 2k. Hence Alice wins. Proposition 3 (Draw at λ = 1/ √ 2). If λ = 1/ √ 2, neither player has a winning strategy. Proof. Alice avoids losing by always choosing x2i−1 = 0. Indeed, for each i ≥ 1, S2i−1 = S2i−2 ≤ √ i − 1 p Q2i−2 ≤ √ i − 1 √ 2i − 2 = √ 2 (i − 1) ≤ 1 √ 2 (2i − 1) = λ(2i − 1), so the odd-turn constraint is satisfied. Bazza avoids losing by using the strategy of Lemma A; with λ = 1/ √ 2, Lemma B gives Q2k−1 < 2k for all k, so Bazza always has a legal even move. Thus the game continues indefinitely and is a draw. Conclusion. Combining Propositions 1, 2, and 3: - Alice has a winning strategy if and only if λ > 1/ √ 2. - Bazza has a winning strategy if and only if λ < 1/ √ 2. - For λ = 1/ √ 2, neither player has a winning strategy.

### A.6 Problem 6

Problem 6. Consider a 2025 × 2025 grid of unit squares. Matilda wishes to place on the grid some rectangular tiles, possibly of different sizes, such that each side of every tile lies on a grid line and every unit square is covered by at most one tile. Determine the minimum number of tiles Matilda needs to place so that each row and each column of the grid has exactly one unit square that is not covered by any tile.

#### A.6.1 Flawed Solution by Gemini 2.5 Pro

Let the grid be an N × N grid of unit squares, where N = 2025. Let the square in row i and column j be denoted by (i, j) for 1 ≤ i, j ≤ N. 58

**1. The Structure of Uncovered Squares** The condition is that each row and each column of the grid has exactly one uncovered square. Let U be the set of uncovered squares. For each row i, there is a unique column j such that (i, j) ∈ U. This allows us to define a function σ : {1, . . . , N} → {1, . . . , N}, where the uncovered square in row i is (i, σ(i)). For each column j, there is a unique row i such that (i, j) ∈ U. This means that for any j0 ∈ {1, . . . , N}, there is a unique i0 such that σ(i0) = j0. This implies that the function σ is a bijection, i.e., a permutation. So, the set of uncovered squares is U = {(i, σ(i)) | i = 1, . . . , N} for some permutation σ of {1, . . . , N}. **2. Partitioning the Tiled Region** Let C be the set of all squares covered by tiles. C is the complement of U in the grid. We can partition C into two disjoint sets: * CL = {(i, j) | j < σ(i)}, the set of squares in C that are to the left of the uncovered square in their respective rows. * CR = {(i, j) | j > σ(i)}, the set of squares in C that are to the right of the uncovered square in their respective rows. It is clear that C = CL ∪ CR and CL ∩ CR = ∅. **3. Tiles are Confined to CL or CR** Let a rectangular tile R cover the squares (i, j) for i ∈ [r1, r2] and j ∈ [c1, c2], where [a, b] denotes the set of integers {a, a + 1, . . . , b}. For R to be a valid tile, all squares it covers must be in C. This means for any i ∈ [r1, r2], the uncovered square (i, σ(i)) is not in R. This implies that for any i ∈ [r1, r2], σ(i) / ∈ [c1, c2]. Let Sσ = {σ(i) | i ∈ [r1, r2]}. The condition for R to be a valid tile is Sσ ∩[c1, c2] = ∅. Let m = min(Sσ) and M = max(Sσ). The condition is equivalent to either c2 < m or c1 > M. * If c2 < m, then for any square (i, j) ∈ R, we have j ≤ c2 < m ≤ σ(i) for all i ∈ [r1, r2]. Thus j < σ(i), which implies (i, j) ∈ CL. Therefore, the entire tile R is contained in CL. * If c1 > M, then for any square (i, j) ∈ R, we have j ≥ c1 > M ≥ σ(i) for all i ∈ [r1, r2]. Thus j > σ(i), which implies (i, j) ∈ CR. Therefore, the entire tile R is contained in CR. This proves that any tile must be entirely in CL or entirely in CR. Consequently, the regions CL and CR are tiled independently. The total minimum number of tiles, k, is the sum of the minimum number of tiles required to tile CL (kL) and CR (kR). So, k = kL + kR. **4. Minimum Number of Tiles for CL** Let’s determine kL for an arbitrary permutation σ. Consider the set of squares SL = {(i, σ(i) − 1) | i ∈ {1, . . . , N} such that σ(i) > 1}. The size of this set is |SL| = N − 1, since there is exactly one i0 for which σ(i0) = 1. Each square in SL is in CL. Let si = (i, σ(i) − 1) and sj = (j, σ(j) − 1) be any two distinct squares in SL. Assume without loss of generality that i < j. Any tile that covers both si and sj must contain the smallest rectangle Rij that contains them. The rows of Rij are [i, j] and the columns are [min(σ(i) − 1, σ(j) − 1), max(σ(i) − 1, σ(j) − 1)]. We investigate if Rij contains any uncovered square from U. * **Case 1: σ(i) < σ(j).** The column interval of Rij is [σ(i)−1, σ(j)−1]. Consider the uncovered square ui = (i, σ(i)). Its row i is in [i, j]. Its column σ(i) is in [σ(i) − 1, σ(j) − 1] because σ(i) − 1 ≤ σ(i) and σ(i) < σ(j) implies σ(i) ≤ σ(j)−1 for integers. So, ui ∈ Rij. * **Case 2: σ(i) > σ(j).** The column interval of Rij is [σ(j) − 1, σ(i) − 1]. Consider the uncovered square uj = (j, σ(j)). Its row j is in [i, j]. Its column σ(j) is in [σ(j) − 1, σ(i) − 1] because 59

sigma(j) − 1 ≤ σ(j) and σ(j) < σ(i) implies σ(j) ≤ σ(i) − 1. So, uj ∈ Rij. In both cases, the rectangle Rij contains an uncovered square. Therefore, si and sj cannot be in the same tile. This holds for any pair of distinct squares in SL. Thus, all N −1 squares in SL must belong to different tiles. This provides a lower bound on the number of tiles for CL: kL ≥ N − 1. To show this bound is achievable, we can tile CL with exactly N − 1 tiles. For each i such that σ(i) > 1, the region to be tiled in row i is {(i, j) | 1 ≤ j ≤ σ(i) − 1}. This is a single rectangular region, which can be covered by one tile Ti = [i, i] × [1, σ(i) − 1]. There are N − 1 such values of i, so this construction uses N − 1 tiles to cover all of CL. Thus, for any permutation σ, the minimum number of tiles for CL is exactly kL = N −1. **5. Minimum Number of Tiles for CR** We use a symmetry argument to determine kR. Consider a 180-degree rotation of the grid. A square (i, j) is mapped to (i′ , j′ ) = (N + 1 − i, N + 1 − j). An uncovered square (i, σ(i)) is mapped to (N + 1 − i, N + 1 − σ(i)). Let’s define a new permutation τ on {1, . . . , N} by τ(i′ ) = N + 1 − σ(N + 1 − i′ ). The set of uncovered squares in the rotated grid is {(i′ , τ(i′ )) | i′ = 1, . . . , N}. The region CR(σ) = {(i, j) | j > σ(i)} in the original grid corresponds to the region of squares (i′ , j′ ) where N + 1 − j′ > σ(N + 1 − i′ ). This inequality is equivalent to j′ < N + 1 − σ(N + 1 − i′ ), which is j′ < τ(i′ ). This is precisely the region CL(τ) for the permutation τ. The minimum number of tiles required to tile a region is invariant under rotation. Thus, the minimum number of tiles for CR(σ) is equal to the minimum number of tiles for CL(τ). Since we proved that kL(π) = N − 1 for *any* permutation π, it holds for τ. So, kR(σ) = kL(τ) = N − 1. **6. Conclusion** For any permutation σ, the minimum number of tiles is k = kL +kR = (N −1)+(N −1) = 2N −2. Since the number of tiles is independent of the choice of permutation, the minimum number of tiles Matilda needs is 2N − 2. For N = 2025, the minimum number of tiles is 2 × (2025 − 1) = 2 × 2024 = 4048.

#### A.6.2 Flawed Solution by Grok-4

Let n = 2025. Place the uncovered squares at positions (i, i) for i = 1, . . . , n. This ensures exactly one uncovered square per row and per column. The covered squares are all (i, j) with i ̸= j. Define L = {(i, j) | 1 ≤ j < i ≤ n} and R = {(i, j) | 1 ≤ i < j ≤ n}. The sets L and R are disjoint and their union is the set of all covered squares. Consider any rectangle on the grid, spanning consecutive rows [a, b] and consecutive columns [c, d]. For the rectangle to be valid (i.e., to contain no uncovered squares and to have all its unit squares available for covering), it must not contain any (k, k) for k ∈ [a, b], so [a, b]∩[c, d] = ∅. Thus, either b < c (whence for all i ∈ [a, b], j ∈ [c, d] satisfies j ≥ c > b ≥ i, so in R) or d < a (whence j ≤ d < a ≤ i, so in L). Therefore, no valid rectangle contains squares from both L and R. The set R consists of squares (i, j) with 1 ≤ i < j ≤ n. In column j (for j = 2 to n), the squares are in rows 1 to j − 1. Tile R with n − 1 rectangles: for each j = 2 to n, place 60

a (j − 1) × 1 rectangle in column j spanning rows 1 to j − 1. These rectangles are disjoint, their union is R, and each is valid (contains no uncovered square, since for row r ∈ [1, j − 1], the uncovered square in row r is (r, r) with r ̸= j). The set L consists of squares (i, j) with 1 ≤ j < i ≤ n. In column j (for j = 1 to n − 1), the squares are in rows j +1 to n. Tile L with n−1 rectangles: for each j = 1 to n−1, place a (n − j) × 1 rectangle in column j spanning rows j + 1 to n. These rectangles are disjoint, their union is L, and each is valid (contains no uncovered square, since for row r ∈ [j + 1, n], the uncovered square in row r is (r, r) with r ̸= j). This tiling uses 2(n−1) rectangles in total and covers all covered squares without overlap. To show this is minimal, note that any tiling must tile L and R separately (no rectangle crosses). Consider R: the squares si = (i, i + 1) for i = 1 to n − 1. Suppose some rectangle contains two such squares sp and sq with p < q. This rectangle spans rows [a, b] ⊇ [p, q] and columns [c, d] ⊇ [p+1, q +1]. Thus, it contains at least the sub-rectangle [p, q]×[p+1, q +1]. This sub-rectangle includes (p + 1, p + 1) (since p ≤ p + 1 ≤ q and p + 1 ≤ p + 1 ≤ q + 1), but (p + 1, p + 1) / ∈ R. Therefore, no rectangle in any tiling of R contains two of {si}. Each si requires its own rectangle, so at least n − 1 rectangles are needed for R. Similarly, for L, the squares (i, i − 1) for i = 2 to n require at least n − 1 rectangles. Thus, at least 2(n − 1) rectangles are needed in total. For n = 2025, the minimum is 2 × 2024 = 4048. 4048

### A.7 Flawed Solution by GPT-5

Let n ≥ 2. We work on an n × n grid of unit squares, indexed by pairs (r, c) with r, c ∈ {1, . . . , n}. A tile is a set of the form {(r, c) : r ∈ [r1, r2] ∩ Z, c ∈ [c1, c2] ∩ Z} for some integers 1 ≤ r1 ≤ r2 ≤ n and 1 ≤ c1 ≤ c2 ≤ n. Tiles are pairwise interior-disjoint and cover all but exactly one unit square in each row and in each column. Upper bound: t ≤ 2n − 2. We construct a tiling with 2n − 2 tiles. - Place the n holes at (i, n + 1 − i) for i = 1, . . . , n (the anti-diagonal). - For each i ∈ {1, . . . , n − 1}, define the horizontal rectangle Rh i = {(i, c) : 1 ≤ c ≤ n − i}. - For each j ∈ {2, . . . , n}, define the vertical rectangle Rv j = {(r, j) : n + 2 − j ≤ r ≤ n}. We verify the required properties. 1) Disjointness: - If i ̸= i′ , then Rh i and Rh i′ lie in different rows and are disjoint. - If j ̸= j′ , then Rv j and Rv j′ lie in different columns and are disjoint. - To show Rh i ∩ Rv j = ∅ for all i ∈ {1, . . . , n − 1} and j ∈ {2, . . . , n}, suppose for contradiction that (r, c) ∈ Rh i ∩ Rv j . From (r, c) ∈ Rh i we have r = i and 1 ≤ c ≤ n − i. From (r, c) ∈ Rv j we have c = j and 61

n+2−j ≤ r ≤ n. Combining, j ≤ n−i and i ≥ n+2−j. Hence i+j ≤ n and i+j ≥ n+2, a contradiction. 2) Coverage of all non-hole cells and no coverage of holes: - If (r, c) is a hole, then c = n + 1 − r. Such a cell lies in neither Rh r (since its column exceeds n − r) nor Rv c (since its row is less than n + 2 − c), hence is uncovered as required. - If c < n + 1 − r (the cell lies to the left of the hole in row r), then c ≤ n − r and (r, c) ∈ Rh r . - If c > n + 1 − r (the cell lies to the right of the hole in row r), then r ≥ n + 2 − c and (r, c) ∈ Rv c . Thus every covered cell lies in exactly one tile, and there are exactly 2n−2 tiles. Therefore t ≤ 2n − 2. Lower bound: t ≥ 2n − 2. Let the unique hole in row i be at (i, π(i)), where π is a permutation of [n] = {1, . . . , n}. Define ai = (i, π(i + 1)) (1 ≤ i ≤ n − 1), bi = (i + 1, π(i)) (1 ≤ i ≤ n − 1), and S = {ai : 1 ≤ i ≤ n − 1} ∪ {bi : 1 ≤ i ≤ n − 1}. We establish three facts. Fact 1 (All points of S are covered). For 1 ≤ i ≤ n − 1, the hole in row i is at column π(i), so ai = (i, π(i + 1)) is covered since π(i + 1) ̸= π(i). Similarly, the hole in row i + 1 is at column π(i + 1), so bi = (i + 1, π(i)) is covered since π(i) ̸= π(i + 1). Fact 2 (The elements of S are pairwise distinct, so |S| = 2n−2). If ai = aj, then equality of rows gives i = j. If bi = bj, then equality of rows gives i = j. If ai = bj, then equality of rows gives i = j + 1, so j = i − 1. Equality of columns then gives π(i + 1) = π(j) = π(i − 1), which contradicts the injectivity of π because i + 1 ̸= i − 1. Hence all elements are distinct and |S| = 2n − 2. Fact 3 (Geometric fooling set). For any two distinct points s, t ∈ S, the axis-aligned bounding box of {s, t} contains a hole (k, π(k)). Consequently, no tile can contain two distinct points of S. Proof of Fact 3. Write ai = (i, π(i + 1)) and bi = (i + 1, π(i)). Consider three cases. - Case A: s = ai and t = aj with i < j. The bounding box has row interval [i, j] and column interval with endpoints π(i + 1) and π(j + 1). Since i + 1 ∈ [i, j] and π(i + 1) lies between the endpoints (indeed, it is one endpoint), the hole (i+1, π(i+1)) is inside the box. - Case B: s = bi and t = bj with i < j. The bounding box has row interval [i + 1, j + 1] and column interval with endpoints π(i) and π(j). Since j ∈ [i + 1, j + 1] and π(j) lies between the endpoints (again, one endpoint), the hole (j, π(j)) is inside the box. - Case C: s = ai and t = bj. Without loss of generality assume i ≤ j. The bounding box has row interval [i, j + 1] and column interval with endpoints π(i + 1) and π(j). If π(i + 1) ≤ π(j), then (i + 1, π(i + 1)) lies in the box since i + 1 ∈ [i, j + 1]. If π(i + 1) > π(j), then (j, π(j)) lies in the box since j ∈ [i, j + 1]. Thus in either subcase the box contains a hole. In all cases, the box contains a hole. Since any tile is a Cartesian product of an interval of rows and an interval of columns, if a tile contained both s and t then it would contain the 62

entire bounding box of {s, t}, hence it would cover a hole—impossible. Therefore each tile contains at most one element of S. Conclusion of the lower bound. Because there are |S| = 2n − 2 distinct covered cells in S and each tile can contain at most one of them, any valid tiling uses at least 2n − 2 tiles. Hence t ≥ 2n − 2. Combining the bounds t ≤ 2n − 2 and t ≥ 2n − 2, we conclude t = 2n − 2. For n = 2025, this yields t = 2 · 2025 − 2 = 4048.

## B Hint-Based Solutions from Initial Experiments

### B.1 Solution to Problem 1 by Gemini 2.5 Pro

The following solution was generated by providing the model with the additional prompt: “Let us try to solve the problem by induction.” Let Sn = {(a, b) ∈ Z2 | a ≥ 1, b ≥ 1, a + b ≤ n + 1}. A line is *sunny* if its slope is not 0, ∞, or −1. We seek the set of non-negative integers k such that for a given integer n ≥ 3, there exist n distinct lines covering Sn, exactly k of which are sunny. **Part 1: Reduction to a Core Problem** Let L be a set of n distinct lines covering Sn. The *principal boundary lines* of Sn are the lines x = 1, y = 1, and x + y = n + 1. These are all non-sunny. **Lemma:** If a principal boundary line L of Sn is in L, then there exists a set of n − 1 distinct lines L′ that covers Sn−1 and has the same number of sunny lines as L. *Proof.* Let k be the number of sunny lines in L. The line L is not sunny. 1. Suppose L is the line x = 1. This line covers the points {(1, b) | 1 ≤ b ≤ n}. The remaining n − 1 lines in L \ {L} must cover the set S′ n = {(a, b) ∈ Sn | a ≥ 2}. The affine transformation ϕ(a, b) = (a − 1, b) is a bijection from S′ n to Sn−1. Let L′ be the set of lines obtained by transforming the lines in L \ {L}. A point (x′ , y′ ) is on a transformed line l′ if its pre-image under ϕ, which is (x′ + 1, y′ ), is on the original line l. If l has equation Ax + By + C = 0, the transformed line l′ has equation A(x + 1) + By + C = 0. This transformation preserves the slope of any line, so the number of sunny lines in L′ is k. The lines in L′ are distinct: if l1 : A1x + B1y + C1 = 0 and l2 : A2x + B2y + C2 = 0 are distinct lines in L \ {L}, their images are l′ 1 : A1x + B1y + (A1 + C1) = 0 and l′ 2 : A2x + B2y + (A2 + C2) = 0. If l′ 1 = l′ 2, their coefficients are proportional, so (A1, B1, A1 + C1) = λ(A2, B2, A2 + C2) for some λ ̸= 0. This implies A1 = λA2, B1 = λB2, and A1 + C1 = λ(A2 + C2). Substituting the first into the third gives λA2 + C1 = λA2 + λC2, so C1 = λC2. Thus (A1, B1, C1) = λ(A2, B2, C2), contradicting the distinctness of l1, l2. 2. If L is y = 1, a symmetric argument with the transformation (a, b) 7→ (a, b − 1) applies. 3. If L is x + y = n + 1, it covers the points {(a, b) ∈ Sn | a + b = n + 1}. The other n − 1 lines must cover the remaining points, which form the set {(a, b) ∈ Sn | a + b ≤ n} = Sn−1. Thus, L′ = L \ {L} is a set of n − 1 distinct lines covering Sn−1 with k sunny lines. 63

By repeatedly applying this lemma, any configuration for Sn can be reduced. This process terminates when we obtain a set of m lines covering Sm (for some m ≤ n) where none of the lines are principal boundary lines of Sm. The number of sunny lines in this new configuration is still k. Let Lm be such a set of m lines covering Sm. Let Cm,x = {(1, b) | 1 ≤ b ≤ m}. These m points must be covered by Lm. Since x = 1 / ∈ Lm, any vertical line in Lm (of the form x = c, c ̸= 1) misses all points in Cm,x. Each of the non-vertical lines in Lm can cover at most one point of Cm,x. If there are v vertical lines in Lm, then the remaining m−v lines must cover all m points, so m − v ≥ m, which implies v = 0. Thus, Lm contains no vertical lines (slope ∞). By a symmetric argument considering Cm,y = {(a, 1) | 1 ≤ a ≤ m}, we deduce Lm contains no horizontal lines (slope 0). By considering Cm,sum = {(a, b) ∈ Sm | a+b = m+1}, we deduce Lm contains no lines of slope −1. Therefore, all m lines in Lm must be sunny. This implies k = m. The problem reduces to finding for which non-negative integers k it is possible to cover Sk with k distinct sunny lines, none of which are principal boundary lines of Sk. **Part 2: Analysis of the Core Problem** * **k = 0:** S0 = ∅. This is covered by 0 lines. So k = 0 is possible. * **k = 1:** S1 = {(1, 1)}. The line y = x is sunny, covers (1, 1), and is not a principal boundary line of S1 (which are x = 1, y = 1, x + y = 2). So k = 1 is possible. * **k = 2:** S2 = {(1, 1), (1, 2), (2, 1)}. We need to cover these three points with two distinct sunny lines, neither of which can be a principal boundary line of S2 (x = 1, y = 1, x + y = 3). A line passing through any two of the points in S2 must be one of these three principal boundary lines, which are non-sunny. Therefore, a sunny line can pass through at most one point of S2. Consequently, two sunny lines can cover at most two points, leaving at least one point of S2 uncovered. So k = 2 is impossible. * **k = 3:** S3 = {(1, 1), (1, 2), (1, 3), (2, 1), (2, 2), (3, 1)}. The following three lines are sunny, distinct, not principal boundary lines of S3, and cover S3: L1 : y = −2x + 5 (covers (1, 3), (2, 1)) L2 : y = x (covers (1, 1), (2, 2)) L3 : x + 2y = 5 (covers (1, 2), (3, 1)) So k = 3 is possible. * **k ≥ 4:** Assume there exists a set L of k distinct sunny lines covering Sk, with no principal boundary lines. As argued, each line in L must intersect each of the sets Cy = {(i, 1)}k i=1, Cx = {(1, j)}k j=1, and Cs = {(p, k + 1 − p)}k p=1 at exactly one point. We can label the lines Li for i ∈ {1, . . . , k} such that Li is the unique line in L passing through (i, 1). For each i, Li must also pass through a unique point (1, σ(i)) ∈ Cx and a unique point (π(i), k + 1 − π(i)) ∈ Cs. The maps σ, π : {1, . . . , k} → {1, . . . , k} must be permutations. These permutations must satisfy several properties: 1. L1 passes through (1, 1), so σ(1) = 1. 2. Lk passes through (k, 1), which is also in Cs. Thus, (π(k), k+1−π(k)) = (k, 1), which implies π(k) = k. 3. There is a unique line Lj passing through (1, k) ∈ Cx, so σ(j) = k. The point (1, k) is also in Cs, so for Lj, (π(j), k + 1 − π(j)) = (1, k), which implies π(j) = 1. Since σ(1) = 1 ̸= k and π(k) = k ̸= 1, we have j ̸= 1, k, so j ∈ {2, . . . , k − 1}. 4. For i ∈ {2, . . . , k}, if σ(i) = i, Li would pass through (i, 1) and (1, i), giving it slope −1, which is not allowed. So σ(i) ̸= i for i ≥ 2. 5. For i ∈ {1, . . . , k − 1}, if π(i) = i, Li would pass through (i, 1) and (i, k + 1 − i), making it a vertical line, which is not allowed. So π(i) ̸= i 64

for i ≤ k − 1. For any i ∈ {1, . . . , k}, the three points P1 = (i, 1), P2 = (1, σ(i)), and P3 = (π(i), k + 1 − π(i)) must be collinear. For i ∈ {2, . . . , k − 1} \ {j}, these three points are distinct. To prove this: - P1 = P2 =⇒ i = 1, but i ≥ 2. - P1 = P3 =⇒ π(i) = i, but π(i) ̸= i for i ≤ k − 1. - P2 = P3 =⇒ π(i) = 1 and σ(i) = k. By definition of j, this means i = j. But we consider i ̸= j. Thus, for i ∈ {2, . . . , k − 1} \ {j}, the points are distinct. Collinearity implies their slopes are equal: σ(i)−1 1−i = k+1−π(i)−1 π(i)−i . This gives σ(i) = 1 + (i − 1)k−π(i) i−π(i) . **Step 1: Show j = k − 1.** Assume for contradiction that j ̸= k − 1. Then the formula for σ(i) is valid for i = k − 1. σ(k − 1) = 1 + (k − 2) k−π(k−1) k−1−π(k−1) . From the properties of π: π(k − 1) ∈ {1, . . . , k}, π(k − 1) ̸= π(j) = 1, π(k − 1) ̸= π(k) = k, and π(k − 1) ̸= k − 1. So π(k − 1) ∈ {2, . . . , k − 2}. Let d = k − 1 − π(k − 1). Then d ∈ {1, . . . , k − 3}. σ(k − 1) = 1 + (k − 2)k−(k−1−d) d = 1 + (k − 2)d+1 d = 1 + (k − 2)(1 + 1 d ) = k − 1 + k−2 d . Since k ≥ 4, we have d ≤ k − 3, so k−2 d ≥ k−2 k−3 = 1 + 1 k−3 > 1. So σ(k − 1) > k − 1 + 1 = k. This contradicts σ(k − 1) ∈ {1, . . . , k}. Thus, our assumption was false. We must have j = k − 1. **Step 2: Derive a final contradiction.** We have established that for k ≥ 4, it must be that j = k − 1, which means σ(k − 1) = k and π(k − 1) = 1. Consider i = 2. Since k ≥ 4, j = k−1 ≥ 3, so j ̸= 2. The formula for σ(i) is valid for i = 2: σ(2) = 1+ k−π(2) 2−π(2) . Since π is a permutation, its image on {1, . . . , k−2} is {1, . . . , k}\{π(k−1), π(k)}. With π(k−1) = 1 and π(k) = k, we have π({1, . . . , k − 2}) = {2, . . . , k − 1}. So π(2) ∈ {2, . . . , k − 1}. By property 5, π(2) ̸= 2. Thus π(2) ∈ {3, . . . , k − 1}. Let d′ = π(2) − 2. Then d′ ∈ {1, . . . , k − 3}. The denominator is 2 − π(2) = −d′ . σ(2) = 1 + k−(d′+2) −d′ = 1 − k−d′−2 d′ = 1 − k−2 d′ − 1  = 2 − k−2 d′ . Since d′ ≤ k −3, we have k−2 d′ ≥ k−2 k−3 = 1+ 1 k−3 > 1 for k ≥ 4. So σ(2) = 2− k−2 d′ < 2−1 = 1. This contradicts σ(2) ∈ {1, . . . , k}. This final contradiction shows that no such configuration is possible for k ≥ 4. **Part 3: Constructions for general n ≥ 3** The set of possible values for k is {0, 1, 3}. We now show these are all possible for any n ≥ 3. * **k = 0:** Let L = {x = i | i = 1, 2, . . . , n}. These are n distinct non-sunny lines. Any point (a, b) ∈ Sn has 1 ≤ a ≤ n, so it lies on the line x = a ∈ L. * **k = 1:** Let L = {x = i | i = 1, . . . , n − 1} ∪ {y = x − (n − 1)}. The first n − 1 lines are non-sunny and cover all points (a, b) ∈ Sn with a ≤ n − 1. The only points in Sn not covered are those with a ≥ n. If (a, b) ∈ Sn and a ≥ n, then n + b ≤ a + b ≤ n + 1, which implies b ≤ 1. Since b ≥ 1, we must have b = 1. Then a + 1 ≤ n + 1 =⇒ a ≤ n. The only uncovered point is (n, 1). The line y = x − (n − 1) has slope 1 (sunny), is distinct from the other lines, and passes through (n, 1) since 1 = n − (n − 1). * **k = 3:** Let Lns = {x + y = c | c = 5, 6, . . . , n + 1}. This is a set of n − 3 distinct non-sunny lines (if n = 3, this set is empty). These lines cover all points (a, b) ∈ Sn with a + b ≥ 5. The remaining points to be covered are U = {(a, b) ∈ Sn | a+b ≤ 4}. This set is precisely S3. As shown in Part 2, S3 can be covered by 3 distinct sunny lines. Let Ls be this set of 3 lines. Then L = Lns ∪ Ls is a set of (n − 3) + 3 = n lines covering Sn. The lines in Ls have slopes different from −1, so they are distinct from lines in Lns. This construction provides exactly 3 sunny lines. 65

Thus, for any integer n ≥ 3, configurations with k ∈ {0, 1, 3} sunny lines are possible.

### B.2 Solution to Problem 2 by Gemini 2.5 Pro

The following proof was generated by providing the model with the additional prompt: “Let us try to solve the problem by analytic geometry.” **1. Coordinate System and Geometric Setup** We establish a Cartesian coordinate system. Let the line of centers MN be the x-axis, and the common chord AB be the y-axis. Let their intersection be the origin O(0, 0). * The points of intersection of the circles are A(0, a) and B(0, −a) for some a > 0. * The centers of the circles are M(m, 0) and N(n, 0). * Circle Ω has center M(m, 0) and passes through A(0, a). Its radius is RΩ = √ m2 + a2. The equation of Ω is (x−m)2 +y2 = m2 +a2 , which simplifies to x2 − 2mx + y2 = a2 . * Circle Γ has center N(n, 0) and passes through A(0, a). Its radius is RΓ = √ n2 + a2. The equation of Γ is (x − n)2 + y2 = n2 + a2 , which simplifies to x2 − 2nx + y2 = a2 . * The line MN is the x-axis. The points C and D lie on the x-axis. Let their coordinates be C(c, 0) and D(d, 0). * The condition that C, M, N, D lie on the line in that order implies their x-coordinates are ordered: c < m < n < d. * C is an intersection of Ω with the x-axis. Its coordinate c is a root of x2 − 2mx − a2 = 0. The roots are m ± √ m2 + a2. Since c < m, we must have c = m − √ m2 + a2. * D is an intersection of Γ with the x-axis. Its coordinate d is a root of x2 − 2nx − a2 = 0. The roots are n ± √ n2 + a2. Since d > n, we must have d = n + √ n2 + a2. * From the equations for c and d, we have c2 − 2mc − a2 = 0 and d2 − 2nd − a2 = 0. Since c < 0 and d > 0, c, d ̸= 0. We can express m and n as: m = c2−a2 2c and n = d2−a2 2d . **2. Preliminary Geometric and Algebraic Properties** We establish two key properties derived from the problem’s conditions. * **Lemma 1:** c+d ̸= 0. * **Proof:** The condition RΩ < RΓ implies m2 +a2 < n2 +a2 , so m2 < n2 . * The ordering C, M, N, D implies m < n. * From m < n and m2 < n2 , we have n2 −m2 > 0, so (n−m)(n+m) > 0. Since n−m > 0, we must have n+m > 0. * Also, m2 < n2 =⇒ m2 + a2 < n2 + a2 =⇒ √ m2 + a2 < √ n2 + a2. * Assume for contradiction that c + d = 0. Using the expressions for c and d: (m − √ m2 + a2) + (n + √ n2 + a2) = 0 =⇒ m + n = √ m2 + a2 − √ n2 + a2. * The left side, m + n, is positive. The right side, √ m2 + a2 − √ n2 + a2, is negative. This is a contradiction. * Thus, our assumption is false, and c + d ̸= 0. * **Lemma 2:** a2 + cd < 0. * **Proof:** The condition m < n implies c2−a2 2c < d2−a2 2d . * From their definitions, c < 0 and d > 0, so cd < 0. Multiplying the inequality by 2cd (which is negative) reverses the inequality sign: d(c2 − a2 ) > c(d2 − a2 ) =⇒ c2 d − a2 d > cd2 − a2 c =⇒ cd(c − d) > −a2 (c − d). * Since c < d, we have c − d < 0. Dividing by c − d reverses the inequality sign again: cd < −a2 =⇒ a2 + cd < 0. **3. Coordinates of P and H** * Let P(xP , yP ) be the circumcenter of △ACD with vertices A(0, a), C(c, 0), D(d, 0). * P lies on the perpendicular bisector of segment CD, which is the line x = c+d 2 . So, xP = c+d 2 . * The condition PA2 = PC2 gives (xP − 0)2 + (yP − a)2 = (xP − c)2 + (yP − 0)2 . 66

x2 P + y2 P − 2ayP + a2 = x2 P − 2cxP + c2 + y2 P =⇒ −2ayP + a2 = −2cxP + c2 . Substituting xP = c+d 2 : −2ayP + a2 = −c(c + d) + c2 = −cd =⇒ yP = a2+cd 2a . So, P  c+d 2 , a2+cd 2a  . * Let H(xH, yH) be the orthocenter of △PMN with vertices P(xP , yP ), M(m, 0), N(n, 0). * The altitude from P to MN (on the x-axis) is the line x = xP . Thus, xH = xP = c+d 2 . * The altitude from M is perpendicular to PN. The slope of this altitude is −xP −n yP . The line is y − 0 = −xP −n yP (x − m). * H lies on this line, so yH = −xP −n yP (xH − m) = −(xP −m)(xP −n) yP . * We express the numerator in terms of a, c, d: xP − m = c+d 2 − c2−a2 2c = c(c+d)−(c2−a2) 2c = cd+a2 2c . xP − n = c+d 2 − d2−a2 2d = d(c+d)−(d2−a2) 2d = cd+a2 2d . * Substituting these into the expression for yH: yH = − 1 yP  cd+a2 2c   cd+a2 2d  = −(cd+a2)2 4cdyP . Using yP = a2+cd 2a and a2 +cd ̸= 0 (from Lemma 2), we get: yH = −(cd+a2)2 4cd 2a a2+cd = −a(a2+cd) 2cd . * So, the coordinates of the orthocenter are H  c+d 2 , −a(a2+cd) 2cd  . **4. The Line AP and its Intersections** * Since a ̸= 0 and c + d ̸= 0 (Lemma 1), the slope of line AP, denoted kAP , is welldefined: kAP = yP −a xP −0 = a2+cd 2a −a c+d 2 = a2+cd−2a2 a(c+d) = cd−a2 a(c+d) . * The line AP has equation y = kAP x + a. E(xE, yE) and F(xF , yF ) are the other intersection points of this line with Ω and Γ respectively. * To find E, substitute y = kAP x+a into the equation of Ω, x2 −2mx+y2 = a2 : x2 −2mx+(kAP x+a)2 = a2 =⇒ x((1+k2 AP )x−2m+2akAP ) = 0. The roots are x = 0 (for point A) and xE = 2(m−akAP ) 1+k2 AP . * Similarly, for F on Γ (x2 − 2nx + y2 = a2 ): xF = 2(n−akAP ) 1+k2 AP . **5. Auxiliary Algebraic Identities** We derive identities that will simplify subsequent calculations. * **Identity 1:** m − akAP = c2−a2 2c − a  cd−a2 a(c+d)  = (c2−a2)(c+d)−2c(cd−a2) 2c(c+d) = (c2+a2)(c−d) 2c(c+d) . * **Identity 2:** n − akAP = d2−a2 2d −cd−a2 c+d = (d2−a2)(c+d)−2d(cd−a2) 2d(c+d) = (d2+a2)(d−c) 2d(c+d) . * **Identity 3:** 1+k2 AP = 1+  cd−a2 a(c+d) 2 = a2(c+d)2+(cd−a2)2 a2(c+d)2 = (c2+a2)(d2+a2) a2(c+d)2 . * **Identity 4:** kAP + 2a xE = cd−a2 a(c+d) + a(1+k2 AP ) m−akAP = cd−a2 a(c+d) + a(c2+a2)(d2+a2) a2(c+d)2 . (c2+a2)(c−d) 2c(c+d) = cd−a2 a(c+d) + 2c(d2+a2) a(c+d)(c−d) = (cd−a2)(c−d)+2c(d2+a2) a(c+d)(c−d) = cd(c+d)+a2(c+d) a(c+d)(c−d) = cd+a2 a(c−d) . **6. The Circumcircle of △BEF** Let K(xK, yK) be the circumcenter of △BEF. K lies on the perpendicular bisectors of BE and BF. The perpendicular bisector of BE is given by KB2 = KE2 , which simplifies to 2xKxE + 2yK(yE + a) = x2 E + y2 E − a2 + 2a2 = 2mxE + 2a2 . Using yE = kAP xE + a, we get xKxE + yK(kAP xE + 2a) = mxE + a2 . This is incorrect. Let’s re-derive. KB2 = KE2 =⇒ x2 K + (yK + a)2 = (xK − xE)2 + (yK − yE)2 . x2 K + y2 K + 2ayK + a2 = x2 K − 2xKxE + x2 E + y2 K − 2yKyE + y2 E. 2ayK + a2 = −2xKxE + x2 E − 2yKyE + y2 E. Since E is on Ω, x2 E + y2 E = 2mxE + a2 . 2ayK + a2 = −2xKxE + 2mxE + a2 − 2yKyE. 2ayK = −2xKxE + 2mxE − 2yKyE. ayK = −xKxE + mxE − yKyE. ayK = −xKxE + mxE − yK(kAP xE + a) =⇒ 2ayK = −xKxE + mxE − yKkAP xE. xE(xK + yKkAP ) + 2ayK = mxE. Dividing by xE ̸= 0: (1) xK + yK(kAP + 2a xE ) = m. A similar derivation for the perpendicular 67

bisector of BF (using point F on Γ) yields: (2) xK + yK(kAP + 2a xF ) = n. Subtracting (1) from (2): yK( 2a xF − 2a xE ) = n − m =⇒ 2ayK xE−xF xExF = n − m. Using xE − xF = 2(m−n) 1+k2 AP , we get 2ayK 2(m−n)/(1+k2 AP ) xExF = n − m. Since m ̸= n, we find yK = − xExF (1+k2 AP ) 4a = −(m−akAP )(n−akAP ) a(1+k2 AP ) . Using Identities 1, 2, 3: yK = −1 a  (c2+a2)(c−d) 2c(c+d)   (d2+a2)(d−c) 2d(c+d)  . (c2+a2)(d2+a2) a2(c+d)2 = a(c−d)2 4cd . From (1) and Identity 4: xK = m − yK(kAP + 2a xE ) = m − yK cd+a2 a(c−d) . xK = c2−a2 2c − a(c−d)2 4cd cd+a2 a(c−d) = c2−a2 2c − (c−d)(cd+a2) 4cd = 2d(c2−a2)−(c−d)(cd+a2) 4cd = cd(c+d)−a2(c+d) 4cd = (cd−a2)(c+d) 4cd . The radius squared of the circumcircle of △BEF is R2 K = KB2 = x2 K +(yK +a)2 . yK +a = a(c−d)2 4cd +a = a(c+d)2 4cd . R2 K =  (cd−a2)(c+d) 4cd 2 +  a(c+d)2 4cd 2 = (c+d)2 (4cd)2 ((cd − a2 )2 + a2 (c + d)2 ) = (c+d)2(c2+a2)(d2+a2) 16c2d2 . **7. The Tangency Proof** The line ℓH passes through H(xH, yH) and is parallel to AP. Its equation is y − yH = kAP (x − xH), which can be written as kAP x − y − (kAP xH − yH) = 0. This line is tangent to the circumcircle of △BEF (center K, radius RK) if the square of the distance from K to ℓH is R2 K. The squared distance is (kAP xK −yK −(kAP xH −yH ))2 k2 AP +1 . The condition for tangency is (kAP (xK − xH) − (yK − yH))2 = R2 K(1 + k2 AP ). Let’s compute the terms on the left side (LHS). xK − xH = (cd−a2)(c+d) 4cd − c+d 2 = (c+d)(cd−a2−2cd) 4cd = −(c+d)(cd+a2) 4cd . yK − yH = a(c−d)2 4cd −  −a(a2+cd) 2cd  = a(c2−2cd+d2)+2a(a2+cd) 4cd = a(c2+d2+2a2) 4cd . kAP (xK − xH) = cd−a2 a(c+d)  −(c+d)(cd+a2) 4cd  = −(cd−a2)(cd+a2) 4acd = −c2d2−a4 4acd . kAP (xK − xH) − (yK − yH) = −c2d2−a4 4acd − a2(c2+d2+2a2) 4acd = −c2d2−a4+a2c2+a2d2+2a4 4acd = −(c2+a2)(d2+a2) 4acd . LHS =  −(c2+a2)(d2+a2) 4acd 2 = (c2+a2)2(d2+a2)2 16a2c2d2 . Now we compute the right side (RHS) using R2 K and Identity 3: RHS = R2 K(1 + k2 AP ) =  (c+d)2(c2+a2)(d2+a2) 16c2d2   (c2+a2)(d2+a2) a2(c+d)2  = (c2+a2)2(d2+a2)2 16a2c2d2 . Since LHS = RHS, the tangency condition is satisfied. This completes the proof. 68
